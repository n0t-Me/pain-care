/*! "1.253.0-20231127-113203-a235930" */!function(){"use strict";const e={LOG:"log",INFO:"info",WARN:"warn",ERROR:"error",DEBUG:"debug"},o={enabled:!1};("undefined"!=typeof window&&/[?|&]ads-debug/.test(window.location.href)||"undefined"!=typeof document&&-1!==document.cookie.indexOf("ads-debug="))&&(o.enabled=!0);const t=function(t){return(n,a=e.LOG)=>{o.enabled&&console[a](`dotcom:${t} ${n}`)}},n=e=>{const o=e?e.replace(/(_|-|\/)[0-9]{7,8}$/,"").replace(/\/articles\/c[0-9a-hj-np-z]{10,}o$/,"/articles").replace(/(_|-|\/)+$/,""):"";return o.indexOf("/")>-1?o.split("/"):[o]},a=e=>{if("undefined"==typeof document||!e)return"";const o=`; ${document.cookie}`.split(`; ${encodeURIComponent(e)}=`);let t="";return 2===o.length&&(t=decodeURIComponent(o.pop().split(";").shift())),t},i=(e,o,t)=>{if("undefined"==typeof document||!e)return;const n=new Date(Date.now()+864e5*t);document.cookie=`${encodeURIComponent(e)}=${encodeURIComponent(o)}; expires=${n.toGMTString()}; domain=.bbc.com; path=/`},s=e=>{window.dotcom.consent=e},c=["AT","AX","BE","BG","BL","CY","CZ","DE","DK","EE","ES","EU","FI","FR","GB","GF","GG","GI","GP","GR","HR","HU","IE","IM","IS","IT","JE","LI","LT","LU","LV","MF","MT","MQ","NL","NO","PL","PM","PT","RE","RO","SE","SI","SK","YT"],r=()=>"undefined"!=typeof window&&/[?|&]ads-debug/.test(window.location.href),d=()=>"undefined"!=typeof live&&"test"===live||-1!==window.location.href.indexOf("test.api.bbc.co.uk")||/(localhost|sandbox|int|test)(.dev)*.bbc.co*/.test(window.location.href)||/web.(int|test).bbcx.test.api.bbc.com/.test(window.location.href),w=()=>!0===window.dotcom.userinfo.notUkIp&&!0===window.dotcom.userinfo.ads,l=()=>r()||w()&&window.dotcom.flags.state>0&&window.dotcom.flags.adverts,p=e=>{var o;window.dotcom.userinfo.country=e["X-Country"],window.dotcom.userinfo.notUkIp="no"===e["X-Ip_is_uk_combined"],window.dotcom.userinfo.ads="yes"===e["X-Ip_is_advertise_combined"],!0===window.dotcom.userinfo.notUkIp&&(window.dotcom.userinfo.eea=!!(o=window.dotcom.userinfo.country)&&-1!==c.indexOf(o.toUpperCase()))},u=(e,o)=>{o||(delete e.adverts,delete e.analytics),Object.keys(e).forEach((o=>{let t=e[o];t="true"===t||t,t="false"!==t&&t,window.dotcom.flags[o]=t})),"www.bbc.com"!==window.location.hostname||"/news/uk/the_queen"!==window.location.pathname&&"/news/live/uk-62902778"!==window.location.pathname&&"/news/topics/c8nq32jwn4rt"!==window.location.pathname&&"/news/topics/cq23pdgvr7rt"!==window.location.pathname||(window.dotcom.flags.adverts=!1)},m=async(e,o)=>fetch(e).then((e=>{if(e.ok)return e.json();throw new Error(o)})),g=async()=>{const e="Error fetching flags",o=await m(d()?"https://gn-flagpoles.test.api.bbci.co.uk/ngas":"https://gn-flagpoles.api.bbci.co.uk/ngas",e).catch((()=>{throw window.dotcom.flags.state=-2,new Error(e)}));u(o,!1),window.dotcom.flags.state=2};let f=[];const h={isAdsDebug:r,isTestEnv:d,isStageEnv:()=>/stage.bbc.co*/.test(window.location.href)||/web.stage.bbcx.test.api.bbc.com/.test(window.location.href),isSignedIn:()=>a("ckns_id"),isDotcomAllowed:w,syncAdsEnabled:()=>l(),isAdsEnabled:()=>new Promise((e=>{window.dotcom.userinfo.state<0||window.dotcom.flags.state<0?e(l()):0===window.dotcom.userinfo.state||0===window.dotcom.flags.state?f.push(e):e(l())})),checkCookies(){s(1);const e=a("ckns_policy");(r()||e&&"1"===e.charAt(2))&&s(2),e||window.dotcom.userinfo.eea||(s(2),i("ckns_policy","111",365),i("ckns_explicit","0",365))},async init(){const e=new URLSearchParams(window.location.search);try{r()?(window.dotcom.userinfo.notUkIp=!0,window.dotcom.userinfo.ads=!0,window.dotcom.flags.adverts=!0,window.dotcom.flags.analytics=!0,window.dotcom.userinfo.state=1,await g()):(await(async()=>{const e="Error fetching userinfo",{userinfo:o={}}=window.dotcom.config;if(o["X-Country"]&&o["X-Ip_is_uk_combined"]&&o["X-Ip_is_advertise_combined"])return p(o),void(window.dotcom.userinfo.state=2);const t=await m("https://www.bbc.com/userinfo",e).catch((()=>{throw window.dotcom.userinfo.state=-1,new Error(e)}));p(t),window.dotcom.userinfo.state=1})(),w()?window.dotcom.config.opsFlags&&!e.has("force-client-flagpoles")?(u(window.dotcom.config.opsFlags,!0),u(window.dotcom.config.ngasFlags,!1),window.dotcom.flags.state=2):(await(async()=>{const e="Error fetching gnlops flags",o=await m(d()?"https://gn-flagpoles.test.api.bbci.co.uk/gnlops":"https://gn-flagpoles.api.bbci.co.uk/gnlops",e).catch((()=>{throw window.dotcom.flags.state=-1,new Error(e)}));u(o,!0),window.dotcom.flags.state=1})(),!0!==window.dotcom.flags.adverts&&!0!==window.dotcom.flags.analytics||await g()):window.dotcom.flags.state=-3)}finally{f&&f.length>0&&(f.forEach((e=>e(l()))),f=[])}},reset(){f=[]}},_=()=>window.dotcom.data,y=new RegExp("^(/)?(afaanoromoo|afrique|amharic|arabic|azeri|bengali|burmese|gahuza|gujarati|hausa|hindi|igbo|indonesia|korean|kyrgyz|japanese|marathi|mundo|naidheachdan|nepali|pashto|persian|pidgin|portuguese|punjabi|russian|serbian|sinhala|somali|swahili|tajik|tamil|telugu|thai|tigrinya|turkce|ukchina|ukrainian|urdu|uzbek|vietnamese|yoruba|zhongwen)"),b=new RegExp("^/ws/av-embeds/"),S=e=>{const o=e||window.location.pathname;return y.test(o)||b.test(o)},v=()=>!!window.dotcom?.config?.xPlatform,E=()=>{const e=_().channel;return("future"===e||"worklife"===e||"travel"===e||"culture"===e)&&!v()},I=S,x=E,k=()=>"storyworks"===_().channel,C=v;let T=!1;const $=()=>{let e;const o=window.dotcomConfig&&window.dotcomConfig.pageData;o&&(o&&o.collection&&o.collection.length&&(e=o.collection.map((e=>e.title.toLowerCase().replace(/ /g,"_"))).join(","),window.dotcom.data.newKeyValues.coll=e),o&&o.destination&&o.destination.length&&(e=o.destination.map((e=>e.title.toLowerCase().replace(/ /g,"_"))).join(","),window.dotcom.data.newKeyValues.destination=e),o&&o.topics&&o.topics.length&&(e=o.topics.map((e=>e.title.toLowerCase().replace(/ /g,"_"))).join(","),window.dotcom.data.newKeyValues.top_tags=e),o&&o.urn&&(window.dotcom.data.newKeyValues.page_id=o.urn),o&&o.type&&(window.dotcom.data.newKeyValues.page_type=o.type.replace("indexPage","index")),window.dotcom.config.adCampaign&&(window.dotcom.data.newKeyValues.leg_n_keyword=window.dotcom.config.adCampaign),window.dotcom.config.topics&&window.dotcom.config.topics.length&&(window.dotcom.data.newKeyValues.leg_n_topic=window.dotcom.config.topics),o&&"boolean"==typeof o.allowAdvertising&&(window.dotcom.config.allowAdvertising=o.allowAdvertising),T=!0)},A=()=>{let e,o;C()&&!T&&(window.dotcomConfig&&window.dotcomConfig.pageData?$():(e=setInterval((()=>{o=window.dotcomConfig&&window.dotcomConfig.pageData,o&&($(),clearInterval(e))}),100),setTimeout((()=>{clearInterval(e)}),1e3)))},O=()=>window.dotcom.data,U=e=>(e=>O().urlParams.has(e))(e)?O().urlParams.get(e):"",R=e=>{const o={AV:"media_asset",INDEX:"index",FIX:"index",STY:"story"};let t;const n=window?.SIMORGH_DATA?.pageData?.metadata?.type;return void 0===t&&n&&(t=o[n]),void 0===t&&(t=/[0-9]{7,8}$/.test(e)?"story":"index",(e.includes("/articles/")||e.includes("/article/"))&&(t="story")),/\/(sport|news)\/live\//.test(e)&&(t="live_event"),t},j=["/4817","/bbccom.ENV.site.SITE","/SECTION_SUBSECTION"],N=["/4817","/bbccom","/PILLAR","/SECT","/ASSET_TYPE"];let P="";const D=e=>e.replace(/^(news\/av\/)(.*)\/[^/]+$/,"$1$2").replace(/^news\/av\//,"news/").replace(/_and_/,"-").replace(/^news\/uk-(england|northern-ireland|scotland|wales)($|-|\/)/,"news/uk/$2").replace(/^news\/uk-([a-z]+)(-([a-z]+))?/,"news/$1/$3").replace(/^news\/(world)-([a-z-]+)/,"news/$2/").replace(/^sport\/av\//,"sport/").replace(/^sport\/(world|uk)/,"sport").replace(/^sport\/(.*)\/sports($|\/)/,"sport/$1$2").replace(/market-data\/overview/,"market-data").replace(/^(programmes)/,"news/$1");let L;const z=e=>{let o=e&&e.length&&e[0].url&&e[0].url.split("/");return o&&o.length>2?(o.shift(),o.shift(),o=o.join("-"),o.replace("topic-","").replace("world-","")):o&&2===o.length?o.pop():null},V=(e,o)=>{if(P)return P;const t=C()?"test":"",a=[...j],i=e.split("?")[0],s=L||U("site")||t;L=s;const c=U("adUnit");let r=i.match(/http(|s):\/\/[a-z0-9\-.]+(.com|.co.uk)(:\d+)?(\/)?(.*)?/);r=r?r.pop():"",r=r&&""!==r?D(r):r;const d=n(r)||[],w=I(r),l=h.isTestEnv(i);let p=""===d[0]||"wwhp"===d[0]?"www":d[0];if(c)return c;void 0===d[0]&&(d[0]="homepage"),"sport"!==d[0]&&"weather"!==d[0]||(p="news",d[1]&&(d[1]=d[1].replace("-",""))),"in-pictures"===d[1]&&(d[1]="inpictures"),"news"===d[0]&&d[1]&&d[1].indexOf("-")>0&&("index"===R(window.location.pathname)?d[1]=d[1].replace("-",""):d[1]=d[1].split("-")[0]),"test"===s&&(p="flash"),"preview"===s&&(p="test"),"russian"!==d[0]||l||"preview"===s||"test"===s||(p="russia"),"zhongwen"!==d[0]&&"ukchina"!==d[0]||l||(p=d[0]+d[1]),"storyworks"===d[0]&&(p="future|culture|travel|worklife|sport|worldwide|earth|capital|britain|autos".indexOf(d[1])<0?"specialfeatures":d[1]),a[1]=""!==s?a[1].replace("ENV",s):a[1].replace("ENV",l?"test":"live"),w&&(!l&&"preview"!==s&&"test"!==s||"live"===s)&&(a[1]=a[1].replace("/bbccom.","/bbcworldservice.")),a[1]=w||!o||l||"test"===s||"preview"===s?a[1].replace("SITE",p).replace("japanese","japan"):a[1].replace("SITE",`mobile.${p}`),"zhongwen"===d[0]?(a[2]=a[2].replace("SECTION",d[0]+d[1]),a[2]=a[2].replace("SUBSECTION",void 0!==d[2]?`${d[2]}_content`:"home_content")):"reel"===d[0]?(a[2]=a[2].replace("SECTION",d[0]),a[2]=a[2].replace("SUBSECTION",void 0!==d[1]?"other":"homepage")):"storyworks"===d[0]?(a[1]=a[1].replace("SITE",d[1]),window.advertising?.keywords.subsect?a[2]=a[2].replace("SECTION_SUBSECTION",window.advertising.keywords.subsect):window.dotcomConfig.adsSubsection&&(a[2]=a[2].replace("SECTION_SUBSECTION",window.dotcomConfig.adsSubsection))):(a[2]=a[2].replace("SECTION",""===d[0]||"wwhp"===d[0]?"bbc":d[0]),a[2]=a[2].replace("SUBSECTION",void 0!==d[1]?`${d[1]}_content`:"homepage_int").replace("articles_",""));const u=a.join(""),m=(e=>{const o=[...N];let t=e.replace("#","").split("?")[0].match(/http(|s):\/\/[a-z0-9\-.]+(.com|.co.uk)(:\d+)?(\/)?(.*)?/);t=t?t.pop():"",t=t&&""!==t?D(t):t;const a=n(t)||[],i=window.dotcomConfig&&window.dotcomConfig.pageData||{},s=i&&i.type&&i.type.replace("indexPage","index")||R(window.location.pathname).replace("story","article"),c=i.pillar&&i.pillar.length&&i.pillar[0].url&&i.pillar[0].url.replace("/","")||a[0],r=z(i.section)?z(i.section):a[1];let d=o.join("");return d=""===a[0]||void 0===a[0]?d.replace("PILLAR","home").replace("SECT","home"):d.replace("PILLAR",c),""!==a[1]&&void 0!==a[1]||"index"!==s||(d=d.replace("SECT",`${c}_home`)),"travel"===a[0]&&"destinations"===a[1]&&(d=void 0!==a[2]?d.replace("SECT",`${a[0]}_${a[1]}-${a[2]}`):d.replace("SECT",`${a[0]}_${a[1]}`)),"world"===a[1]?void 0!==a[2]&&(d=void 0!==a[3]?d.replace("SECT",`${a[2]}-${a[3]}`):d.replace("SECT",a[2])):d="articles"===r||"videos"===r?d.replace("SECT",`${c}_other`):"article"===r?d.replace("SECT",c):d.replace("SECT",r),d=d.replace("ASSET_TYPE",s),d})(e);return window.dotcom.data.legAdUnit=u,window.dotcom.data.newAdUnit=m,window.dotcom.flags?.newadunit&&C()&&!U("site")&&!U("adUnit")?(window.dotcom.data.newKeyValues.leg_adunit2=u,m):u};let G=[];const B=t("permutive"),K=()=>{B("get cust_params");const e=window.localStorage.getItem("_pdfps");return encodeURIComponent(JSON.parse(e||"[]").slice(0,250).join(","))},M=(()=>{let e;const o=function(e,o,t){return e.concat("%26",o,"%3D",t)};return{parseIASResponseData:function(o){e=JSON.parse(o)},getIASPageTargetingAsQueryString:function(){let t="";return t=o(t,"fr",e.fr),Object.keys(e.brandSafety).forEach((n=>{t=o(t,n,e.brandSafety[n])})),t},getIASSlotTargetingAsQueryString:()=>{const t={};return Object.keys(e.slots).forEach((n=>{const a=e.slots[n];let i="";Object.keys(a).forEach((e=>{const s=a[e];if(Array.isArray(s)){i=i.concat("%26",e,"%3D");const o=s.length-1;for(let e=0,t=s.length;e<t;e+=1){let t="%2C";e===o&&(t=""),i=i.concat(s[e],t)}}else i=o(i,e,s);t[n]=i}))})),t},getAdSlotDataObj:()=>e}})();t("measurePerformance"),t("loader");window.dotcom=window.dotcom||{},window.dotcom.loader=window.dotcom.loader||{loading:[],loaded:[],failed:[],waiting:[]};const F=t("ias"),X=e=>{const o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const o=Math.floor(16*Math.random());return("x"===e?o:3&o|8).toString(16)}));return new Promise(((t,n)=>{if(a="ias",!window.dotcom.loader.loaded.includes(a))return void n(new Error("IAS is not enabled"));var a;const i=setTimeout((()=>{const e="getIasCustParams timeout";F(e),n(new Error(e))}),2e3),s=[{adSlotId:o,size:[1,1],adUnitPath:e,type:"video"}];window.__iasPET.queue.push({adSlots:s,dataHandler:function(e){clearTimeout(i),M.parseIASResponseData(e);const n=M.getIASPageTargetingAsQueryString(),a=M.getIASSlotTargetingAsQueryString(),s=n.substr(3)+a[o];F(`cust params: ${s}`),t(s)}})}))},q="ckpf_ppid";const J=[[0,320],[319,400],[399,600],[599,1008],[1007,1280],[1279,99999]],Q=[[0,400],[399,600],[599,768],[767,1008],[1007,1280],[1279,99999]];let Y=JSON.parse(JSON.stringify([[0,320],[319,400],[399,600],[599,900],[899,1280],[1279,99999]]));Y.pop(),Y[4][1]=99999;const H=()=>"reel"===O().channel||x()||k()||C(),W=H,Z=()=>window.innerWidth<900,ee=t("preroll"),{hostname:oe}=window.location,te={sz:"640x360",iu:"",env:"vp",gdfp_req:"1",impl:"s",output:"xml_vast3",unviewed_position_start:"1",ord:"",ad_rule:"1",ppid:"",ad_type:"audio_video",cust_params:{channel:"",sectn:"",domain:oe,story_id:"",ctype:"content",asset_type:"story",referrer:"",referrer_domain:"",gs_cat:"",group:""}},ne=e=>Object.keys(e).map((o=>`${o}=${e[o]}`)).join("&"),ae=async()=>{const o={...te};o.cust_params={...te.cust_params};const{adCampaign:t,topics:n,adUnit:i}=O();i||(window.dotcom.data.adUnit=V(window.top.location.href,Z()));const s=U("uid"),c=G,r=K();if(o.iu=window.dotcom.data.adUnit,o.ord=Math.floor(1e9*Math.random()),o.ppid=a(q),o.cust_params.gs_cat=void 0!==window.gs_channels&&"DEFAULT"!==window.gs_channels?`${encodeURIComponent(window.gs_channels)}`:"",o.cust_params.group=(()=>{const e=window.innerWidth,o=C()?Q:J;let t="0";for(let n=0;n<o.length;n+=1){const a=o[n];e>a[0]&&e<a[1]&&(t=n.toString())}return t})(),""!==s&&(o.cust_params.uid=s),c.length&&(o.cust_params.excl_cat=c.join(",")),t&&(o.cust_params.keyword=t),n?.length){const e=n.map((e=>e.replace(/\s+/g,"-"))).join(",");o.cust_params.topics=encodeURIComponent(e)}r&&(o.cust_params.permutive=r),await(e=>{let o=0;return W()&&(o=x()?200:15),new Promise((t=>{setTimeout((()=>{let{keyValues:o}=O();C()&&(A(),o=O().newKeyValues),Object.keys(o).forEach((t=>{e.cust_params[t]=o[t]})),t("resolved")}),o)}))})(o),""===o.cust_params.story_id&&(o.cust_params.asset_type="index",o.cust_params.ctype="index");try{const e=await X(i);o.cust_params.ias=e}catch(o){ee(o.message,e.WARN)}return o.cust_params=encodeURIComponent(ne(o.cust_params)),o};window.dotcom.ads.adTag=async()=>{let e="https://pubads.g.doubleclick.net/gampad/ads?";const o=await ae();return e=`${e}${ne(o)}`,void 0===window.dotcom.gdprApplies&&(1===window.dotcom.consent||window.dotcom.userinfo.eea)&&(e=`${e}&rdp=1&npa=1`),e}}();