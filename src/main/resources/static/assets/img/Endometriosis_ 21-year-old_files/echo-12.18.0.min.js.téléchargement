/*!
 * Echo - v12.18.0, 2022-07-22, from git revision faabd557d27c5edeccfd1ef7c8f6288689c5915a.
 * Copyright (c) 2022 BBC, all rights reserved.
 * 
 * Copyright (c) 2014 comScore, Inc.
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.echo_js=t():e.echo_js=t()}(window,function(){return function(i){var n={};function r(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=i,r.c=n,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=24)}([function(e,t,i){var n;void 0===(n=function(e){"use strict";var t=!1,i={INFO:0,WARN:1,ERROR:2},n=i.ERROR;function r(e,t){"object"==typeof console&&"function"==typeof console[e]&&console[e](t)}return{enable:function(){t=!0},disable:function(){t=!1},getState:function(){return t},getLevel:function(){return n},setLevel:function(e){n=i.ERROR<e?i.ERROR:e<i.INFO?i.INFO:e},info:function(e){t&&n===i.INFO&&r("log","ECHO_DEBUG [info]: "+e)},warn:function(e){t&&n<=i.WARN&&r("log","ECHO_DEBUG [warning]: "+e)},error:function(e){if(t&&n<=i.ERROR)throw new Error("ECHO_DEBUG: "+e)},DebugLevels:i}}.call(t,i,t,e))||(e.exports=n)},function(e,t,i){var n;void 0===(n=function(e){"use strict";var n=i(0);function a(t){var i={};for(var n in t)try{t[n].constructor===Object?i[n]=a(t[n]):i[n]=t[n]}catch(e){i[n]=t[n]}return i}function s(e,t,i){var n=i?e:a(e);for(var r in t)try{t[r].constructor===Object?n[r]=s(n[r],t[r]):n[r]=t[r]}catch(e){n[r]=t[r]}return n}function r(e,t){for(var i in e)if(e.hasOwnProperty(i)&&e[i]===t)return!0;return!1}function o(e,t){for(var i=(t?a(e):e)||{},n=arguments,r=2,o=n.length;r<o;r++)"object"==typeof n[r]?s(i,n[r],!0):i[n[r]]=n[++r];return i}function c(e,t,i){return e||(i?n.warn("AssertionFailed: "+t):n.error("AssertionFailed: "+t)),e}return{clone:a,combineObjects:s,addKV:function(e,t,i){return i?o(e,!0,t,i):o(e,!0,t)},containsValue:r,startsWith:function(e,t){return 0===e.indexOf(t)},extend:o,assert:c,assertContainsValue:function(e,t,i){return c(r(e,t),i)},trim:function(e){if("string"==typeof e)return e=String.prototype.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}}}.call(t,i,t,e))||(e.exports=n)},function(e,t,A){var i;void 0===(i=function(e){"use strict";var t=A(10),i=A(5),n=A(14),r=A(11),o=A(3),a=A(6),s={};Object.keys(t).map(function(e){s[e]=e});var c={};Object.keys(i).map(function(e){c[e]=e});var u={};Object.keys(n).map(function(e){u[e]=e});var l={};Object.keys(r).map(function(e){l[e]=e});var d="16060501",p="19293874",h="19999701",_="19774467",f="19774474",E="19774472",g="18897612",m="23239715",v="18897612";function T(e,t,i){var n={};return n[o.COMSCORE_CUSTOMER_ID]=e,n[o.COMSCORE_SITE]=t,n[o.COMSCORE_HOST]=i,n}function I(e){return T(d,e,"sa.bbc.co.uk")}function C(e,t){return T(e,t,"scorecardresearch.com")}var S={};return S.PUBLIC_SERVICE=I("bbc"),S.PUBLIC_SERVICE_STAGE=I("stage"),S.PUBLIC_SERVICE_TEST=I("test"),S.PUBLIC_SERVICE_INT=I("int"),S.PUBLIC_SERVICE_INTRANET=I("intranet"),S.GNL=C(p,"bbc"),S.GNL_ACCEPTANCE=C(g,"gnl-test"),S.WORLD_SERVICE=C(h,"bbc"),S.WORLD_SERVICE_ACCEPTANCE=C(g,"ws-test"),S.WORLDWIDE_FEATURES=C(_,"bbc"),S.WORLDWIDE_FEATURES_ACCEPTANCE=C(g,"features-test"),S.STORE_NONCOMMERCIAL=C(f,"bbc"),S.STORE_COMMERCIAL=C(E,"bbc"),S.BRITBOX_ACCEPTANCE=C(v,"bbc-global-test"),S.BRITBOX=C(m,"bbc"),{ApplicationType:{WEB:"web",MOBILE_WEB:"mobile-web",RESPONSIVE:"responsive",MOBILE_APP:"mobile-app",BIGSCREEN_HTML:"bigscreen-html",BIGSCREEN_FLASH:"bigscreen-flash",BIGSCREEN_APP:"bigscreen-app",BIGSCREEN_CAST:"bigscreen-cast",DESKTOP_APP:"desktop-app",AMP:"amp"},WindowState:{FULL:"full",NORMAL:"norm",MINIMISED:"min",MAXIMISED:"max",PICTUREINPICTURE:"picture-in-picture"},MediaIdType:{VERSION:"version",CLIP:"clip",EPISODE:"episode",SERVICE:"service",VPID:"vpid",NONPIPSCONTENTID:"nonpipscontentid",PRODUCER:"producer",BRAND:"brand",SERIES:"series",WSPARTNERID:"ptnrID"},MediaClipType:{UNDEFINED:void 0,CLIP:"clip",EPISODE:"episode"},MediaInitiationType:{UNDEFINED:void 0,USER:"user",AUTO:"auto"},AvType:{AUDIO:"audio",VIDEO:"video"},RetrievalType:{STREAM:"stream",DOWNLOAD:"download"},Form:{LONG:"long",SHORT:"short"},PIPsType:{CLIP:"clip",EPISODE:"ep"},MediaConsumptionMode:{ON_DEMAND:"ondemand",LIVE:"live",DOWNLOAD:"download"},EchoCacheMode:{NEVER:"never",OFFLINE:"offline",ALL:"all"},ManagedLabels:{EVENT_MASTER_BRAND:"event_master_brand",BBC_SITE:"bbc_site",IPLAYER_STATE:"iplayer_state",STORE_ED_TYPE:"store_ed_type",IPLAYER_AVAIL:"iplayer_avail",STORE_REFERRAL:"store_referral",BBC_HASHED_ID:"bbc_hid"},ReportingProfiles:S,EssError:{STATUS_CODE:"status_code",TIMEOUT:"timeout",JSON:"json",RUNTIME:"runtime_error"},Destinations:s,Producers:c,NationsProducer:u,Masterbrands:l,EchoLabelKeys:a}}.call(t,A,t,e))||(e.exports=i)},function(e,t,i){var n;void 0===(n=function(){"use strict";return{ECHO_ENABLED:"enabled",ECHO_AUTO_START:"auto_start",ECHO_TRACE:"trace",ECHO_DEVICE_ID:"device_id",REPORTING_PROFILE:"reporting_profile",ECHO_CACHE_MODE:"cache_mode",DEBUG_MODE:"disabled",ECHO_NAME:"lib_name",ECHO_VERSION:"lib_version",USE_SSC:"use_ssc",SSC_HOSTNAME:"ssc_hostname",COMSCORE_ENABLED:"comscore.enabled",COMSCORE_HOST:"comscore.host",COMSCORE_SITE:"comscore.site",COMSCORE_CUSTOMER_ID:"comscore.customer_id",COMSCORE_PUBLISHER_SECRET:"comscore.publisher_secret",ATI_ENABLED:"ati.enabled",ATI_LOG:"ati.log",ATI_SSL_LOG:"ati.ssl_log",ATI_DOMAIN:"ati.domain",ATI_PIXEL_PATH:"ati.pixel_path",ATI_FORCE_HTTP:"ati.force_http",ATI_FORCE_HTTPS:"ati.force_https",ATI_CACHE_MODE_ALWAYS:"always",ATI_CACHE_MODE_REQUIRED:"required",ATI_CACHE_MODE_NEVER:"never",APP_CATEGORY:"app_category",ATI_DISABLE_COOKIE:"ati.disable_cookie",ATI_USE_DEFAULT_COOKIE_DOMAIN:"ati.use_default_cookie_domain",KEEPALIVE_DURATION:"keepalive_duration",ATI_COLLECT_DOMAIN:"ati.collect_domain",ATI_COLLECT_DOMAIN_SSL:"ati.collect_domain_ssl",DESTINATION:"bbc_destination",PRODUCER:"bbc_producer",TEST_SERVICE_ENABLED:"test.enabled",TEST_SERVICE_URL:"test.url",BARB_ENABLED:"barb.enabled",BARB_SITE_CODE:"barb.site_code",BARB_DEBUG:"barb.debug",USE_ESS:"use_ess",ESS_HOSTNAME:"ess.hostname",REMOTE_CONFIG_MANAGER:"remote_config_manager",REMOTE_CONFIG_URL:"remote_config_url",PRODUCER_CONFIG_FILENAME:"producer_config_filename",MASTERBRAND_CONFIG_FILENAME:"masterbrand_config_filename"}}.call(t,i,t,e))||(e.exports=n)},function(e,t,s){var i;void 0===(i=function(e){"use strict";var c=s(1),u=s(0),t=s(2),l=s(27),i=["player_name","ns_st_ws","bbc_site","app_type","app_name","bbc_store_pf","bbc_store_ed","bbc_store_fr","bbc_store_src"],n=["token","guardianToken","nonce","dateOfBirthDay","dateOfBirthMonth","dateOfBirthYear","dateOfBirth","permissionToken"],d={name:l.COUNTERNAME};d[t.ManagedLabels.EVENT_MASTER_BRAND]=l.EVENT_MASTER_BRAND;for(var r=0;r<i.length;r++)d[i[r]]=l.STRICT;function p(e){return e&&e.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/(^_+)|(_+$)/g,"")}function o(e){var t=p(e);return c.assert(e===t,'Label key can only contain: [a-z0-9_], and no consecutive "_"s or "_" at the begining or end, got "'+e+'". This will be sent as "'+t+'"',!0),t}function h(e){var t=e&&e.toLowerCase().replace(/[^a-z0-9\.]+/g,"_").replace(/\.+/g,".").replace(/(^_+)|(_+$)/g,"")||"no.name.page";return e!==t&&(e&&-1!==e.search(/-/)?u.warn('Submitted countername ("'+e+'") contains at least one "-". Dashes are not permitted but, for legacy reasons, "-" and "_" are equivalent in DAx. Echo converts dashes to underscores, so the countername will be sent as "'+t+'"'):u.warn('countername may only contain: [a-z0-9._], got "'+e+'". This will be cleaned up and sent as "'+t+'"')),-1===t.search(/\.page$/)&&(t+=".page"),t}function a(e,t){var i,n="",r=t,o=(i=e,d.hasOwnProperty(i)?d[i]:l.CUSTOM);if(o===l.COUNTERNAME&&(t=h(t)),"number"==typeof t||"boolean"==typeof t)return t.toString();if("string"==typeof t){switch(o){case l.EVENT_MASTER_BRAND:n='Label value can only contain [0-9a-z], and no consecutive "_"s and no "_"s or whitespace at the start or end.',r=p(t);break;case l.STRICT:n='Strict Label values can only contain [ 0-9a-z-], and no consecutive "-"s and no "-"s or whitespace at the start or end.',r=(s=t)&&s.toLowerCase().replace(/(^\s+)|(\s+$)/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-+)|(-+$)/g,"");break;case l.NO_CLEANSING:break;default:n="Custom Label value cannot contain whitespace at start or end or pipes (|).",r=(a=t)&&a.replace(/(^\s+)|(\s+$)/g,"").replace(/\|/g,"!")}var a,s;return n+='Got "'+t+'", will be replaced with "'+r+'"',c.assert(t===r,n,!0),r}u.error("Label "+e+" must have number, boolean or string value")}return{cleanCounterName:h,cleanLabelKey:o,cleanLabelValue:a,cleanLanguage:function(e){if("number"==typeof e||"boolean"==typeof e)return e.toString();var t=e&&e.replace(/(^\s*)|(\s*$)/g,"").replace(/[^0-9a-zA-Z._]+/g,"-").replace(/(^-)|(-$)/g,"")||"";return c.assert(e===t,'Language label value can only contain [0-9a-zA-Z._-], and no consecutive "-"s and no - at the start or end. Got "'+e+'", will be replaced with "'+t+'"',!0),t},cleanLabels:function(e){var t,i={};for(var n in e)i[t=o(n)]=a(t,e[n]);return i},cleanCustomVariable:function(e){return e&&e.toString().replace(/[\u200B-\u200D\uFEFF]+/g,"").trim().replace(/\[|\]/g,"").replace(/&/g,"$").replace(/\s{1,}/g," ")},cleanMediaId:function(e){return"string"!=typeof e?e:e&&e.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9/.~\-_]/g,"")},removeSensitiveInfo:function(e){if(e&&"string"==typeof e)for(r=0;r<n.length;r++){var t=new RegExp(n[r]+"=[^&]*","g");e=e.replace(t,n[r]+"=XXXX")}return e},removeUndefined:function(t){return Object.keys(t).forEach(function(e){void 0===t[e]&&(u.info("Removing key "+e+" as value is undefined"),delete t[e])}),t}}}.call(t,s,t,e))||(e.exports=i)},function(e,t,i){var n;void 0===(n=function(){"use strict";return{ACADEMY:125,ACCOUNT:1,AFAAN_OROMOO:2,AFRIQUE:3,AMHARIC:4,ARABIC:5,AZERI:6,BBC:7,BBC_ALBA:8,BBC_ARCHIVE:127,BBC_ARTS:9,BBC_ASIAN_NETWORK:10,BBC_FOOD:11,BBC_FOUR:12,BBC_HD:13,BBC_MUSIC:14,BBC_NEWS_CHANNEL:15,BBC_ONE:16,BBC_PARLIAMENT_CHANNEL:17,BBC_RADIO:18,BBC_RADIO_1:19,BBC_RADIO_1XTRA:20,BBC_RADIO_2:21,BBC_RADIO_3:22,BBC_RADIO_4:23,BBC_RADIO_4_EXTRA:24,BBC_RADIO_5_LIVE:25,BBC_RADIO_6_MUSIC:26,BBC_SCOTLAND:120,BBC_SEND:121,BBC_STUDIOS:128,BBC_THREE:28,BBC_TWO:29,BBC_WORLD_NEWS:30,BENGALI:31,BITESIZE:32,BRASIL:33,BRITBOX:34,BRITBOX_AU:132,BURMESE:35,CBBC:36,CBEEBIES:37,CHINESE:38,ENGLISH_REGIONS:39,GAHUZA:40,GATEWAY:41,GNL_AUTOS:42,GNL_CAPITAL:43,GNL_CULTURE:44,GNL_EARTH:45,GNL_FUTURE:46,GNL_HOMEPAGE:47,GNL_STORYWORKS:48,GNL_TRAVEL:49,GUJARATI:50,HAUSA:51,HINDI:52,IGBO:53,INDONESIAN:54,IPLAYER:55,JAPANESE:56,KOREAN:57,KYRGYZ:58,MARATHI:59,MEDIA_ACTION:60,MONITORING:61,MUNDO:62,NEPALI:63,NEWS:64,NEWS_LABS:129,NEWSROUND:65,NORTHERN_IRELAND:66,OTHER:67,OWN_IT:118,PARTICIPATION:130,PASHTO:68,PERSIAN:69,PIDGIN:70,PROGRAMMES:71,PS_HOMEPAGE:72,PUNJABI:73,RD:126,RECEPTION:124,REEL:74,RUSSIAN:75,S4C:76,SCHOOL_RADIO:77,SCHOOL_REPORT:78,SCOTLAND:79,SEARCH:80,SERBIAN:81,SINHALA:82,SOMALI:83,SOUNDS:84,SPORT:85,SWAHILI:86,TAMIL:87,TASTER:88,TEACH:119,TELUGU:89,THAI:90,TIGRINYA:91,TURKISH:92,TV_CERTIFICATION:131,UK_CHINA:93,UKRAINIAN:94,URDU:95,UZBEK:96,VIETNAMESE:97,VOICE:98,VOICE_FIRST_FORMATS:99,VOLT:122,WALES:100,WEATHER:101,WEATHER_WATCHERS:102,WORLD_SERVICE_ENGLISH:103,WORKLIFE:104,WS_LEARNING_ENGLISH:105,WS_PARTNERS_B2B:106,YORUBA:107,NEWS_ENGLISH_REGIONS:108,SPORT_ENGLISH_REGIONS:109,NEWS_SCOTLAND:110,SPORT_SCOTLAND:111,NEWS_WALES:112,SPORT_WALES:113,NEWS_NORTHERN_IRELAND:114,SPORT_NORTHERN_IRELAND:115,AUDIENCE_SERVICES:116,WORLD_NEWS_PROGRAMMES:117,getId:function(e){var t;return e&&(t=this[e.toUpperCase()]),t}}}.call(t,i,t,e))||(e.exports=n)},function(e,t,i){e.exports={BBC_COUNTER_NAME:"name",ECHO_EVENT_NAME:"echo_event",APP_VERSION:"apvr",HASHED_ID:"at",LEVEL_1_SITE:"site",LEVEL_2_SITE:"level2",SECTION:"section",CHAPTER_1:"chapter1",CONTENT_ID:"bbc_content_id",APP_TYPE:"bbc_app_type",APP_NAME:"bbc_app_name",APP_CATEGORY:"app_category",LANGUAGE:"language",URL:"bbc_url",REFERRER_URL:"bbc_referrer_url",CONTENT_TYPE:"bbc_content_type",NATIONS_PRODUCER:"nations_producer",LIBRARY_VERSION:"bbc_library_version",PAGE_TITLE:"page_title",CUSTOM_VAR_1:"custom_var_1",CUSTOM_VAR_2:"custom_var_2",CUSTOM_VAR_3:"custom_var_3",CUSTOM_VAR_4:"custom_var_4",CUSTOM_VAR_5:"custom_var_5",CUSTOM_VAR_6:"custom_var_6",CUSTOM_VAR_7:"custom_var_7",CUSTOM_VAR_8:"custom_var_8",CUSTOM_VAR_9:"custom_var_9",CUSTOM_VAR_10:"custom_var_10",MEDIA_PLAYER:"bbc_media_player",LOGGED_IN:"bbc_identity",BBC_HID:"bbc_hid",MEDIA_BRAND:"brand",MEDIA_SERIES:"series",MEDIA_WS_PARTNER_ID:"ptnrID",CASTING_DEVICE_REFERRER:"devR",IS_BACKGROUND:"is_background",SOURCE:"source",CONTAINER:"container",METADATA:"metadata",PERSONALISATION:"personalisation",RESULT:"result",TEST_COOKIE_DOMAIN:"testCookieDomain",CHANNEL:"src_channel",MEDIUM:"src_medium",CAMPAIGN:"src_campaign",CAMPAIGN_GROUP:"src_campaign_group",VENDOR:"src_vendor",CREATION:"src_creation",FORMAT:"src_format",AFFILIATE_TYPE:"src_aff_type"}},function(e,t,i){e.exports={BBC_APPLICATION_NAME:"app_name",BBC_APPLICATION_TYPE:"app_type",BBC_APPLICATION_VERSION:"app_version",BBC_COUNTER_NAME:"name",DESTINATION:"bbc_destination",PRODUCER:"bbc_producer",BBC_LANGUAGE:"language",DEVICE_ID:"ns_alias",COMSCORE_C1:"c1",COMSCORE_C7:"c7",BBC_MEASUREMENT_LIB_NAME:"ml_name",BBC_MEASUREMENT_LIB_VERSION:"ml_version",ECHO_TRACE:"trace",ECHO_EVENT_NAME:"echo_event",EVENT_TRIGGERED_BY_USER:"ns_st_ui",STREAMSENSE_CUSTOM_EVENT_TYPE:"ns_st_ev",USER_ACTION_TYPE:"action_type",USER_ACTION_NAME:"action_name",PLAYLIST_END:"ns_st_pe",REWIND_FF_RATE:"ffrw_rate",COMSCORE_SITE:"ns_site",COMSCORE_CUSTOMER:"c2",COMSCORE_ENDPOINT:"comscore_endpoint",PLAYER_NAME:"ns_st_mp",PLAYER_VERSION:"ns_st_mv",PLAYER_WINDOW_STATE:"ns_st_ws",PLAYER_VOLUME:"ns_st_vo",PLAYER_POPPED:"bbc_st_pop",PLAYER_SUBTITLED:"bbc_st_sub",PLAYLIST_NAME:"ns_st_pl",PLAYLIST_CLIP_COUNT:"ns_st_cp",PLAYLIST_LENGTH:"ns_st_ca",MEDIA_PID:"ns_st_ci",MEDIA_LENGTH:"ns_st_cl",MEDIA_STREAM_TYPE:"ns_st_ty",MEDIA_IS_LIVE:"ns_st_li",MEDIA_EPISODE_ID:"episode_id",MEDIA_CLIP_ID:"clip_id",MEDIA_CLIP_NUMBER:"ns_st_cn",MEDIA_PART_NUMBER:"ns_st_pn",MEDIA_TOTAL_PARTS:"ns_st_tp",MEDIA_MEDIUM:"bbc_st_med",MEDIA_LIVE_OR_ONDEMAND:"bbc_st_lod",MEDIA_FORM:"bbc_st_mf",MEDIA_RETRIEVAL_TYPE:"bbc_st_ret",MEDIA_SCHEDULE_INDICATOR:"bbc_st_sch",MEDIA_VERSION_ID:"version_id",MEDIA_SERVICE_ID:"service_id",MEDIA_NON_PIPS_CONTENT_ID:"non_pips_content_id",MEDIA_AMBIGUOUS_ID:"ambig_ci",MEDIA_TIMESTAMP:"bbc_st_live_ts",ESS_SUCCESS:"ess_success",ESS_ERROR:"ess_error",ESS_STATUS_CODE:"ess_status_code",APP_PLATFORM_NAME:"ns_ap_pn",APP_PLATFORM_RUNTIME:"ns_ap_pfm",APP_OS_VERSION:"ns_ap_pfv",APP_DEVICE_NAME:"ns_ap_device",APP_SCREEN_RESOLUTION:"ns_ap_res",APP_LANGUAGE:"ns_ap_lang",ENV_CHAR_SET:"ns_c",ENV_TITLE:"c8",ENV_URL:"c7",ENV_REFERRER:"c9",APP_NAME:"ns_ap_an",APP_VERSION:"ns_ap_ver",NO_COOKIES:"ns_nc",COOKIE_POLICY:"bbc_mc",BBC_ID_LOGGED_IN:"bbc_identity",WEB_SCREEN_RES:"screen_resolution",ESS_ENABLED:"ess_enabled",ESS_ENRICHED:"ess_enriched"}},function(e,t,l){var i;void 0===(i=function(e){"use strict";var t,n,r,i=l(4),o=l(9),a=l(28),s=!1,c=[];function u(){var e=window.screen||{},t=window.navigator||{},i=window.document||{};this._platformRuntimeEnvironment="html",this._platformOSVersion="5",this._screenResolution=(e.width||"-")+"x"+(e.height||"-"),this._language=t.language||"",this._platformName=t.platform||"",this._charset=i.characterSet||i.defaultCharset||"",this._title=i.title||"",this._url=i.URL||"",this._referrer=i.referrer||"",this._deviceName=null,this._httpGet=null,this._executeCrossDomainGet=null,this._getCookie=null,this._setCookie=null,this._setLocalStorageItem=null,this._getLocalStorageItem=null}return u._defaultHttpGet=a.httpGet,u._defaultGetCookie=o.getCookieValueByName,u.prototype.getPlatformName=function(){return this._platformName},u.prototype.getPlatformRuntimeEnvironment=function(){return this._platformRuntimeEnvironment},u.prototype.getPlatformOSVersion=function(){return this._platformOSVersion},u.prototype.getDeviceName=function(){return this._deviceName},u.prototype.getScreenResolution=function(){return this._screenResolution},u.prototype.getLanguage=function(){return this._language},u.prototype.getHttpGet=function(){return this._httpGet},u.prototype.setExecuteCrossDomainGet=function(e){this._executeCrossDomainGet=e},u.prototype.getExecuteCrossDomainGet=function(){return this._executeCrossDomainGet?this._executeCrossDomainGet:a.executeCrossDomainGet},u.prototype.getCookieGetter=function(){return this._getCookie},u.prototype.getCookieSetter=function(){return this._setCookie},u.prototype.getCharSet=function(){return this._charset},u.prototype.getTitle=function(){return this._title},u.prototype.getURL=function(){return this._url},u.prototype.getProtocol=function(){return 0!==this.getURL().toLowerCase().indexOf("http:",0)?"https:":"http:"},u.prototype.getReferrer=function(){return this._referrer},u.prototype.setSetLocalStorageItem=function(e){this._setLocalStorageItem=e},u.prototype.getSetLocalStorageItem=function(){return this._setLocalStorageItem},u.prototype.setGetLocalStorageItem=function(e){this._getLocalStorageItem=e},u.prototype.getGetLocalStorageItem=function(){return this._getLocalStorageItem},u.prototype.setPlatformName=function(e){return this._platformName=e,this},u.prototype.setPlatform=function(e,t){return this._platformRuntimeEnvironment=e,this._platformOSVersion=t,this},u.prototype.setDeviceName=function(e){return this._deviceName=e,this},u.prototype.setScreenResolution=function(e){return this._screenResolution=e,this},u.prototype.setLanguage=function(e){return this._language=i.cleanLanguage(e),this},u.prototype.setHttpGet=function(e){return this._httpGet=e,this},u.prototype.setCookieGetter=function(e){return this._getCookie=e,this},u.prototype.setCookieSetter=function(e){return this._setCookie=e,this},u.prototype.setCharSet=function(e){return this._charset=e,this},u.prototype.setTitle=function(e){return this._title=e,this},u.prototype.setURL=function(e){return this._url=e,this},u.prototype.setReferrer=function(e){return this._referrer=e,this},u.setOrbCookies=function(e){return t=e,this},u.getOrbCookies=function(){return t},u.getOrbCookiesPolicy=function(){if(t&&"function"==typeof t.readPolicy)return t.readPolicy()},u.setOrbIdCta=function(e){return n=e,this},u.getOrbIdCta=function(e){var t=function(e,t){e&&"function"==typeof e&&e(t)};if(void 0===n)if(!1!==r){c.push(e);var i=window.require;void 0===r&&i?!(r="function"==typeof i.defined&&i.defined("idcta/idcta-1"))&&i.s&&i.s.contexts&&i.s.contexts._&&i.s.contexts._.config&&i.s.contexts._.config.paths&&i.s.contexts._.config.paths.idcta&&(r=!0):r=!1,r&&!s?(s=!0,window.require(["idcta/idcta-1"],function(e){for(n=e,0;0<c.length;c++)c[0]&&"function"==typeof c[0]&&t(c[0],n)})):!1===r&&t(e)}else t(e);else t(e,n)},u}.call(t,l,t,e))||(e.exports=i)},function(e,t,i){var n;void 0===(n=function(){"use strict";return{getCookieValueByName:function(e,t){var i=e+"=",n=(t||window).document,r={};if(void 0===n||"string"!=typeof n.cookie)return null;for(var o=0,a=(r=n.cookie.split(";")).length;o<a;o++){var s=r[o];if(" "===s.charAt(0)&&(s=s.substring(1,s.length)),0===s.indexOf(i))return s.substring(i.length,s.length)}return null}}}.call(t,i,t,e))||(e.exports=n)},function(e,t,i){var n;void 0===(n=function(){"use strict";var e=i(5);return{DEFAULT:{id:"596068",defaultProducer:e.BBC,isTest:!0},ACCOUNT:{id:"598250",defaultProducer:e.ACCOUNT,isTest:!1},ACCOUNT_TEST:{id:"598252",defaultProducer:e.ACCOUNT,isTest:!0},AUDIENCE_PORTAL:{id:"602136",defaultProducer:e.AUDIENCE_SERVICES,isTest:!1},AUDIENCE_PORTAL_TEST:{id:"602137",defaultProducer:e.AUDIENCE_SERVICES,isTest:!0},AUDIENCE_SERVICES_PS:{id:"602167",defaultProducer:e.AUDIENCE_SERVICES,isTest:!1},AUDIENCE_SERVICES_PS_TEST:{id:"602168",defaultProducer:e.AUDIENCE_SERVICES,isTest:!0},BBC_ARCHIVE_PS:{id:"605565",defaultProducer:e.BBC_ARCHIVE,isTest:!1},BBC_ARCHIVE_PS_TEST:{id:"605566",defaultProducer:e.BBC_ARCHIVE,isTest:!0},BBC_CORPORATE_PS:{id:"603550",defaultProducer:e.BBC,isTest:!1},BBC_CORPORATE_PS_TEST:{id:"603551",defaultProducer:e.BBC,isTest:!0},BBC_SYNDICATION:{id:"601718",defaultProducer:e.BBC,isTest:!1},BBC_SYNDICATION_TEST:{id:"601719",defaultProducer:e.BBC,isTest:!0},BBC_STUDIOS_PLAYER:{id:"606296",defaultProducer:e.BBC_STUDIOS,isTest:!1},BBC_STUDIOS_PLAYER_TEST:{id:"606293",defaultProducer:e.BBC_STUDIOS,isTest:!0},BBC_THREE:{id:"598255",defaultProducer:e.BBC_THREE,isTest:!1},BBC_THREE_TEST:{id:"598256",defaultProducer:e.BBC_THREE,isTest:!0},BITESIZE:{id:"598257",defaultProducer:e.BITESIZE,isTest:!1},BITESIZE_TEST:{id:"598258",defaultProducer:e.BITESIZE,isTest:!0},BLOGS_PS:{id:"603546",defaultProducer:e.BBC,isTest:!1},BLOGS_PS_TEST:{id:"603547",defaultProducer:e.BBC,isTest:!0},BRITBOX:{id:"598259",defaultProducer:e.BRITBOX,isTest:!1},BRITBOX_TEST:{id:"598260",defaultProducer:e.BRITBOX,isTest:!0},CBBC:{id:"598261",defaultProducer:e.CBBC,isTest:!1},CBBC_TEST:{id:"598262",defaultProducer:e.CBBC,isTest:!0},CBEEBIES:{id:"598263",defaultProducer:e.CBEEBIES,isTest:!1},CBEEBIES_TEST:{id:"598264",defaultProducer:e.CBEEBIES,isTest:!0},FEATURE_SITES_GNL:{id:"598265",defaultProducer:e.GNL_HOMEPAGE,isTest:!1},FEATURE_SITES_GNL_TEST:{id:"598266",defaultProducer:e.GNL_HOMEPAGE,isTest:!0},FOOD:{id:"598267",defaultProducer:e.BBC_FOOD,isTest:!1},FOOD_TEST:{id:"598268",defaultProducer:e.BBC_FOOD,isTest:!0},GAMES_PS:{id:"599452",defaultProducer:e.BBC,isTest:!1},GAMES_PS_TEST:{id:"599454",defaultProducer:e.BBC,isTest:!0},GATEWAY:{id:"598269",defaultProducer:e.GATEWAY,isTest:!1},GATEWAY_TEST:{id:"598270",defaultProducer:e.GATEWAY,isTest:!0},HOMEPAGE_GNL:{id:"598271",defaultProducer:e.GNL_HOMEPAGE,isTest:!1},HOMEPAGE_GNL_TEST:{id:"598272",defaultProducer:e.GNL_HOMEPAGE,isTest:!0},HOMEPAGE_PS:{id:"598273",defaultProducer:e.PS_HOMEPAGE,isTest:!1},HOMEPAGE_PS_TEST:{id:"598274",defaultProducer:e.PS_HOMEPAGE,isTest:!0},IDEAS:{id:"598275",defaultProducer:e.BBC,isTest:!1},IDEAS_TEST:{id:"598276",defaultProducer:e.BBC,isTest:!0},IPLAYER:{id:"598277",defaultProducer:e.IPLAYER,isTest:!1},IPLAYER_TEST:{id:"598278",defaultProducer:e.IPLAYER,isTest:!0},MEDIA_ACTION:{id:"598279",defaultProducer:e.MEDIA_ACTION,isTest:!1},MEDIA_ACTION_TEST:{id:"598280",defaultProducer:e.MEDIA_ACTION,isTest:!0},MONITORING:{id:"598281",defaultProducer:e.MONITORING,isTest:!1},MONITORING_TEST:{id:"598282",defaultProducer:e.MONITORING,isTest:!0},MUSIC:{id:"598283",defaultProducer:e.BBC_MUSIC,isTest:!1},MUSIC_TEST:{id:"598284",defaultProducer:e.BBC_MUSIC,isTest:!0},NATIONAL_MOMENTS_PS:{id:"605567",defaultProducer:e.BBC,isTest:!1},NATIONAL_MOMENTS_PS_TEST:{id:"605568",defaultProducer:e.BBC,isTest:!0},NEWS_PS:{id:"598285",defaultProducer:e.NEWS,isTest:!1},NEWS_PS_TEST:{id:"598286",defaultProducer:e.NEWS,isTest:!0},NEWS_GNL:{id:"598287",defaultProducer:e.NEWS,isTest:!1},NEWS_GNL_TEST:{id:"598288",defaultProducer:e.NEWS,isTest:!0},NEWS_LANGUAGES_GNL:{id:"598289",defaultProducer:e.NEWS,isTest:!1},NEWS_LANGUAGES_GNL_TEST:{id:"598290",defaultProducer:e.NEWS,isTest:!0},NEWS_LANGUAGES_PS:{id:"598291",defaultProducer:e.NEWS,isTest:!1},NEWS_LANGUAGES_PS_TEST:{id:"598292",defaultProducer:e.NEWS,isTest:!0},NEWSROUND:{id:"598293",defaultProducer:e.NEWSROUND,isTest:!1},NEWSROUND_TEST:{id:"598294",defaultProducer:e.NEWSROUND,isTest:!0},OTHER:{id:"598295",defaultProducer:e.OTHER,isTest:!1},OTHER_TEST:{id:"598297",defaultProducer:e.OTHER,isTest:!0},OWN_IT:{id:"598298",defaultProducer:e.CBBC,isTest:!1},OWN_IT_TEST:{id:"598299",defaultProducer:e.CBBC,isTest:!0},PROGRAMMES_PS:{id:"598300",defaultProducer:e.PROGRAMMES,isTest:!1},PROGRAMMES_PS_TEST:{id:"598301",defaultProducer:e.PROGRAMMES,isTest:!0},PS_AUDIENCE_ENGAGEMENT:{id:"609581",defaultProducer:e.PARTICIPATION,isTest:!1},PS_AUDIENCE_ENGAGEMENT_TEST:{id:"609582",defaultProducer:e.PARTICIPATION,isTest:!0},RED_BUTTON_PS:{id:"601192",defaultProducer:e.BBC,isTest:!1},RED_BUTTON_PS_TEST:{id:"601193",defaultProducer:e.BBC,isTest:!0},REWIND_PS:{id:"603552",defaultProducer:e.BBC,isTest:!1},REWIND_PS_TEST:{id:"603553",defaultProducer:e.BBC,isTest:!0},R_AND_D_PS:{id:"607103",defaultProducer:e.RD,isTest:!1},R_AND_D_PS_TEST:{id:"607104",defaultProducer:e.RD,isTest:!0},SEARCH_GNL:{id:"598302",defaultProducer:e.SEARCH,isTest:!1},SEARCH_GNL_TEST:{id:"598303",defaultProducer:e.SEARCH,isTest:!0},SEARCH_PS:{id:"598304",defaultProducer:e.SEARCH,isTest:!1},SEARCH_PS_TEST:{id:"598305",defaultProducer:e.SEARCH,isTest:!0},SILVER_PS:{id:"607105",defaultProducer:e.BBC,isTest:!1},SILVER_PS_TEST:{id:"607106",defaultProducer:e.BBC,isTest:!0},SOUNDS:{id:"598306",defaultProducer:e.SOUNDS,isTest:!1},SOUNDS_TEST:{id:"598307",defaultProducer:e.SOUNDS,isTest:!0},SPORT_GNL:{id:"598308",defaultProducer:e.SPORT,isTest:!1},SPORT_GNL_TEST:{id:"598309",defaultProducer:e.SPORT,isTest:!0},SPORT_PS:{id:"598310",defaultProducer:e.SPORT,isTest:!1},SPORT_PS_TEST:{id:"598311",defaultProducer:e.SPORT,isTest:!0},STORYWORKS_GNL:{id:"598312",defaultProducer:e.GNL_STORYWORKS,isTest:!1},STORYWORKS_GNL_TEST:{id:"598313",defaultProducer:e.GNL_STORYWORKS,isTest:!0},SUBTITLES_PS:{id:"603548",defaultProducer:e.PROGRAMMES,isTest:!1},SUBTITLES_PS_TEST:{id:"603549",defaultProducer:e.PROGRAMMES,isTest:!0},SYNDICATION_PARTNERS_GNL:{id:"598314",defaultProducer:e.WS_PARTNERS_B2B,isTest:!1},SYNDICATION_PARTNERS_GNL_TEST:{id:"598315",defaultProducer:e.WS_PARTNERS_B2B,isTest:!0},TASTER:{id:"598316",defaultProducer:e.TASTER,isTest:!1},TASTER_TEST:{id:"598317",defaultProducer:e.TASTER,isTest:!0},TEACH:{id:"598318",defaultProducer:e.BBC,isTest:!1},TEACH_TEST:{id:"598320",defaultProducer:e.BBC,isTest:!0},TOPICS_GNL:{id:"612991",defaultProducer:e.BBC,isTest:!1},TOPICS_GNL_TEST:{id:"614559",defaultProducer:e.BBC,isTest:!0},TOPICS_PS:{id:"612261",defaultProducer:e.BBC,isTest:!1},TOPICS_PS_TEST:{id:"612262",defaultProducer:e.BBC,isTest:!0},VOICE:{id:"598326",defaultProducer:e.VOICE,isTest:!1},VOICE_TEST:{id:"598328",defaultProducer:e.VOICE,isTest:!0},WEATHER_GNL:{id:"598330",defaultProducer:e.WEATHER,isTest:!1},WEATHER_GNL_TEST:{id:"598332",defaultProducer:e.WEATHER,isTest:!0},WEATHER_PS:{id:"598338",defaultProducer:e.WEATHER,isTest:!1},WEATHER_PS_TEST:{id:"598339",defaultProducer:e.WEATHER,isTest:!0},WS_LEARNING_ENGLISH:{id:"598340",defaultProducer:e.WS_LEARNING_ENGLISH,isTest:!1},WS_LEARNING_ENGLISH_TEST:{id:"598341",defaultProducer:e.WS_LEARNING_ENGLISH,isTest:!0},WS_NEWS_LANGUAGES:{id:"598342",defaultProducer:e.BBC_WORLD_NEWS,isTest:!1},WS_NEWS_LANGUAGES_TEST:{id:"598343",defaultProducer:e.BBC_WORLD_NEWS,isTest:!0},WS_PARTNERS_B2B:{id:"598820",defaultProducer:e.WS_PARTNERS_B2B,isTest:!1},WS_PARTNERS_B2B_TEST:{id:"598823",defaultProducer:e.WS_PARTNERS_B2B,isTest:!0},WS_PROGRAMMES:{id:"598344",defaultProducer:e.PROGRAMMES,isTest:!1},WS_PROGRAMMES_TEST:{id:"598345",defaultProducer:e.PROGRAMMES,isTest:!0},WS_SYNDICATION_PARTNERS:{id:"598346",defaultProducer:e.WS_PARTNERS_B2B,isTest:!1},WS_SYNDICATION_PARTNERS_TEST:{id:"598347",defaultProducer:e.WS_PARTNERS_B2B,isTest:!0},get:function(e){var t;return e&&(t=this[e.toUpperCase()]),t}}}.call(t,i,t,e))||(e.exports=n)},function(e,t,i){var n;void 0===(n=function(){"use strict";var e=i(5);return{BBC_NEWS:e.BBC_NEWS_CHANNEL,BBC_NEWS24:e.BBC_NEWS_CHANNEL,BBC_WORLD_NEWS:e.BBC_WORLD_NEWS,BBC_AFRIQUE_RADIO:e.AFRIQUE,BBC_AFRIQUE_TV:e.AFRIQUE,BBC_AMHARIC_RADIO:e.AMHARIC,BBC_ARABIC_RADIO:e.ARABIC,BBC_ARABIC_TV:e.ARABIC,BBC_BENGALI_RADIO:e.BENGALI,BBC_BRASIL:e.BRASIL,BBC_BURMESES_RADIO:e.BURMESE,BBC_BURMESES_TV:e.BURMESE,BBC_CANTONESE_RADIO:e.CHINESE,BBC_DARI_RADIO:e.PERSIAN,BBC_GAHUZA_RADIO:e.GAHUZA,BBC_GUJARATI_TV:e.GUJARATI,BBC_HAUSA_RADIO:e.HAUSA,BBC_HAUSA_TV:e.HAUSA,BBC_HINDI_RADIO:e.HINDI,BBC_HINDI_TV:e.HINDI,BBC_IGBO_RADIO:e.IGBO,BBC_IGBO_TV:e.IGBO,BBC_INDONESIAN_RADIO:e.INDONESIAN,BBC_KOREAN_RADIO:e.KOREAN,BBC_KOREAN_TV:e.KOREAN,BBC_KYRGYZ_RADIO:e.KYRGYZ,BBC_KYRGYZ_TV:e.KYRGYZ,BBC_LEARNING_ENGLISH:e.WS_LEARNING_ENGLISH,BBC_MARATHI_TV:e.MARATHI,BBC_MUNDO:e.MUNDO,BBC_NEPALI_RADIO:e.NEPALI,BBC_OROMO_RADIO:e.AFAAN_OROMOO,BBC_PARLIAMENT:e.BBC_PARLIAMENT_CHANNEL,BBC_PASHTO_RADIO:e.PASHTO,BBC_PASHTO_TV:e.PASHTO,BBC_PERSIAN_RADIO:e.PERSIAN,BBC_PERSIAN_TV:e.PERSIAN,BBC_PIDGIN_RADIO:e.PIDGIN,BBC_PIDGIN_TV:e.PIDGIN,BBC_PUNJABI_TV:e.PUNJABI,BBC_RUSSIAN_RADIO:e.RUSSIAN,BBC_RUSSIAN_TV:e.RUSSIAN,BBC_SINHALA_RADIO:e.SINHALA,BBC_SOMALI_RADIO:e.SOMALI,BBC_SOMALI_TV:e.SOMALI,BBC_SWAHILI_RADIO:e.SWAHILI,BBC_SWAHILI_TV:e.SWAHILI,BBC_TAMIL_RADIO:e.TAMIL,BBC_TAMIL_TV:e.TAMIL,BBC_TELUGU_TV:e.TELUGU,BBC_THAI:e.THAI,BBC_TIGRINYA_RADIO:e.TIGRINYA,BBC_UKRAINIAN_TV:e.UKRAINIAN,BBC_URDU_RADIO:e.URDU,BBC_URDU_TV:e.URDU,BBC_UZBEK_RADIO:e.UZBEK,BBC_UZBEK_TV:e.UZBEK,BBC_WEATHER:e.WEATHER,BBC_WORLD_SERVICE:e.WORLD_SERVICE_ENGLISH,BBC_WORLD_SERVICE_TV:e.WORLD_SERVICE_ENGLISH,BBC_YORUBA_RADIO:e.YORUBA,BBC_YORUBA_TV:e.YORUBA,PARLIAMENTS_ONLINE:e.BBC_PARLIAMENT_CHANNEL,BBC_ALBA:e.BBC_ALBA,BBC_CYMRU:e.WALES,BBC_FOUR:e.BBC_FOUR,BBC_HD:e.BBC_HD,BBC_LONDON:e.ENGLISH_REGIONS,BBC_MUSIC:e.BBC_MUSIC,BBC_MUSIC_JAZZ:e.BBC_MUSIC,BBC_ONE:e.BBC_ONE,BBC_ONE_EAST:e.ENGLISH_REGIONS,BBC_ONE_EAST_MIDLANDS:e.ENGLISH_REGIONS,BBC_ONE_EAST_YORKSHIRE:e.ENGLISH_REGIONS,BBC_ONE_LONDON:e.ENGLISH_REGIONS,BBC_ONE_NORTH_EAST:e.ENGLISH_REGIONS,BBC_ONE_NORTH_WEST:e.ENGLISH_REGIONS,BBC_ONE_NORTHERN_IRELAND:e.NORTHERN_IRELAND,BBC_ONE_SCOTLAND:e.SCOTLAND,BBC_ONE_SOUTH:e.ENGLISH_REGIONS,BBC_ONE_SOUTH_EAST:e.ENGLISH_REGIONS,BBC_ONE_SOUTH_WEST:e.ENGLISH_REGIONS,BBC_ONE_WALES:e.WALES,BBC_ONE_WEST:e.ENGLISH_REGIONS,BBC_ONE_WEST_MIDLANDS:e.ENGLISH_REGIONS,BBC_ONE_YORKS:e.ENGLISH_REGIONS,BBC_SCOTLAND:e.BBC_SCOTLAND,BBC_TEES:e.ENGLISH_REGIONS,BBC_THREE:e.BBC_THREE,BBC_TWO:e.BBC_TWO,BBC_TWO_ENGLAND:e.ENGLISH_REGIONS,BBC_TWO_NORTHERN_IRELAND:e.NORTHERN_IRELAND,BBC_TWO_NORTHERN_IRELAND_DIGITAL:e.NORTHERN_IRELAND,BBC_TWO_SCOTLAND:e.SCOTLAND,BBC_TWO_WALES:e.WALES,BBC_WALES:e.WALES,BBC_WM:e.ENGLISH_REGIONS,CBBC:e.CBBC,CBEEBIES:e.CBEEBIES,BBC_1XTRA:e.BBC_RADIO_1XTRA,BBC_6MUSIC:e.BBC_RADIO_6_MUSIC,BBC_7:e.BBC_RADIO_4_EXTRA,BBC_ASIAN_NETWORK:e.BBC_ASIAN_NETWORK,BBC_RADIO_BERKSHIRE:e.ENGLISH_REGIONS,BBC_RADIO_BRISTOL:e.ENGLISH_REGIONS,BBC_RADIO_CAMBRIDGE:e.ENGLISH_REGIONS,BBC_RADIO_CORNWALL:e.ENGLISH_REGIONS,BBC_RADIO_COVENTRY_WARWICKSHIRE:e.ENGLISH_REGIONS,BBC_RADIO_CUMBRIA:e.ENGLISH_REGIONS,BBC_RADIO_CYMRU:e.WALES,BBC_RADIO_CYMRU_2:e.WALES,BBC_RADIO_CYMRU_MWY:e.WALES,BBC_RADIO_DERBY:e.ENGLISH_REGIONS,BBC_RADIO_DEVON:e.ENGLISH_REGIONS,BBC_RADIO_ESSEX:e.ENGLISH_REGIONS,BBC_RADIO_FIVE_LIVE:e.BBC_RADIO_5_LIVE,BBC_RADIO_FIVE_LIVE_OLYMPICS_EXTRA:e.BBC_RADIO_5_LIVE,BBC_RADIO_FIVE_LIVE_SPORTS_EXTRA:e.BBC_RADIO_5_LIVE,BBC_RADIO_FOUR:e.BBC_RADIO_4,BBC_RADIO_FOUR_EXTRA:e.BBC_RADIO_4_EXTRA,BBC_RADIO_FOYLE:e.NORTHERN_IRELAND,BBC_RADIO_GLOUCESTERSHIRE:e.ENGLISH_REGIONS,BBC_RADIO_GUERNSEY:e.ENGLISH_REGIONS,BBC_RADIO_HEREFORD_WORCESTER:e.ENGLISH_REGIONS,BBC_RADIO_HUMBERSIDE:e.ENGLISH_REGIONS,BBC_RADIO_JERSEY:e.ENGLISH_REGIONS,BBC_RADIO_KENT:e.ENGLISH_REGIONS,BBC_RADIO_LANCASHIRE:e.ENGLISH_REGIONS,BBC_RADIO_LEEDS:e.ENGLISH_REGIONS,BBC_RADIO_LEICESTER:e.ENGLISH_REGIONS,BBC_RADIO_LINCOLNSHIRE:e.ENGLISH_REGIONS,BBC_RADIO_MANCHESTER:e.ENGLISH_REGIONS,BBC_RADIO_MERSEYSIDE:e.ENGLISH_REGIONS,BBC_RADIO_NAN_GAIDHEAL:e.SCOTLAND,BBC_RADIO_NEWCASTLE:e.ENGLISH_REGIONS,BBC_RADIO_NORFOLK:e.ENGLISH_REGIONS,BBC_RADIO_NORTHAMPTON:e.ENGLISH_REGIONS,BBC_RADIO_NOTTINGHAM:e.ENGLISH_REGIONS,BBC_RADIO_ONE:e.BBC_RADIO_1,BBC_RADIO_ONE_VINTAGE:e.BBC_RADIO_1,BBC_RADIO_OXFORD:e.ENGLISH_REGIONS,BBC_RADIO_SCOTLAND:e.SCOTLAND,BBC_RADIO_SCOTLAND_FM:e.SCOTLAND,BBC_RADIO_SCOTLAND_MUSIC_EXTRA:e.SCOTLAND,BBC_RADIO_SHEFFIELD:e.ENGLISH_REGIONS,BBC_RADIO_SHROPSHIRE:e.ENGLISH_REGIONS,BBC_RADIO_SOLENT:e.ENGLISH_REGIONS,BBC_RADIO_SOMERSET_SOUND:e.ENGLISH_REGIONS,BBC_RADIO_STOKE:e.ENGLISH_REGIONS,BBC_RADIO_SUFFOLK:e.ENGLISH_REGIONS,BBC_RADIO_SURREY:e.ENGLISH_REGIONS,BBC_RADIO_SUSSEX:e.ENGLISH_REGIONS,BBC_RADIO_SWINDON:e.ENGLISH_REGIONS,BBC_RADIO_THREE:e.BBC_RADIO_3,BBC_RADIO_TWO:e.BBC_RADIO_2,BBC_RADIO_TWO_COUNTRY:e.BBC_RADIO_2,BBC_RADIO_TWO_EUROVISION:e.BBC_RADIO_2,BBC_RADIO_TWO_FIFTIES:e.BBC_RADIO_2,BBC_RADIO_ULSTER:e.NORTHERN_IRELAND,BBC_RADIO_WALES:e.WALES,BBC_RADIO_WILTSHIRE:e.ENGLISH_REGIONS,BBC_RADIO_YORK:e.ENGLISH_REGIONS,BBC_SOUNDS_MIXES:e.SOUNDS,BBC_SOUNDS_PODCASTS:e.SOUNDS,BBC_SOUTHERN_COUNTIES_RADIO:e.ENGLISH_REGIONS,BBC_THREE_COUNTIES_RADIO:e.ENGLISH_REGIONS,CBEEBIES_RADIO:e.CBEEBIES,BBC_SPORT:e.SPORT,getProducerId:function(e){var t;return e&&(t=this[e.toUpperCase()]),t}}}.call(t,i,t,e))||(e.exports=n)},function(e,t,i){var n;void 0===(n=function(e){"use strict";var t=i(49).version;return{getLibraryName:function(){return"echo_js"},getLibraryVersion:function(){return t}}}.call(t,i,t,e))||(e.exports=n)},function(e,t,i){e.exports={NAME:"echo_js",VERSION:"12.18.0"}},function(e,t,i){var n;void 0===(n=function(){"use strict";return{WALES:"wales",ENGLAND:"england",SCOTLAND:"scotland",NORTHERN_IRELAND:"northern_ireland",NONE:"",getName:function(e){var t;return void 0!==e&&(t=e?this[e.toUpperCase()]:this.NONE),t}}}.call(t,i,t,e))||(e.exports=n)},function(e,t,c){var i;void 0===(i=function(){"use strict";var r=c(0),o=c(3),a="",s="",i={},n={};function e(e,t){this._config=e,this._env=t;var i=e[o.REMOTE_CONFIG_URL];i||(i="https://mybbc-analytics.files.bbci.co.uk/analytics-remote-config/");var n=e[o.PRODUCER_CONFIG_FILENAME];n||(n="producers.json");var r=e[o.MASTERBRAND_CONFIG_FILENAME];r||(r="masterbrands.json"),a=i+n,s=i+r,this.fetchRemoteData(a,s)}return e.prototype.getData=function(e,n){this._env.getExecuteCrossDomainGet()(e,{onSuccess:function(e){n(e)},onError:function(e,t){var i="error";"json"===e?i="json":"object"==typeof e&&"timeout"===e.type&&(i="timeout"),r.error("There was a problem requesting the remote config data",i,t),n()}})},e.prototype.fetchRemoteData=function(e,t){e||r.error("There was no Producer URL found"),this.getData(e,function(e){i=e}),t||r.error("There was no Masterbrand URL found"),this.getData(t,function(e){n=e})},e.prototype.getProducers=function(){return i},e.prototype.getMasterbrands=function(){return n},e}.call(t,c,t,e))||(e.exports=i)},function(e,t,i){var n;void 0===(n=function(){"use strict";function e(){this.reset()}return e.prototype.start=function(){!0!==this._isPlaying&&(this._isPlaying=!0,this._startTime=this._getCurrentTime())},e.prototype.reset=function(){this._isPlaying=!1,this._position=0,this._startTime=0},e.prototype.stop=function(){this._isPlaying&&(this._isPlaying=!1,this._position+=this._getCurrentTime()-this._startTime,this._startTime=0)},e.prototype.getPosition=function(){var e=this._position;return!0===this._isPlaying&&(e+=this._getCurrentTime()-this._startTime),e},e.prototype._getCurrentTime=function(){return Date.now||(Date.now=function(){return(new Date).getTime()}),Date.now()},e}.call(t,i,t,e))||(e.exports=n)},function(e,t,i){var n,r;n=[i(1),i(0),i(2)],void 0===(r=function(e,a,i){"use strict";function r(e,t,i){this._schedule=[],this.serviceId=null,this._media=e,this._environment=t,this._echoClient=i,this._fetchData()}return r.prototype.getBroadcast=function(e){var t,i;for(t=0;t<this._schedule.length;t++)if(e<(i=this._schedule[t].published_time).end&&e>=i.start)return this._schedule[t]},r.essHost="ess.api.bbci.co.uk",r.prototype._fetchData=function(){var e,n=this;e=this._environment.getExecuteCrossDomainGet();var t=this._environment.getProtocol()+r.essHost.replace(/^(\/+)?/,"//")+"/schedules";if(this._media){if(this._media.getServiceId())t+="?serviceId="+encodeURIComponent(this._media.getServiceId()),a.info("Get ServiceID: "+t);else if(this._media.getVersionId())t+="?versionId="+encodeURIComponent(this._media.getVersionId()),a.info("Get VersionID: "+t);else{if(!this._media.getVpId())return a.info("Unable to determine serviceId, versionId or VpId for schedule"),void a.info(t);a.info("Get VPid: "+t),t+="?vpid="+encodeURIComponent(this._media.getVpId())}e(t,{onSuccess:function(e){n._dataSuccessHandler(e)},onError:function(e,t){var i="error";"json"===e?i="json":"object"==typeof e&&"timeout"===e.type&&(i="timeout"),n._dataErrorHandler(i,t)}})}},r.prototype.hasData=function(){return 0<this._schedule.length},r.prototype._dataSuccessHandler=function(e){var t,i,n,r,o=[];if(a.info("Cross-domain schedule request success."),e){for(this._echoClient.setEssSuccess(!0),this.serviceId=e.service.id,e.items=e.items||[],t=0;t<e.items.length;t++)n=e.items[t].published_time.start,r=e.items[t].published_time.end,(i=e.items[t]).published_time.start=new Date(n).getTime(),i.published_time.end=new Date(r).getTime(),o.push(i);this._schedule=o}},r.prototype._dataErrorHandler=function(e,t){this._schedule=[],a.warn("There was a problem requesting the schedule from ESS: "+e),this._echoClient.setEssSuccess(!1),"json"===e?this._echoClient.setEssError(i.EssError.JSON,t):"timeout"===e?this._echoClient.setEssError(i.EssError.TIMEOUT,t):"error"===e&&void 0!==t?this._echoClient.setEssError(i.EssError.STATUS_CODE,t):this._echoClient.setEssError(i.EssError.RUNTIME,"0")},r}.apply(t,n))||(e.exports=r)},function(e,t,p){var i;void 0===(i=function(e){"use strict";var t=p(5),i=p(11),r=p(19),o=p(2),a=p(1),n=p(6),s=p(7),c=p(4),u=p(0),l=o.MediaConsumptionMode;var d=function(e,t){var i,n;this.avType=(i=e)===o.AvType.AUDIO||i===o.AvType.VIDEO?e:null,this.consumptionMode=(n=t)===l.ON_DEMAND||n===l.DOWNLOAD||n===l.LIVE?t:null,a.assert(this.avType,"Media: Invalid avType: "+this.avType,!0),a.assert(this.consumptionMode,"Media: Invalid consumptionMode: "+this.consumptionMode,!0),this.serviceIdObject=new r(o.MediaIdType.SERVICE,!0),this.versionIdObject=new r(o.MediaIdType.VERSION,!0),this.clipIdObject=new r(o.MediaIdType.CLIP,!0),this.episodeIdObject=new r(o.MediaIdType.EPISODE,!0),this.vpIdObject=new r(o.MediaIdType.VPID,!0),this.nonPipsContentIdObject=new r(o.MediaIdType.NONPIPSCONTENT,!1),this.producer=0,this.masterbrand=0,this.useMasterbrandProducer=!1,this.brand="",this.series="",this.length=0,this.bufferLength=0,this.supplier=null,this.mediaSet=null,this.transferFormat=null,this.essEnrichedData=!1,this._isPlaying=!1,this._isBuffering=!1,this._isEmbedded=!1,this.name="",this.type=o.MediaClipType.UNDEFINED,this.playlist="",this.wsPartnerId="",this.initiationType=o.MediaInitiationType.UNDEFINED,this.adsEnabled=!1,this.mediaPlayerName="",this.mediaPlayerVersion="",this.transportMode="",this.castingDeviceReferrer="",this.remoteProducers=null,this.remoteMasterbrands=null};return d.prototype.setRemoteProducers=function(e){this.remoteProducers=e},d.prototype.setRemoteMasterbrands=function(e){this.remoteMasterbrands=e},d.prototype.isEssEnriched=function(){return!0===this.essEnrichedData},d.prototype.setEssEnriched=function(e){this.essEnrichedData=e},d.prototype.getAvType=function(){return this.avType},d.prototype.getMediaConsumptionMode=function(){return this.consumptionMode},d.prototype.getClone=function(){var e=new d(this.avType,this.consumptionMode);return e.brand=this.brand,e.series=this.series,e.serviceIdObject=this.serviceIdObject,e.versionIdObject=this.versionIdObject,e.clipIdObject=this.clipIdObject,e.episodeIdObject=this.episodeIdObject,e.vpIdObject=this.vpIdObject,e.name=this.name,e.type=this.type,e.playlist=this.playlist,e.initiationType=this.initiationType,e.adsEnabled=this.adsEnabled,e.mediaPlayerVersion=this.mediaPlayerVersion,e.mediaPlayerName=this.mediaPlayerName,e.transportMode=this.transportMode,e.castingDeviceReferrer=this.castingDeviceReferrer,e.wsPartnerId=this.wsPartnerId,e.nonPipsContentIdObject=this.nonPipsContentIdObject,e.appName=this.appName,e.appType=this.appType,e.producer=this.producer,e.masterbrand=this.masterbrand,e.remoteProducers=this.remoteProducers,e.remoteMasterbrands=this.remoteMasterbrands,e.useMasterbrandProducer=this.useMasterbrandProducer,e.bufferLength=this.bufferLength,e.mediaSet=this.mediaSet,e.supplier=this.supplier,e.transferFormat=this.transferFormat,e.length=this.length,e.essEnrichedData=this.essEnrichedData,e},d.prototype.isEmbedded=function(){return this._isEmbedded},d.prototype.setIsEmbedded=function(e){return this._isEmbedded=e,this},d.prototype.setVersionId=function(e){return this.versionIdObject.setValue(e),this},d.prototype.setBrand=function(e){return this.brand=c.cleanLabelValue(n.MEDIA_BRAND,e),this},d.prototype.setSeries=function(e){return this.series=c.cleanLabelValue(n.MEDIA_SERIES,e),this},d.prototype.setWsPartnerId=function(e){return this.wsPartnerId=c.cleanLabelValue(n.MEDIA_WS_PARTNER_ID,e),this},d.prototype.setClipId=function(e){return this.clipIdObject.setValue(e),this},d.prototype.setServiceId=function(e){return this.serviceIdObject.setValue(e),this},d.prototype.setEpisodeId=function(e){return this.episodeIdObject.setValue(e),this},d.prototype.setVpId=function(e){return this.vpIdObject.setValue(e),this},d.prototype.setNonPipsContentId=function(e){return this.nonPipsContentIdObject.setValue(c.cleanLabelValue(s.MEDIA_NON_PIPS_CONTENT_ID,e)),this},d.prototype.getSupplier=function(){return this.supplier},d.prototype.setSupplier=function(e){if(null!==e){var t=a.trim(e);0!==t.length&&(this.supplier=t)}return this},d.prototype.setMediaSet=function(e){if(null!==e){var t=a.trim(e);0!==t.length&&(this.mediaSet=t)}return this},d.prototype.getTransferFormat=function(){return this.transferFormat},d.prototype.setTransferFormat=function(e){if(null!==e){var t=a.trim(e);0!==t.length&&(this.transferFormat=t)}return this},d.prototype.isAdsEnabled=function(){return this.adsEnabled},d.prototype.setAdsEnabled=function(e){return this.adsEnabled=e,this},d.prototype.getName=function(){return this.name},d.prototype.setName=function(e){return this.name=e,this},d.prototype.getAppName=function(){return this.appName},d.prototype.setAppName=function(e){return this.appName=e,this},d.prototype.getAppType=function(){return this.appType},d.prototype.setAppType=function(e){return this.appType=e,this},d.prototype.getType=function(){return this.type},d.prototype.setType=function(e){return this.type=e,this},d.prototype.getPlaylist=function(){return this.playlist},d.prototype.setPlaylist=function(e){return this.playlist=e,this},d.prototype.getInitiationType=function(){return this.initiationType},d.prototype.setInitiationType=function(e){return this.initiationType=e,this},d.prototype.getMediaPlayerName=function(){return this.mediaPlayerName},d.prototype.setMediaPlayerName=function(e){return this.mediaPlayerName=e,this},d.prototype.getMediaPlayerVersion=function(){return this.mediaPlayerVersion},d.prototype.setMediaPlayerVersion=function(e){return this.mediaPlayerVersion=e,this},d.prototype.getTransportMode=function(){return this.transportMode},d.prototype.setTransportMode=function(e){return this.transportMode=e,this},d.prototype.setCastingDeviceReferrer=function(e){return this.castingDeviceReferrer=c.cleanLabelValue(n.CASTING_DEVICE_REFERRER,e),this},d.prototype.getLength=function(){return this.length},d.prototype.setLength=function(e){return null!=e&&(e=Math.floor(e)),(void 0===e||isNaN(e)||!isFinite(e)||e<0)&&(u.warn("Media: length must be an integer of 0 or greater. Echo will report as 0."),e=0),this.length=e,this},d.prototype.getProducer=function(){return this.producer},d.prototype.getMasterbrand=function(){return this.masterbrand},d.prototype.setProducer=function(e){this.useMasterbrandProducer=!1,this.producer=e?e.toUpperCase():null},d.prototype.getProducerId=function(){return this.useMasterbrandProducer?this.getProducerIdFromMasterbrand():this.getProducerIdFromProducer()},d.prototype.getProducerIdFromMasterbrand=function(){return this.remoteProducers&&this.remoteMasterbrands&&this.remoteMasterbrands[this.masterbrand]&&this.remoteProducers[this.remoteMasterbrands[this.masterbrand]]?this.remoteProducers[this.remoteMasterbrands[this.masterbrand]]:i.getProducerId(this.masterbrand)?i.getProducerId(this.masterbrand):(null===this.masterbrand||this.masterbrand&&"NULL"===this.masterbrand.toUpperCase()||""===this.masterbrand||u.info("Masterbrand ["+this.masterbrand+"] not recognised, producer will be set to undefined (0)"),0)},d.prototype.getProducerIdFromProducer=function(){return this.remoteProducers&&this.remoteProducers[this.producer]?this.remoteProducers[this.producer]:t.getId(this.producer)?t.getId(this.producer):0},d.prototype.setProducerById=function(e){return e&&(this.producer=e),this},d.prototype.setProducerByMasterbrand=function(e){this.useMasterbrandProducer=!0,this.masterbrand=e?e.toUpperCase():null},d.prototype.getVersionIdObject=function(){return this.versionIdObject},d.prototype.getClipIdObject=function(){return this.clipIdObject},d.prototype.getServiceIdObject=function(){return this.serviceIdObject},d.prototype.getWsPartnerId=function(){return this.wsPartnerId},d.prototype.getCastingDeviceReferrer=function(){return this.castingDeviceReferrer},d.prototype.getEpisodeIdObject=function(){return this.episodeIdObject},d.prototype.getVpIdObject=function(){return this.vpIdObject},d.prototype.getNonPipsContentIdObject=function(){return this.nonPipsContentIdObject},d.prototype.getBrand=function(){return this.brand},d.prototype.getSeries=function(){return this.series},d.prototype.getMediaSet=function(){return this.mediaSet},d.prototype.getVersionId=function(){return this.versionIdObject.getValue()},d.prototype.getClipId=function(){return this.clipIdObject.getValue()},d.prototype.getServiceId=function(){return this.serviceIdObject.getValue()},d.prototype.getEpisodeId=function(){return this.episodeIdObject.getValue()},d.prototype.getVpId=function(){return this.vpIdObject.getValue()},d.prototype.getNonPipsContentId=function(){return this.nonPipsContentIdObject.getValue()},d.prototype.getRetrievalType=function(){return null===this.consumptionMode?null:this.consumptionMode===l.DOWNLOAD?o.RetrievalType.DOWNLOAD:o.RetrievalType.STREAM},d.prototype.isOnDemand=function(){return this.consumptionMode===l.ON_DEMAND},d.prototype.isDownload=function(){return this.consumptionMode===l.DOWNLOAD},d.prototype.isLive=function(){return this.consumptionMode===l.LIVE},d.prototype.isVideo=function(){return this.avType===o.AvType.VIDEO},d.prototype.getPlayerId=function(){return"1"},d.prototype.setPlaying=function(e){return this._isPlaying=Boolean(e),this},d.prototype.getPlaying=function(){return this._isPlaying},d.prototype.setBuffering=function(e){return this._isBuffering=Boolean(e),this},d.prototype.getBuffering=function(){return this._isBuffering},d}.call(t,p,t,e))||(e.exports=i)},function(e,t,r){var i;void 0===(i=function(e){"use strict";var t=r(1),i=r(4),n=function(e,t){this.idType=e,this.value=null,this.isSet=!1,this.isValid=!1,this.requiresValidation=t};return n.prototype.getIdType=function(){return this.idType},n.prototype.setValue=function(e){this.isSet=!0,null==e||"string"!=typeof e||0===e.length?(t.assert(!1,"MediaId: The value for "+this.idType+"Id is invalid",!0),this.isValid=!1):this.isValid=!0,this.value=i.cleanMediaId(e)},n.prototype.getValue=function(){return this.value},n.prototype.isValueSet=function(){return this.isSet},n.prototype.isValueValid=function(){return this.isValid},n.prototype._validateValue=function(e){return"string"==typeof e&&this.validValueRegex.test(e)},n}.call(t,r,t,e))||(e.exports=i)},function(e,t,n){var i;void 0===(i=function(){"use strict";var t=n(0),i=n(21).Promise;function r(){}return r.get=function(){if(window&&window.bbcpage){return i.all(["getDestination","getProducer","getSection","getContentId","getContentType","getLanguage","getAdditionalProperties","getName"].map(function(e){return t=e,window.bbcpage[t]&&"function"==typeof window.bbcpage[t]?window.bbcpage[t]():i.resolve(null);var t})).then(function(e){return e=r._decodeFromOrbit(e),t.info("Got Orbit Variables: "+JSON.stringify(e)),{destination:e[0],producer:e[1],section:e[2],contentId:e[3],contentType:e[4],language:e[5],additionalProperties:e[6],pageName:e[7]}})}return i.resolve(void 0)},r.getUser=function(){if(window&&window.bbcuser){return i.all(["getHashedId","isSignedIn"].map(function(e){return t=e,window.bbcuser[t]&&"function"==typeof window.bbcuser[t]?window.bbcuser[t]():i.resolve(null);var t})).then(function(e){return t.info("Got Orbit User Variables: "+JSON.stringify(e)),{hashedId:e[0],isSignedIn:e[1]}})}return i.resolve(void 0)},r._decodeFromOrbit=function(e){for(var t=Object.keys(e),i=0;i<t.length;i++)if(e[t[i]]&&"object"!=typeof e[t[i]]){var n=new RegExp("&#x2F;","g");e[t[i]]=e[t[i]].replace(n,"/")}else e[t[i]]&&"object"==typeof e[t[i]]&&(e[t[i]]=r._decodeFromOrbit(e[t[i]]));return e},r}.call(t,n,t,e))||(e.exports=i)},function(e,t,i){(function(G,j){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.5+7f2b526d
 */
e.exports=function(){"use strict";function u(e){return"function"==typeof e}var i=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=0,t=void 0,r=void 0,s=function(e,t){p[n]=e,p[n+1]=t,2===(n+=2)&&(r?r(h):m())},e="undefined"!=typeof window?window:void 0,o=e||{},a=o.MutationObserver||o.WebKitMutationObserver,c="undefined"==typeof self&&void 0!==G&&"[object process]"==={}.toString.call(G),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(h,1)}}var p=new Array(1e3);function h(){for(var e=0;e<n;e+=2){var t=p[e],i=p[e+1];t(i),p[e]=void 0,p[e+1]=void 0}n=0}var _,f,E,g,m=void 0;function v(e,t){var i=this,n=new this.constructor(C);void 0===n[I]&&k(n);var r=i._state;if(r){var o=arguments[r-1];s(function(){return U(r,n,o,i._result)})}else M(i,n,e,t);return n}function T(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(C);return N(t,e),t}m=c?function(){return G.nextTick(h)}:a?(f=0,E=new a(h),g=document.createTextNode(""),E.observe(g,{characterData:!0}),function(){g.data=f=++f%2}):l?((_=new MessageChannel).port1.onmessage=h,function(){return _.port2.postMessage(0)}):void 0===e?function(){try{var e=Function("return this")().require("vertx");return void 0===(t=e.runOnLoop||e.runOnContext)?d():function(){t(h)}}catch(e){return d()}}():d();var I=Math.random().toString(36).substring(2);function C(){}var S=void 0,A=1,y=2,O={error:null};function b(e){try{return e.then}catch(e){return O.error=e,O}}function P(e,t,i,n){try{e.call(t,i,n)}catch(e){return e}}function R(e,t,i){var n,r,o,a;t.constructor===e.constructor&&i===v&&t.constructor.resolve===T?(o=e,(a=t)._state===A?B(o,a._result):a._state===y?D(o,a._result):M(a,void 0,function(e){return N(o,e)},function(e){return D(o,e)})):i===O?(D(e,O.error),O.error=null):void 0===i?B(e,t):u(i)?(n=t,r=i,s(function(t){var i=!1,e=P(r,n,function(e){i||(i=!0,n!==e?N(t,e):B(t,e))},function(e){i||(i=!0,D(t,e))},t._label);!i&&e&&(i=!0,D(t,e))},e)):B(e,t)}function N(e,t){var i,n;e===t?D(e,new TypeError("You cannot resolve a promise with itself")):(n=typeof(i=t),null===i||"object"!==n&&"function"!==n?B(e,t):R(e,t,b(t)))}function L(e){e._onerror&&e._onerror(e._result),w(e)}function B(e,t){e._state===S&&(e._result=t,e._state=A,0!==e._subscribers.length&&s(w,e))}function D(e,t){e._state===S&&(e._state=y,e._result=t,s(L,e))}function M(e,t,i,n){var r=e._subscribers,o=r.length;e._onerror=null,r[o]=t,r[o+A]=i,r[o+y]=n,0===o&&e._state&&s(w,e)}function w(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var n=void 0,r=void 0,o=e._result,a=0;a<t.length;a+=3)n=t[a],r=t[a+i],n?U(i,n,r,o):r(o);e._subscribers.length=0}}function U(e,t,i,n){var r=u(i),o=void 0,a=void 0,s=void 0,c=void 0;if(r){if((o=function(e,t){try{return e(t)}catch(e){return O.error=e,O}}(i,n))===O?(c=!0,a=o.error,o.error=null):s=!0,t===o)return void D(t,new TypeError("A promises callback cannot return that same promise."))}else o=n,s=!0;t._state!==S||(r&&s?N(t,o):c?D(t,a):e===A?B(t,o):e===y&&D(t,o))}var V=0;function k(e){e[I]=V++,e._state=void 0,e._result=void 0,e._subscribers=[]}var H=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(C),this.promise[I]||k(this.promise),i(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?B(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&B(this.promise,this._result))):D(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===S&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(t,e){var i=this._instanceConstructor,n=i.resolve;if(n===T){var r=b(t);if(r===v&&t._state!==S)this._settledAt(t._state,e,t._result);else if("function"!=typeof r)this._remaining--,this._result[e]=t;else if(i===x){var o=new i(C);R(o,t,r),this._willSettleAt(o,e)}else this._willSettleAt(new i(function(e){return e(t)}),e)}else this._willSettleAt(n(t),e)},e.prototype._settledAt=function(e,t,i){var n=this.promise;n._state===S&&(this._remaining--,e===y?D(n,i):this._result[t]=i),0===this._remaining&&B(n,this._result)},e.prototype._willSettleAt=function(e,t){var i=this;M(e,void 0,function(e){return i._settledAt(A,t,e)},function(e){return i._settledAt(y,t,e)})},e}(),x=function(){function t(e){this[I]=V++,this._result=this._state=void 0,this._subscribers=[],C!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(t,e){try{e(function(e){N(t,e)},function(e){D(t,e)})}catch(e){D(t,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var i=this.constructor;return u(t)?this.then(function(e){return i.resolve(t()).then(function(){return e})},function(e){return i.resolve(t()).then(function(){throw e})}):this.then(t,t)},t}();return x.prototype.then=v,x.all=function(e){return new H(this,e).promise},x.race=function(r){var o=this;return i(r)?new o(function(e,t){for(var i=r.length,n=0;n<i;n++)o.resolve(r[n]).then(e,t)}):new o(function(e,t){return t(new TypeError("You must pass an array to race."))})},x.resolve=T,x.reject=function(e){var t=new this(C);return D(t,e),t},x._setScheduler=function(e){r=e},x._setAsap=function(e){s=e},x._asap=s,x.polyfill=function(){var e=void 0;if(void 0!==j)e=j;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var i=null;try{i=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===i&&!t.cast)return}e.Promise=x},x.Promise=x}()}).call(this,i(32),i(33))},function(e,t){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var n=new Uint8Array(16);e.exports=function(){return i(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},function(e,t){for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,n=r;return[n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]]].join("")}},function(e,t,i){e.exports=i(25)},function(e,t,i){var n,r;n=[i(26)],void 0===(r=function(e){"use strict";return window&&window.bbccookies&&e.Environment.setOrbCookies(window.bbccookies),e}.apply(t,n))||(e.exports=r)},function(e,t,n){var i;void 0===(i=function(e){"use strict";var t=n(13),i=n(8);return{EchoClient:n(29),Media:n(18),MediaId:n(19),Environment:i,Enums:n(2),ConfigKeys:n(3),Debug:n(0),getImplementationVersion:function(){return t.VERSION}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,i){e.exports={STRICT:"strict",COUNTERNAME:"countername",EVENT_MASTER_BRAND:"event_master_brand",NO_CLEANSING:"no_cleansing",CUSTOM:"custom"}},function(e,t,i){var n;void 0===(n=function(){"use strict";return{httpGet:function(e,t,i){var n=new Image;n.onload=t,n.onerror=i,n.src=e},executeCrossDomainGet:function(e,i){var t,n,r;r=n=!1;var o=function(e,t){i.onError&&i.onError(e,t)};if(window.JSON&&window.JSON.parse&&void 0!==window.XMLHttpRequest&&"withCredentials"in(t=new XMLHttpRequest)&&(r=!0),r){try{t.open("GET",e,!0),t.onload=function(){(void 0===t.status||t.status<400)&&null!==t.responseText?function(){var e;if(i.onSuccess){try{e=window.JSON.parse(t.responseText)}catch(e){o("json")}"object"==typeof e&&setTimeout(function(){i.onSuccess(e)})}}():o(t.responseText,t.status)},t.onerror=function(e){o(e)},t.timeout=1e4,t.ontimeout=function(e){o(e)}}catch(e){a=e,n||o(a)}var a;try{t.send(null)}catch(e){n=!0,t.onload=t.onerror=t.onreadystatechange=null,t.abort(),o(e)}}else o()}}}.call(t,i,t,e))||(e.exports=n)},function(e,t,C){var i;void 0===(i=function(e){"use strict";var c=C(0),u=C(1),l=C(3),t=C(10),d=C(15),a=C(11),s=C(5),i=C(14),p=C(2),n=C(30),r=C(31),o=C(7),h=C(17),_=C(9),f="scorecardresearch.com",E="ckpf_echo_device_id",g="ckns_echo_device_id",m=C(20),v=C(21).Promise,T=36e5;function I(e,t,i,n,r){var o=this;i=i||{},u.assertContainsValue(p.ApplicationType,t,'appType should be one of Enums.ApplicationType, got "'+t+'"'),this.state={counterNameSet:!1};var a,s=I.ConfigGenerator.generate(i);if(this._env=null!=n?n:new I.Environment,setInterval(function(){o._remoteConfigManager=new d(i,o._env)},T),this._remoteConfigManager=new d(i,this._env),s&&(s[l.REMOTE_CONFIG_MANAGER]=this._remoteConfigManager),s&&"string"==typeof s[l.ECHO_DEVICE_ID]&&(0<(a=u.trim(s[l.ECHO_DEVICE_ID])).length?(s[l.ECHO_DEVICE_ID]=a,this._deviceId=a):s[l.ECHO_DEVICE_ID]=void 0),s&&s[l.COMSCORE_HOST]!==f&&!s[l.ECHO_DEVICE_ID]&&((a=_.getCookieValueByName(g))||(a=_.getCookieValueByName(E)),a&&(this._deviceId=a,s[l.ECHO_DEVICE_ID]=a)),s&&!1===s[l.ECHO_AUTO_START]?this._autoStart=!1:this._autoStart=!0,this._setConsumers(e,t,s,this._env),s&&s[l.USE_ESS]?this._essEnabled=!0:this._essEnabled=!1,s&&s[l.ESS_HOSTNAME]&&(h.essHost=s[l.ESS_HOSTNAME]),s&&!1===s[l.ECHO_ENABLED]?this._isEnabled=!1:this._isEnabled=!0,s)switch(s[l.DEBUG_MODE]){case!0:c.enable();break;case"error":c.enable(),c.setLevel(c.DebugLevels.ERROR);break;case"warn":c.enable(),c.setLevel(c.DebugLevels.WARN);break;case"info":c.enable(),c.setLevel(c.DebugLevels.INFO);break;default:c.disable()}this._liveBroker=null,this._onDemandBroker=null,this._suppressingPlayEvent=!1,this._suppressedPlayEventLabels=null,this.addLabel("bbc_id_wait","1"),m.getUser().then(function(e){var t;(this.removeLabel("bbc_id_wait"),e&&e.isSignedIn)&&(t=e.hashedId?encodeURIComponent(e.hashedId):"unidentified-user",this.addLabels({bbc_identity:"1",bbc_hid:t}))}.bind(this)),s&&s[l.ECHO_CACHE_MODE]&&(this._cacheMode=s[l.ECHO_CACHE_MODE]),this._atiDisableCookie=!!s&&!!s[l.ATI_DISABLE_COOKIE],this._isEnabled&&this._autoStart&&("function"==typeof r?this.start().then(r):this.start())}return I.prototype.getDebugMode=function(){return c.getState()},I.prototype.start=function(){var t;return this._isEnabled&&!this._hasStarted?(this._hasStarted=!0,m.get().then(function(e){t=e,this._delegate("start",[e])}.bind(this)).then(function(){t&&t.pageName&&""!==t.pageName&&"orb.page"!==t.pageName&&this.setCounterName(t.pageName)}.bind(this),function(e){c.error("failed to start delegates: "+e)})):v.reject()},I.prototype.enable=function(){return this._isEnabled||(this._isEnabled=!0,this._delegate("enable"),this._autoStart&&!this._hasStarted&&this.start()),this},I.prototype.disable=function(){return this._isEnabled&&(this._clearMedia(),this._isEnabled=!1,this._delegate("disable")),this},I.prototype.isEnabled=function(){return this._isEnabled},I.prototype.getComScoreDeviceId=function(){var e;return this.consumers[I.Consumers.COMSCORE]&&(e=this.consumers[I.Consumers.COMSCORE])instanceof I.ComScoreDelegate&&"function"==typeof e.getDeviceId?e.getDeviceId():null},I.prototype.getAtiDeviceId=function(){var e;return this.consumers[I.Consumers.ATI]&&(e=this.consumers[I.Consumers.ATI])instanceof I.AtiDelegate&&"function"==typeof e.getDeviceId?e.getDeviceId():null},I.prototype.getDeviceId=function(){return this._deviceId},I.prototype.setDeviceId=function(e){this._deviceId=e,this._delegate("setDeviceId",[e])},I.prototype.setTraceId=function(e){this._delegate("setTraceId",[e])},I.ConfigGenerator=C(34),I.LabelCleanser=C(4),I.Util=C(1),I.ComScoreDelegate=C(35),I.SpringDelegate=C(38),I.AtiDelegate=C(42),I.Environment=C(8),I.prototype._eventsEnabled=function(){return this._isEnabled&&this._hasStarted},I.prototype._setConsumers=function(e,t,i,n){this.consumers={};var r=I.LabelCleanser.cleanLabelValue("app_name",e);return i&&i[l.COMSCORE_ENABLED]&&(this.consumers[I.Consumers.COMSCORE]=new I.ComScoreDelegate(r,t,i,n)),i&&i[l.ATI_ENABLED]&&(this.consumers[I.Consumers.ATI]=new I.AtiDelegate(r,t,i,n)),i&&i[l.BARB_ENABLED]&&(this.consumers[I.Consumers.BARB]=new I.SpringDelegate(r,t,i,n)),this},I.prototype._shouldClearDeviceIdOnLogOut=function(){return this._atiDisableCookie},I.prototype._delegate=function(e,t,i){var n,r,o=[];for(n in this.consumers)n&&(r=this.consumers[n],i&&r.requiresLabelCleansing()?o.push(r[e].apply(r,i)):o.push(r[e].apply(r,t)));return v.all(o)},I.prototype.addLabels=function(e){return this.addProperties(e)},I.prototype.addLabel=function(e,t){return this.addProperty(e,t)},I.prototype.addProperties=function(e){return e=I.LabelCleanser.removeUndefined(e),this._delegate("addProperties",[I.LabelCleanser.cleanLabels(e)]),this},I.prototype.addCampaignProperties=function(e){return(e=I.LabelCleanser.removeUndefined(e)).hasOwnProperty("src_channel")&&e.hasOwnProperty("src_medium")&&e.hasOwnProperty("src_campaign")?this._delegate("addCampaignProperties",[e]):c.error("Campaign properties must contain channel, medium, and campaign"),this},I.prototype.addProperty=function(e,t){if("string"==typeof e){if(null!=t){var i={};return i[e]=t,this.addProperties(i)}c.error("Property cannot be null/undefined")}else c.error("Property key must be a string")},I.prototype.addManagedLabel=function(e,t){return this._delegate("addManagedLabel",[I.LabelCleanser.cleanLabelKey(e),I.LabelCleanser.cleanLabelValue(e,t)]),this},I.prototype.removeLabels=function(e){return this.removeProperties(e)},I.prototype.removeLabel=function(e){return this.removeProperty(e)},I.prototype.removeProperties=function(e){for(var t=[],i=0,n=e.length;i<n;i++)t.push(I.LabelCleanser.cleanLabelKey(e[i]));return this._delegate("removeProperties",[t]),this},I.prototype.removeProperty=function(e){return this.removeProperties([e])},I.prototype.setLoggedInToBBCId=function(e){return this._delegate("setLoggedInToBBCId",[e]),this},I.prototype.setLoggedOutOfBBCId=function(){return this._delegate("setLoggedOutOfBBCId"),this._shouldClearDeviceIdOnLogOut()&&(c.info("Clearing device id on logout"),this.setDeviceId(void 0)),this},I.prototype.setAppVersion=function(e){return this._delegate("setAppVersion",[e]),this},I.prototype.setDestination=function(e){return this._delegate("setDestination",[t.get(e)]),this},I.prototype.setProducer=function(e){return this._setProducer(e,!1)},I.prototype.setNationsProducer=function(e){var t=i.getName(e);void 0!==t?t&&t!==i.NONE?this.addProperty(p.EchoLabelKeys.NATIONS_PRODUCER,t):this.removeProperty(p.EchoLabelKeys.NATIONS_PRODUCER):c.info("Setting nations producer failed: nations producer "+e+" is not valid")},I.prototype.setProducerByMasterbrand=function(e){return this._setProducer(e,!0)},I.prototype._setProducer=function(e,t){var i,n,r;(n=this._remoteConfigManager.getProducers(),r=this._remoteConfigManager.getMasterbrands(),e&&"NULL"!==e.toUpperCase())?i=t?n&&r&&r[e]&&n[r[e]]?n[r[e]]:a.getProducerId(e):n&&n[e]?n[e]:s.getId(e):i="0";if(!i){var o=t?"Masterbrand":"Producer";c.warn(o+" ["+e+"] not recognised")}return i&&this._delegate("setProducer",[i]),this},I.prototype.setCounterName=function(e){var t=I.LabelCleanser.cleanCounterName(e),i=this._delegate("setCounterName",[e],[t]);return this.state.counterNameSet=!0,i},I.prototype.setContentLanguage=function(e){return this._delegate("setContentLanguage",[e]),this},I.prototype.setCacheMode=function(e){return this._delegate("setCacheMode",[e]),this._cacheMode=e,this},I.prototype.getCacheMode=function(){return this._cacheMode},I.prototype.clearCache=function(){this._isEnabled&&this._delegate("clearCache")},I.prototype.flushCache=function(){this._isEnabled&&this._delegate("flushCache")},I.prototype.viewEvent=function(e,t){if(this._eventsEnabled()){var i=I.LabelCleanser.cleanCounterName(e),n=I.LabelCleanser.cleanLabels(t);this.consumers[I.Consumers.COMSCORE]&&(this.state.comscoreEventSent=!0);var r=this._delegate("viewEvent",[e,t],[i,n]);return this.state.counterNameSet=!0,this.consumers[I.Consumers.COMSCORE]&&(this.state.comscoreEventSent=!0),r}},I.prototype.userActionEvent=function(e,t,i){if(this._eventsEnabled())return this.state.counterNameSet?(this._delegate("userActionEvent",[e,t,I.LabelCleanser.cleanLabels(i)]),this.consumers[I.Consumers.COMSCORE]&&(this.state.comscoreEventSent=!0)):c.error("userActionEvent not available before a call to viewEvent (to set counter name)."),this},I.prototype.errorEvent=function(e,t){if(this._eventsEnabled())return this._delegate("errorEvent",[e,I.LabelCleanser.cleanLabels(t)]),this},I.prototype.setPlayerName=function(e){u.assert("string"==typeof e&&0<e.length,'setPlayerName: name must be string with length, got "'+e+'"');var t=I.LabelCleanser.cleanLabelValue("player_name",e);return this._delegate("setPlayerName",[e],[t])},I.prototype.setPlayerVersion=function(e){u.assert("string"==typeof e&&0<e.length,'setPlayerVersion: version must be string with length, got "'+e+'"');var t=I.LabelCleanser.cleanLabelValue("player_version",e);return this._delegate("setPlayerVersion",[e],[t])},I.prototype.setPlayerIsPopped=function(e){return u.assert("boolean"==typeof e,'setPlayerIsPopped: isPopped must be boolean, got "'+e+'"'),this._delegate("setPlayerIsPopped",[e]),this},I.prototype.setPlayerWindowState=function(e){return u.assertContainsValue(p.WindowState,e,'The window state must be set as a member of Enums.WindowState, got "'+e+'"'),this._delegate("setPlayerWindowState",[e]),this},I.prototype.setPlayerVolume=function(e){return u.assert(e<=100&&0<=e,"volume must be 0-100, got: "+e),e<=100&&0<=e&&this._delegate("setPlayerVolume",[e]),this},I.prototype.setPlayerIsSubtitled=function(e){return u.assert("boolean"==typeof e,'setPlayerIsSubtitled: isSubtitled must be a boolean, got "'+e+'"'),this._delegate("setPlayerIsSubtitled",[e]),this},I.prototype.setPlayerDelegate=function(e){e=e||{};var t,i,n,r=["getTimestamp","getPosition"],o=!1;for(i=0;i<r.length;i++)t=r[i],n=e.hasOwnProperty(t)&&"function"==typeof e[t],u.assert(n,'The player delegate must implement "'+t+'"'),n||(o=!0);return o||(this._playerDelegate=e),this},I.prototype.setMedia=function(e){var t,i=this;if(this._eventsEnabled()){this._clearMedia();var n=e.getClone();if(this.state.counterNameSet){this.media=n,this.addLabel(o.ESS_ENABLED,this._essEnabled?"true":"false");var r=p.MediaConsumptionMode.LIVE;this.media.getMediaConsumptionMode()===r?this._initLiveBroker():this._initOnDemandBroker(),this.media.setRemoteProducers(this._remoteConfigManager.getProducers()),this.media.setRemoteMasterbrands(this._remoteConfigManager.getMasterbrands()),t||(t=setInterval(function(){i.media&&(i.media.setRemoteProducers(i._remoteConfigManager.getProducers()),i.media.setRemoteMasterbrands(i._remoteConfigManager.getMasterbrands()))},T)),this._delegate("setMedia",[this.media])}else c.error("setMedia: Must have a countername set or view event sent first")}},I.prototype.liveMediaUpdate=function(e,t,i){this._eventsEnabled()&&this._avEventsEnabled()&&e&&(this._suppressingPlayEvent=!1,this.media=e,this._delegate("liveMediaUpdate",[e,t,i]))},I.prototype.setMediaLength=function(e){return this.media?this.media.isOnDemand()?"number"!=typeof(e=this._cleanPosition(e))?c.error("setMediaLength: Length must be a positive number"):(this._delegate("setMediaLength",[e]),this.media.setLength(e)):c.error("setMediaLength: Length should be set to zero prior to passing the media object to Echo for live media"):c.error("setMediaLength: Must call setMedia first"),this},I.prototype.setMediaBitrate=function(){},I.prototype.setMediaCodec=function(){},I.prototype.setMediaCDN=function(){},I.prototype.setEssSuccess=function(e){this.addLabel(o.ESS_SUCCESS,e?"true":"false")},I.prototype.setEssError=function(e,t){this.addLabel(o.ESS_ERROR,e.toString().toLowerCase()),void 0!==e&&e.toString()===p.EssError.STATUS_CODE.toString()&&this.addLabel(o.ESS_STATUS_CODE,t),this._delegate("liveEnrichmentFailed")},I.prototype._avEventsEnabled=function(){return u.assert(Boolean(this.media),"setMedia() must be called prior to this method",!0)&&u.assert(Boolean(this._playerDelegate),"setPlayerDelegate not called or not configured correctly",!0)},I.prototype.getLiveBroker=function(){return this._liveBroker},I.prototype._initLiveBroker=function(){this._avEventsEnabled()&&this.media.getMediaConsumptionMode()===p.MediaConsumptionMode.LIVE&&(this._liveBroker=new n(this._playerDelegate,this.media,this,this._env,this._essEnabled),this._delegate("setBroker",[this._liveBroker]))},I.prototype.getOnDemandBroker=function(){return this._onDemandBroker},I.prototype._initOnDemandBroker=function(){this._avEventsEnabled()&&this.media.getMediaConsumptionMode()!==p.MediaConsumptionMode.LIVE&&(this._onDemandBroker=new r(this._playerDelegate,this.media,this),this._delegate("setBroker",[this._onDemandBroker]))},I.prototype._cleanPosition=function(e){return null!=e&&(e=Math.floor(e)),(void 0===e||isNaN(e)||!isFinite(e)||e<0)&&(e=0),e},I.prototype.avPlayEvent=function(e,t){if(this._eventsEnabled()&&this._avEventsEnabled()){var i=this.media.isLive();if(this._isPlaying=!0,i&&this._liveBroker)e=this._liveBroker.getPosition(),this._liveBroker.start();else if(!i&&this._onDemandBroker){if(e=this._cleanPosition(e),this._previousPlayPosition=e,this._positionExceedsMediaLength(e))return;this._onDemandBroker.setPosition(e),this._onDemandBroker.start()}return i&&this.media.isEssEnriched()&&this._suppressingPlayEvent?this._suppressedPlayEventLabels=t:(this._delegate("avPlayEvent",[e,I.LabelCleanser.cleanLabels(t)]),this.media.setBuffering(!1),this.media.setPlaying(!0)),this.consumers[I.Consumers.COMSCORE]&&(this.state.comscoreEventSent=!0),this}},I.prototype._avNavigationEvent=function(e,t,i,n){this._avEventsEnabled()&&(this._isPlaying=!1,this.media.isLive()?(this._liveBroker&&(this._liveBroker.stop(),t=this._liveBroker.getPosition()),this.media.isEssEnriched()&&!this._suppressingPlayEvent&&(this._suppressingPlayEvent=!0)):this._onDemandBroker&&(t=this._cleanPosition(t),t=this._preventPositionExceedingMediaLength(t),this._onDemandBroker.stop()),"avRewindEvent"===e||"avFastForwardEvent"===e?this._delegate(e,[t,n,I.LabelCleanser.cleanLabels(i)]):this._delegate(e,[t,I.LabelCleanser.cleanLabels(i)]))},I.prototype.avPauseEvent=function(e,t){if(this._eventsEnabled()&&this._avEventsEnabled())return this.media.setPlaying(!1),this._avNavigationEvent("avPauseEvent",e,t),this},I.prototype.avBufferEvent=function(e,t){if(this._eventsEnabled()&&this._avEventsEnabled()&&this.media.getPlaying())return this.media.setPlaying(!1),this._avNavigationEvent("avBufferEvent",e,t),this.media.setBuffering(!0),this},I.prototype.avEndEvent=function(e,t){if(this._eventsEnabled()&&this._avEventsEnabled())return this.media.setPlaying(!1),this._avNavigationEvent("avEndEvent",e,t),this.media=null,this},I.prototype.avRewindEvent=function(e,t,i){if(this._eventsEnabled()&&this._avEventsEnabled())return this._avNavigationEvent("avRewindEvent",e,i,t),this},I.prototype.avFastForwardEvent=function(e,t,i){if(this._eventsEnabled()&&this._avEventsEnabled())return this._avNavigationEvent("avFastForwardEvent",e,i,t),this},I.prototype.avSeekEvent=function(e,t){if(this._eventsEnabled()&&this._avEventsEnabled())return this._avNavigationEvent("avSeekEvent",e,t),this},I.prototype.avUserActionEvent=function(e,t,i,n){if(this._eventsEnabled()&&this._avEventsEnabled()){i=this._liveBroker?this._liveBroker.getPosition():(i=this._cleanPosition(i),this._preventPositionExceedingMediaLength(i));var r=I.LabelCleanser.cleanLabels(n);return this._delegate("avUserActionEvent",[e,t,i,r]),this}},I.prototype.releaseSuppressedPlay=function(){if(this._eventsEnabled()&&this._avEventsEnabled())return this._suppressingPlayEvent&&(this._suppressingPlayEvent=!1,this.avPlayEvent(this._liveBroker.getPosition(),this._suppressedPlayEventLabels)),this},I.prototype._clearMedia=function(){this.removeLabel(o.MEDIA_TIMESTAMP),this.removeLabel(o.ESS_ENABLED),this.removeLabel(o.ESS_ENRICHED),this.removeLabel(o.ESS_SUCCESS),this.removeLabel(o.ESS_ERROR),this.removeLabel(o.ESS_STATUS_CODE),null!==this.media&&(this.media=null),this._liveBroker instanceof n&&(this._liveBroker.stop(),this._liveBroker=null),this._onDemandBroker instanceof r&&(this._onDemandBroker.stop(),this._onDemandBroker=null),this._isPlaying=void 0,this._previousPlayPosition=void 0},I.prototype._positionExceedsMediaLength=function(e){return!!(this.media&&0<this.media.length&&e>=this.media.length-1e3)},I.prototype._preventPositionExceedingMediaLength=function(e){return this._positionExceedsMediaLength(e)?this.media.length:e},I.Consumers={COMSCORE:1,BARB:2,ATI:4},I}.call(t,C,t,e))||(e.exports=i)},function(e,t,i){var n,r;n=[i(16),i(7),i(17),i(18)],void 0===(r=function(o,c,a){"use strict";var s="no-broadcast";function e(e,t,i,n,r){this._playerDelegate=e,this._playhead=new o,this._isStarted=!1,this._interval=null,this._echoClient=i,this._broadcast=s,this._playerDelegateTimestamp=0,this._previousPosition=0,this._playingTime=0,this._media=t,this._environment=n,this._essEnabled=r,this._hb3NotSentYet=!0,this._hb5NotSentYet=!0,this._isRecievingPlayerTimestamp=!1,this._updateTime=0,this._essEnabled&&(this._schedule=new a(t,n,i))}return e.prototype.start=function(){var e=this;this._isStarted||(this._interval=setInterval(function(){e._update()},1e3),this._isStarted=!0,this._isRecievingPlayerTimestamp||this._playhead.start())},e.prototype.stop=function(){clearInterval(this._interval),this._playhead.stop(),this._isStarted=!1},e.prototype._update=function(){var e,t=parseInt(this._playerDelegate.getTimestamp(),10),i=!1,n=!1,r=!1,o=this.getTimestamp(),a=new Date,s=(a=a.getTime())-this._updateTime;this._updateTime=a,"number"==typeof t&&0<t&&(n=!0,this._isRecievingPlayerTimestamp=!0,this._playerDelegateTimestamp!==t&&(i=!0,this._echoClient.addLabel(c.MEDIA_TIMESTAMP,t)),e=t-o,n&&(0===this._playerDelegateTimestamp||e<0-s-1500||s+1500<e)&&(r=!0,this._playerDelegateTimestamp=t,this._playingTime+=this._playhead.getPosition(),this._restartPlayhead(),o=this.getTimestamp())),r||(0!==this._playerDelegateTimestamp&&!i||this._isRecievingPlayerTimestamp&&!n?this._playhead.stop():this._playhead.start()),this._updateSchedule(o)?(this._playingTime=0,this._playerDelegateTimestamp=t,this._restartPlayhead(),this._hb3NotSentYet=!0,this._hb5NotSentYet=!0):i&&this._echoClient.releaseSuppressedPlay(),this._updateHeartbeats(),this._previousPosition=this.getPosition()},e.prototype._updateSchedule=function(e){var t,i,n,r,o,a=!1;return this._essEnabled&&this._schedule.hasData()&&0<e&&(t=this._schedule.getBroadcast(e),(r=this._media.getClone()).setServiceId(this._schedule.serviceId),t||this._broadcast===s?!t||this._broadcast!==s&&t.version.id===this._broadcast.version.id||(n=(i=(this._broadcast=t).published_time).end-i.start,r.setEssEnriched(!0),r.setVersionId(t.version.id),r.setLength(n),t.masterbrand&&t.masterbrand.id&&(o=t.masterbrand.id),r.setProducerByMasterbrand(o),t.episode&&t.episode.id&&r.setEpisodeId(t.episode.id),this._updateMedia(r),a=!0):(this._broadcast=s,this._updateMedia(r),a=!0)),a},e.prototype._updateHeartbeats=function(){var e,t;this._broadcast!==s&&(this._hb3NotSentYet||this._hb5NotSentYet)&&(e=this._playingTime+this._playhead.getPosition(),t=this.getPosition(),3e3<=e&&this._hb3NotSentYet&&(this._echoClient.avUserActionEvent("echo_hb","echo_hb_3",t),this._hb3NotSentYet=!1),5e3<=e&&this._hb5NotSentYet&&(this._echoClient.avUserActionEvent("echo_hb","echo_hb_5",t),this._hb5NotSentYet=!1))},e.prototype._updateMedia=function(e){var t=this.getPosition();this._echoClient.liveMediaUpdate(e,t,this._previousPosition),this._previousPosition=t},e.prototype._restartPlayhead=function(){this._playhead.reset(),this._playhead.start()},e.prototype.getPosition=function(){return this._broadcast&&this._broadcast!==s?this._playerDelegateTimestamp-this._broadcast.published_time.start+this._playhead.getPosition():this._playhead.getPosition()},e.prototype.getTimestamp=function(){return this._playerDelegateTimestamp+this._playhead.getPosition()},e}.apply(t,n))||(e.exports=r)},function(e,t,i){var n,r;n=[i(16)],void 0===(r=function(n){"use strict";function e(e,t,i){this._playerDelegate=e,this._media=t,this._echoClient=i,this._playhead=new n,this._isStarted=!1,this._interval=null,this._playerDelegatePosition=0,this._playingTime=0,this._currentIntervalMaxPosition=0,this._hb3NotSentYet=!0,this._hb5NotSentYet=!0,this._previousPlayingTime=0}return e.prototype.setPlayhead=function(e){this._playhead=e},e.prototype.start=function(){var e=this;this._isStarted||(this._interval=setInterval(function(){e._update()},1e3),this._isStarted=!0,this._playhead.start())},e.prototype.stop=function(){clearInterval(this._interval),this._playhead.stop(),this._isStarted=!1},e.prototype.setPosition=function(e){"number"==typeof e&&0<=e&&!this.arePositionsWithinTolerance(this.getPosition(),e)&&(this._playerDelegatePosition=e,this._playingTime+=this._playhead.getPosition(),this._restartPlayhead(),this._currentIntervalMaxPosition=e)},e.prototype.getCurrentIntervalMaxPosition=function(){return this._currentIntervalMaxPosition},e.prototype._update=function(){var e=parseInt(this._playerDelegate.getPosition(),10),t=this.getPosition(),i=this._playingTime+this._playhead.getPosition(),n=Math.abs(i-(this._previousPlayingTime||i));this._previousPlayingTime=i,"number"==typeof e&&e!==this._playerDelegatePosition&&0<e&&(0!==this._playerDelegatePosition&&this.arePositionsWithinTolerance(e,t)||(this._playerDelegatePosition=e,t=this._playerDelegatePosition,this._restartPlayhead())),t>this._currentIntervalMaxPosition&&(this._currentIntervalMaxPosition=t),3e3<=i&&this._hb3NotSentYet&&n<1500&&(this._echoClient.avUserActionEvent("echo_hb","echo_hb_3",t),this._hb3NotSentYet=!1),5e3<=i&&this._hb5NotSentYet&&n<1500&&(this._echoClient.avUserActionEvent("echo_hb","echo_hb_5",t),this._hb5NotSentYet=!1),0<this._media.length&&t>=this._media.length&&this._echoClient.avPauseEvent(this._media.length,{echo_pause_at_media_length:1})},e.prototype._restartPlayhead=function(){this._playhead.reset(),this._playhead.start()},e.prototype.getPosition=function(){var e=this._playhead.getPosition();return this._playerDelegatePosition+e},e.prototype.getTimestamp=function(){return 0},e.prototype.arePositionsWithinTolerance=function(e,t){var i=e-t;return-1500<=i&&i<=1500},e}.apply(t,n))||(e.exports=r)},function(e,t){var i,n,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(e){i=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c,u=[],l=!1,d=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&h())}function h(){if(!l){var e=s(p);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];u.push(new _(e,t)),1!==u.length||l||s(h)},_.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,n){var i;void 0===(i=function(e){"use strict";var o=n(0),i=n(2),a=n(1),t=n(13),s=n(3),c={};c[s.ECHO_ENABLED]=!0,c[s.ECHO_AUTO_START]=!0,c[s.ECHO_DEVICE_ID]=null,c[s.REPORTING_PROFILE]="PUBLIC_SERVICE",c[s.ECHO_CACHE_MODE]="NEVER",c[s.COMSCORE_ENABLED]=!1,c[s.ATI_ENABLED]=!0,c[s.BARB_ENABLED]=!1,c[s.BARB_DEBUG]=!1,c[s.BARB_SITE_CODE]="bbcdotcom",c[s.TEST_SERVICE_ENABLED]=!1,c[s.USE_ESS]=!1,c[s.ESS_HOSTNAME]="ess.api.bbci.co.uk",c[s.USE_SSC]=!1,c[s.SSC_HOSTNAME]=null;var u={};function l(e){return"string"==typeof e&&0<e.length}function d(e){return"string"==typeof(t=e[s.ECHO_CACHE_MODE])&&(t=t.toUpperCase(),i.EchoCacheMode.hasOwnProperty(t))?a.assert("boolean"==typeof e[s.ECHO_ENABLED],'Config: "enabled" must be boolean, got '+e[s.ECHO_ENABLED])&&a.assert("boolean"==typeof e[s.ECHO_AUTO_START],'Config: "auto_start" must be boolean, got '+e[s.ECHO_AUTO_START])&&a.assert(null===e[s.ECHO_DEVICE_ID]||"string"==typeof e[s.ECHO_DEVICE_ID]&&e[s.ECHO_DEVICE_ID].length,"ECHO.DEVICE_ID must be an non-empty string"):(o.error("Config Error: KEYS.ECHO_CACHE_MODE Invalid cache mode specified"),!1);var t}function p(e){if(!1===e[s.COMSCORE_ENABLED])return!0;if(!l(e[s.REPORTING_PROFILE])){if(!l(e[s.COMSCORE_HOST]))return o.error("Config Error: Must have config value for COMSCORE_HOST or REPORTING_PROFILE"),!1;if("scorecardresearch.com"!==e[s.COMSCORE_HOST]&&"sa.bbc.co.uk"!==e[s.COMSCORE_HOST])return o.error("Config Error: KEYS.COMSCORE_HOST Should be one of scorecardresearch.com or sa.bbc.co.uk"),!1}return"string"==typeof(t=e[s.REPORTING_PROFILE])&&(t=t.toUpperCase(),i.ReportingProfiles.hasOwnProperty(t))?a.assert("boolean"==typeof e[s.COMSCORE_ENABLED],'ComScore config: "ENABLED" must be boolean'):(o.error("Config Error: KEYS.REPORTING_PROFILE Invalid reporting profile specified"),!1);var t}function h(e){return"string"==typeof e&&(e=e.toUpperCase(),i.ReportingProfiles.hasOwnProperty(e))?i.ReportingProfiles[e]:null}function _(e){return"string"==typeof e&&(e=e.toUpperCase(),i.EchoCacheMode.hasOwnProperty(e))?i.EchoCacheMode[e]:null}return u[s.ECHO_NAME]=t.NAME,u[s.ECHO_VERSION]=t.VERSION,{defaultConfig:c,fixedConfig:u,generate:function(e){var t,i;(e=e||{})[s.REPORTING_PROFILE]&&(t=h(e[s.REPORTING_PROFILE])),t||(t=h("PUBLIC_SERVICE")),e[s.ECHO_CACHE_MODE]&&(i=_(e[s.ECHO_CACHE_MODE])),i||(i=_("NEVER"));var n,r=a.extend(c,!0,t,e||{},u);return d(r)&&p(r)&&(!1===(n=r)[s.BARB_ENABLED]||(l(n[s.BARB_SITE_CODE])?n[s.BARB_SITE_CODE].match(/[a-zA-Z]+/)?"boolean"==typeof n[s.BARB_DEBUG]||(o.error("Config Error: KEYS.BARB_DEBUG must be a boolean"),0):(o.error("Config Error: KEYS.BARB_SITE_CODE must match [a-zA-Z]"),0):(o.error("Config Error: KEYS.BARB_SITE_CODE must have a value"),0)))?r:null}}}.call(t,n,t,e))||(e.exports=i)},function(e,t,i){var n;void 0===(n=function(e){"use strict";var h=i(7),_=i(3),f=i(8),E=i(1),r=i(36),g=i(2),m="invalid-data",v=i(0),T=i(9),o="sa.bbc.co.uk/bbc",I="scorecardresearch.com",C=[g.ApplicationType.WEB,g.ApplicationType.MOBILE_WEB,g.ApplicationType.RESPONSIVE];function t(){return-1}function S(e,t,i){return e===I?(n=t)+"//"+("https:"===n?"s":"")+"b."+I+"/p?":t+"//"+o+"/"+i+"/s";var n}function A(e,t,i,n){var r,o,a,s,c,u,l,d,p=i[_.COMSCORE_SITE];this._deviceId=null,this._broker=null,this.media=null,this._clips=[],this._isEnabled=!0,this._hasStartedAppTag=!1,this._hasCreatedAsset=!1,this._storedAssetLabels={},c=i[_.COMSCORE_HOST],p=i[_.COMSCORE_SITE],!0===i[_.USE_SSC]&&v.warn("Setting USE_SSC is now deprecated and will have no effect"),this._deviceId=i[_.ECHO_DEVICE_ID]||void 0,E.containsValue(g.ApplicationType,t)||(t=m),r=S(c,n.getProtocol(),p),!0===i[_.TEST_SERVICE_ENABLED]&&(a=r,r=i[_.TEST_SERVICE_URL]+"/comscore",this._isUsingComscoreOTTLibrary&&(o=i[_.TEST_SERVICE_URL]+"/offline")),this._isApp=!E.containsValue(C,t),u=n.getHttpGet(),s=c===I,this._isUsingComscoreOTTLibrary=!(!A.AppTag||!A.AppTag.ns_),this._isUsingComscoreOTTLibrary?(this.appTag=A.AppTag.ns_.comScore,this.appTag.setPlatformAPI(A.AppTag.ns_.PlatformAPIs.html5),u&&(this.appTag.getPlatformAPI().httpGet=u),this.appTag.setPublisherSecret(i[_.COMSCORE_PUBLISHER_SECRET]),this.appTag.setAppContext()):this.appTag=new A.AppTag(u||f._defaultHttpGet,this._isApp,s),s&&(this.appTag.setCustomerC2(i[_.COMSCORE_CUSTOMER_ID]),this.addLabel(h.COMSCORE_C1,"2"),this.addLabel(h.COMSCORE_SITE,p)),this.appTag.setPixelURL(r),this._deviceId?this.addLabel(h.DEVICE_ID,this._deviceId):"sa.bbc.co.uk"===c&&(this._deviceId=T.getCookieValueByName("s1")),!0===i[_.TEST_SERVICE_ENABLED]&&(this.addLabel(h.COMSCORE_ENDPOINT,a),this._isUsingComscoreOTTLibrary&&this.appTag.setOfflineURL(o)),this.addLabel(h.BBC_APPLICATION_NAME,e),this.addLabel(h.BBC_APPLICATION_TYPE,t),this.setCacheMode(i[_.ECHO_CACHE_MODE]),this.addLabel(h.BBC_MEASUREMENT_LIB_NAME,i[_.ECHO_NAME]),this.addLabel(h.BBC_MEASUREMENT_LIB_VERSION,i[_.ECHO_VERSION]),this._isApp?(this._isUsingComscoreOTTLibrary?this.appTag.setAppName(e):this.addLabel(h.APP_NAME,e),this.addLabel(h.APP_PLATFORM_NAME,n.getPlatformName()),this.addLabel(h.APP_PLATFORM_RUNTIME,n.getPlatformRuntimeEnvironment()),this.addLabel(h.APP_OS_VERSION,n.getPlatformOSVersion()),this.addLabel(h.APP_DEVICE_NAME,n.getDeviceName()),this.addLabel(h.APP_SCREEN_RESOLUTION,n.getScreenResolution()),this.addLabel(h.APP_LANGUAGE,n.getLanguage())):this.addLabel(h.WEB_SCREEN_RES,n.getScreenResolution()),this.addLabel(h.ENV_CHAR_SET,n.getCharSet()),this.addLabel(h.ENV_TITLE,n.getTitle()),this.addLabel(h.ENV_REFERRER,n.getReferrer()),-1===n.getURL().indexOf("file:",0)&&this.addLabel(h.ENV_URL,n.getURL()),i[_.ECHO_TRACE]&&this.setTraceId(i[_.ECHO_TRACE]),(l=f.getOrbCookiesPolicy())&&(d="ad"+(l.ads?"1":"0")+"ps"+(l.personalisation?"1":"0")+"pf"+(l.performance?"1":"0"),this.addLabel(h.COOKIE_POLICY,d)),this.addLabel(g.ManagedLabels.BBC_SITE,m),this._mediaIsLive=null,i&&!1===i[_.ECHO_ENABLED]?this._isEnabled=!1:this._isEnabled=!0}return A.prototype.start=function(){this._isEnabled&&!this._hasStartedAppTag&&(this.appTag.start(),this._hasStartedAppTag=!0)},A.prototype.enable=function(){this._isEnabled||(this._isEnabled=!0)},A.prototype.disable=function(){this._isEnabled&&(this.clearMedia(),this._isEnabled=!1)},A.prototype.getDeviceId=function(){return this._deviceId},A.prototype._buildStreamSenseClip=function(e){},A.prototype.setTraceId=function(e){this.addLabel(_.ECHO_TRACE,e)},A.AppTag=i(37),A.prototype.addLabels=function(e){this.addProperties(e)},A.prototype.addProperties=function(e){if("object"==typeof e)for(var t in e)e.hasOwnProperty(t)&&this.addProperty(t,e[t])},A.prototype.addCampaignProperties=t,A.prototype.addLabel=function(e,t){this.addProperty(e,t)},A.prototype.addProperty=function(e,t){this.appTag.setLabel(e,t)},A.prototype.addManagedLabel=function(e,t){var i=r.isValidManagedLabel(e,t)?t:m;for(var n in g.ManagedLabels)g.ManagedLabels[n]===e&&this.addLabel(e,i)},A.prototype.removeLabels=function(e){this.removeProperties(e)},A.prototype.removeProperties=function(e){for(var t=0,i=e.length;t<i;t++)this.removeProperty(e[t])},A.prototype.removeLabel=function(e){this.removeProperty(e)},A.prototype.removeProperty=function(e){this.appTag.setLabel(e,null)},A.prototype.setLoggedInToBBCId=function(e){this.addLabel(h.BBC_ID_LOGGED_IN,"1"),e&&0<e.length?this.addManagedLabel(g.ManagedLabels.BBC_HASHED_ID,e):this.removeLabel(g.ManagedLabels.BBC_HASHED_ID)},A.prototype.setLoggedOutOfBBCId=function(){this.removeLabels([h.BBC_ID_LOGGED_IN,g.ManagedLabels.BBC_HASHED_ID])},A.prototype.setAppVersion=function(e){"function"==typeof this.appTag.setAppVersion?this.appTag.setAppVersion(e):e&&this._isApp?this.addLabel(h.APP_VERSION,e.toString()):e&&this.addLabel(h.BBC_APPLICATION_VERSION,e.toString())},A.prototype.setCounterName=function(e){this._isEnabled&&this.addLabel(h.BBC_COUNTER_NAME,e)},A.prototype.setDestination=function(e){this.addLabel(h.DESTINATION,e)},A.prototype.setProducer=function(e){this.addLabel(h.PRODUCER,e)},A.prototype.setContentLanguage=function(e){this.addLabel(h.BBC_LANGUAGE,e)},A.prototype.setCacheMode=function(e){if(this._isUsingComscoreOTTLibrary&&e!==this._cacheMode){switch(e){case g.EchoCacheMode.ALL:this.appTag.allowLiveTransmission(this.appTag.TransmissionMode.NEVER),this.appTag.allowOfflineTransmission(this.appTag.TransmissionMode.NEVER);break;case g.EchoCacheMode.OFFLINE:this.appTag.allowLiveTransmission(this.appTag.TransmissionMode.DEFAULT),this.appTag.allowOfflineTransmission(this.appTag.TransmissionMode.DEFAULT)}this._cacheMode=e}},A.prototype.flushCache=function(){this._isUsingComscoreOTTLibrary&&this.appTag.flushCache()},A.prototype.clearCache=t,A.prototype.viewEvent=function(e,t){if(this._eventsEnabled()){this.addLabel(h.BBC_COUNTER_NAME,e);var i=E.extend(t,!0,h.ECHO_EVENT_NAME,"view");i.name=e,this.appTag.view(i)}},A.prototype.errorEvent=t,A.prototype.userActionEvent=function(e,t,i){if(this._eventsEnabled()){var n=E.extend(i,!0,h.USER_ACTION_TYPE,e,h.USER_ACTION_NAME,t,h.ECHO_EVENT_NAME,"userAct");this.appTag.hidden(n)}},A.prototype.setPlayerName=function(e){},A.prototype.setPlayerVersion=function(e){},A.prototype.setPlayerIsPopped=function(e){},A.prototype.setPlayerWindowState=function(e){},A.prototype.setPlayerVolume=function(e){},A.prototype.setPlayerIsSubtitled=function(e){},A.prototype.setBroker=function(e){return this._broker=e,this},A.prototype.setMedia=function(e){},A.prototype.liveMediaUpdate=function(e,t,i){},A.prototype.liveEnrichmentFailed=t,A.prototype.setMediaLength=function(e){},A.prototype.avPlayEvent=function(e,t){},A.prototype.avPauseEvent=function(e,t){},A.prototype.avBufferEvent=function(e,t){},A.prototype.avEndEvent=function(e,t){},A.prototype.avRewindEvent=function(e,t,i){},A.prototype.avFastForwardEvent=function(e,t,i){},A.prototype.avSeekEvent=function(e,t){},A.prototype.avUserActionEvent=function(e,t,i,n){},A.prototype.clearMedia=function(){},A.prototype.setDeviceId=t,A.prototype.requiresLabelCleansing=function(){return!0},A.prototype._eventsEnabled=function(){return this._isEnabled&&this._hasStartedAppTag},A}.call(t,i,t,e))||(e.exports=n)},function(e,t,r){var i;void 0===(i=function(e){"use strict";var i=r(2),n=r(1);return{isValidManagedLabel:function(e,t){switch(e){case i.ManagedLabels.IPLAYER_STATE:if("purchased"!==t&&"free"!==t)return!1;break;case i.ManagedLabels.STORE_ED_TYPE:if("archive"!==t&&"standard"!==t)return!1;break;case i.ManagedLabels.IPLAYER_AVAIL:if("avail"!==t&&"unavail"!==t&&"soon"!==t)return!1;break;case i.ManagedLabels.STORE_REFERRAL:if("iplayer"!==t&&"store"!==t)return!1;break;case i.ManagedLabels.BBC_HASHED_ID:if("string"!=typeof t||0===n.trim(t).length)return!1}return!0}}}.call(t,r,t,e))||(e.exports=i)},function(e,t,i){var n,r;n=[i(7)],void 0===(r=function(r){"use strict";function o(e,t,i){this._persistantLabels={},this._urlParams="",this._cut="",this._httpGet=e,this._eventCount=0,this._isApp=t,this._isScorecardDomain=!0===i,this._hasStarted=!1}return o.IS_ECHO_APP_TAG=!0,o.URL_LIMIT=2048,o.prototype.setPixelURL=function(e){this._url=this._makeBaseUrl(e)},o.prototype.setCustomerC2=function(e){this.setLabel(r.COMSCORE_CUSTOMER,e)},o.prototype.start=function(){this._hasStarted||(this._hasStarted=!0)},o.prototype.setLabel=function(e,t){null===t?this.removeLabel(e):this._persistantLabels[e]=t},o.prototype.removeLabels=function(e){for(var t in e)void 0!==this._persistantLabels[e[t]]&&delete this._persistantLabels[e[t]]},o.prototype.removeLabel=function(e){void 0!==this._persistantLabels[e]&&delete this._persistantLabels[e]},o.prototype.view=function(e){this.send("view",e)},o.prototype.hidden=function(e){this.send("hidden",e)},o.prototype.send=function(e,t,i){var n,r,o=this._persistantLabels,a={};if(this._hasStarted){for(r in this._eventCount++,o)a[r]=o[r];for(r in t)a[r]=t[r];a.ns_type=e,this._isApp&&(a.ns_ap_ev=e,a.ns_ap_ec=this._eventCount),a[this._isApp?"ns_ts":"ns__t"]=+new Date,n=this._createUrl(a),this._httpGet(n,i)}},o.prototype._createUrl=function(e){var t,i=window.encodeURIComponent||escape,n=this._url;for(t in this._urlParams="",this._cut="",e.hasOwnProperty("name")&&this._addUrlParam("name",e.name),e)"name"!==t&&"ns_referrer"!==t&&this._addUrlParam(t,e[t]);return e.hasOwnProperty("ns_referrer")&&this._addUrlParam(this._isScorecardDomain?r.ENV_REFERRER:"ns_referrer",e.ns_referrer),n+=this._urlParams,this._cut.length?n+="ns_cut="+i(this._cut.replace(/&$/,"")):n=n.replace(/&$/,""),n},o.prototype._addUrlParam=function(e,t){var i=window.encodeURIComponent||escape,n=i(e)+"="+i(t)+"&",r=o.URL_LIMIT-8;this._url.length+this._urlParams.length+n.length<r?this._urlParams+=n:this._cut+=n},o.prototype._makeBaseUrl=function(e){for(var t=-1,i=e.charAt(e.length-1),n=0,r=e.length;n<r;n++)"?"===e.charAt(n)&&(t=n);return-1===t?e+="?":"?"!==i&&"&"!==i&&(e+="&"),e},o}.apply(t,n))||(e.exports=r)},function(e,t,c){var i;void 0===(i=function(e){"use strict";var n=c(39),r=c(3),t=c(0),i=c(2),o=c(40);function a(){return-1}function s(e,t,i,n){this._sensors=null,this._broker=null,this._media=null,this._meta={},this._stream=null,this._env=n,this._siteCode=i[r.BARB_SITE_CODE],this._debug=i[r.BARB_DEBUG],this._traceId=null,this._isPlaying=!1,this._isEssEnabled=!1,this._isEnabled=!0,this._hasStarted=!1,i[r.ECHO_TRACE]&&this.setTraceId(i[r.ECHO_TRACE]),i[r.USE_ESS]&&(this._isEssEnabled=!0),i&&!1===i[r.ECHO_ENABLED]?this._isEnabled=!1:this._isEnabled=!0}return s.prototype.start=function(){this._hasStarted||(this._hasStarted=!0)},s.prototype.enable=function(){this._isEnabled||(this._isEnabled=!0)},s.prototype.disable=function(){this._isEnabled&&(this._isEnabled=!1,this.clearMedia())},s.prototype.setTraceId=function(e){this._traceId=e},s.SpringStreams=c(41),s.prototype.addLabels=a,s.prototype.addLabel=a,s.prototype.addProperties=a,s.prototype.addCampaignProperties=a,s.prototype.addProperty=a,s.prototype.addManagedLabel=a,s.prototype.removeLabels=a,s.prototype.removeLabel=a,s.prototype.removeProperties=a,s.prototype.removeProperty=a,s.prototype.setLoggedInToBBCId=a,s.prototype.setLoggedOutOfBBCId=a,s.prototype.setAppVersion=a,s.prototype.setCounterName=a,s.prototype.setContentLanguage=a,s.prototype.setCacheMode=a,s.prototype.clearCache=a,s.prototype.flushCache=a,s.prototype.setESSEnabled=a,s.prototype.viewEvent=a,s.prototype.errorEvent=a,s.prototype.userActionEvent=a,s.prototype.setPlayerName=function(e){this._meta[n.PLAYER_DESC]=e},s.prototype.setPlayerVersion=function(e){this._meta[n.PLAYER_VERSION]=e},s.prototype.setPlayerIsPopped=a,s.prototype.setPlayerWindowState=a,s.prototype.setPlayerVolume=a,s.prototype.setPlayerIsSubtitled=a,s.prototype.setDestination=a,s.prototype.setProducer=a,s.prototype.setBroker=function(e){return this._broker=e,this},s.prototype.setMedia=function(e){this._eventsEnabled()&&(this.clearMedia(),this._media=e.getClone())},s.prototype.setMediaLength=function(e){this._media.setLength(e)},s.prototype.liveMediaUpdate=function(e){this._media=e.getClone(),this._isPlaying&&this._startTracking()},s.prototype.liveEnrichmentFailed=function(){this._media.getServiceId()||this._media.setServiceId("no-service-id-found"),this._isPlaying&&this._startTracking()},s.prototype.avPlayEvent=function(e,t){this._eventsEnabled()&&this.isValidMedia()&&this._broker&&(this._initSensors(),this._isPlaying=!0,this._media.isLive()&&!this._media.getServiceId()?this._isEssEnabled&&(this._media.getVersionId()||this._media.getVpId())||(this._media.setServiceId("invalid-data"),this._startTracking()):this._startTracking())},s.prototype._initSensors=function(){if(null===this._sensors){if(this._sensors=new s.SpringStreams(this._siteCode),null!==this._env.getSetLocalStorageItem()&&null!==this._env.getGetLocalStorageItem()&&null!==this._env.getHttpGet()){t.info("Using custom PageContext for BARB");var e=new o("com.kma.springstreams",this._env);this._sensors.setPageContext(e)}this._debug&&(this._sensors.debug=function(e){t.info("Spring DEBUG: "+e)})}},s.prototype._startTracking=function(){if(null===this._stream){var e=this._getAttributes(),t=e[n.PID]||" ";this._stream=this._sensors.track(t,e,this._getAdaptor())}},s.prototype._getMostPrecedentIdObject=function(){var e=this._media.getVersionIdObject(),t=this._media.getEpisodeIdObject(),i=this._media.getClipIdObject(),n=this._media.getVpIdObject(),r=this._media.getServiceIdObject();return e.isValueValid()?e:t.isValueValid()?t:i.isValueValid()?i:n.isValueValid()?n:r.isValueValid()?r:null},s.prototype._getAttributes=function(){var e=this._media,t={};if(this._traceId&&(t[r.ECHO_TRACE]=this._traceId),!e.isLive()){var i=this._getMostPrecedentIdObject();null!==i&&(t[n.PID]=i.getValue())}return e.isOnDemand()?t[n.STREAM]="od":e.isDownload()?t[n.STREAM]="dwn":e.isLive()&&e.getServiceIdObject().isValueValid()&&(t[n.STREAM]="live/"+e.getServiceId()),t},s.prototype._getAdaptor=function(){var t,i=this;return t=this._media.isLive()?function(){return i._broker.getTimestamp()}:function(){return i._broker.getPosition()},{getMeta:function(e){return i._meta},getDuration:function(e){var t=0;return i._media.isLive()||(t=Math.floor(i._media.getLength()/1e3)),t},getPosition:function(e){return Math.floor(t()/1e3)}}},s.prototype._eventsEnabled=function(){return this._isEnabled&&this._hasStarted},s.prototype.avPauseEvent=function(){},s.prototype.avBufferEvent=function(){},s.prototype.avEndEvent=function(){this._eventsEnabled()&&(this._isPlaying=!1,this.isValidMedia()&&this.clearMedia())},s.prototype.avRewindEvent=function(){},s.prototype.avFastForwardEvent=function(){},s.prototype.avSeekEvent=function(){},s.prototype.avUserActionEvent=a,s.prototype.clearMedia=function(){this.isValidMedia()&&(this._stream&&this._stream.stop(),this._stream=null,this._media=null)},s.prototype.isValidMedia=function(){return null!==this._media&&this._media.avType===i.AvType.VIDEO},s.prototype.isValidLiveMedia=function(){return this.isValidMedia()&&this._media.isLive()},s.prototype.setDeviceId=a,s.prototype.requiresLabelCleansing=function(){return!0},s}.call(t,c,t,e))||(e.exports=i)},function(e,t,i){e.exports={STREAM:"stream",PID:"cq",WIDTH:"sx",HEIGHT:"sy",PLAYER_DESC:"pl",PLAYER_VERSION:"plv"}},function(e,t,i){var n;void 0===(n=function(){"use strict";function e(e,t){this.namespace=e,this.env=t}return e.prototype.preloadImage=function(e){return this.env.getHttpGet()(e)},e.prototype.getLocalStorageItem=function(e){return this.env.getGetLocalStorageItem()(e)},e.prototype.setLocalStorageItem=function(e,t){return this.env.getSetLocalStorageItem()(e,t)},e.prototype.getWindowLocationURL=function(){return this.env.getURL()},e}.call(t,i,t,e))||(e.exports=n)},function(e,t,i){var n;void 0===(n=function(){function e(e){this.namespace="com.kantarmedia.sensors.javascript",this.version="2.5.9";var r="2cnt.net",o="barb",t=200,i=2e3,n="default",a=new Array;this.namespace="com.kma.springstreams",this.updateTimer=!1,this.syncTimer=!1,this.syncrate=20,this.pausesync=6,this.maxstates=50;var s,c=!(this.workerRunning=!1);this.nextuid="";var u,l={"+":"%2B",",":"%2C",";":"%3B","=":"%3D","~":"%7E","*":"%2A","'":"%27","!":"%21","(":"%28",")":"%29"},y=this,d=!0;!function(e){var t;if(e){for(var i in e)i===r&&"barb"===o&&(t=e[i]);t&&(n=t.syncrates)&&(u=n)}var n}({"2cnt.net":{syncrates:[3,7,10,10,10,10,10,60]}}),e&&(n=e);var p=!1;if((0<window.navigator.userAgent.indexOf("MSIE ")||navigator.userAgent.match(/Trident.*rv\:11\./))&&(p=!0),window.URL&&window.Blob&&window.Worker&&!p||(d=!1),d)var h=new Blob(['onmessage = function (evt) {if(evt.data == "start"){postMessage("open");if(!self.updateTimer)self.updateTimer = setInterval(()=>{postMessage("update")},200);if(!self.syncTimer)self.syncTimer = setInterval(()=>postMessage("sync"),2000);}if(evt.data == "stop"){clearInterval(self.updateTimer);clearInterval(self.syncTimer);postMessage("close");self.close();}};'],{type:"text/javascript"}),_=URL.createObjectURL(h);function f(){s=new Worker(_),y.workerRunning=!0,s.onmessage=function(e){"open"==e.data&&(y.updateTimer=y.syncTimer=!0),"sync"==e.data&&v(),"update"==e.data&&m(),"close"==e.data&&(y.workerRunning=!1)},s.onerror=function(e){y.workerRunning=!1,s.postMessage("stop"),console.error(e.message),E()}}if(d)try{f()}catch(e){y.workerRunning=!1,d=!1}function E(){y.updateTimer||(y.updateTimer=setInterval(m,t)),y.syncTimer||(y.syncTimer=setInterval(v,i))}function g(){this.nextuid="",clearInterval(y.updateTimer),clearInterval(y.syncTimer),y.updateTimer=!1,y.syncTimer=!1,this.workerRunning=!1,d&&s.postMessage("stop");for(var e=0;e<a.length;++e)try{a[e].stop()}catch(e){O(e)}}function m(e){for(var t=0;t<a.length;++t)try{a[t].update(e)}catch(e){O(e)}}function v(e){for(var t=0;t<a.length;++t)try{a[t].sync()}catch(e){O(e)}}function O(e){A("",e)}function T(e,t){return function e(t){var i;var n;var r;var o;var a=/[+&,;=~!*'()]/g;var s;switch(typeof t){case"string":return a.test(t)?encodeURIComponent(t).replace(a,function(e){var t=l[e];return t||e}):encodeURIComponent(t);case"number":return isFinite(t)?t.toString():"null";case"boolean":case"null":return t.toString();case"object":if(!t)return"null";if(i=[],"number"==typeof t.length&&!t.propertyIsEnumerable("length")){for(o=t.length,n=0;n<o;n+=1)i.push(e(t[n])||"null");return","+i.join("+")+";"}for(r in t)"string"==typeof r&&"site"!==r&&(s=e(t[r]))&&i.push(e(r)+"="+s);return","+i.join("+")+";"}return""}([[e,t]])}function I(e){return e&&void 0!==e.site?e.site:n}function C(){return void 0===y.pageContext.getWindowLocationURL()?"http://":"https"===y.pageContext.getWindowLocationURL().slice(0,5)?"https://":"http://"}function S(){if(!y.nlso)try{var e,t="i00";if(void 0!==y.pageContext.getUniqueId&&(t=r),e=y.pageContext.getLocalStorageItem(t))return"&c="+e;var i="0000"+Math.ceil((new Date).getTime()/1e3).toString(16)+(32768|65535*Math.random()).toString(16)+"0000";y.pageContext.setLocalStorageItem(t,i)}catch(e){y.warn("error"+e)}return""}function A(e,t){var i;(void 0!==y.pageContext.tracking&&(c=y.pageContext.tracking),c)&&(void 0===t.stream||""==t.stream?y.warn("Stream is mandatory for measurement"):(i=""===r?C()+I(t)+"/j0="+T(e,t)+"?lt="+(new Date).getTime().toString(36)+S():C()+I(t)+"."+r+"/j0="+T(e,t)+"?lt="+(new Date).getTime().toString(36)+S(),y.pageContext.preloadImage(i),y.debug(i)))}function b(e,t,i,n){var r,o="";o=e.getNextUID(),e.nextuid=null,""==o&&(r=Math.round(1e10*Math.random()).toString(36),o=(new Date).getTime().toString(36)+r);var a,s,c,u,l,d,p,h,_=Math.round((new Date).getTime()/1e3),f=[0,0,_.toString(36)],E=0,g=0,m=!0,v=!1,T=0;function I(e){var t;f=[e,e,Math.round((new Date).getTime()/1e3).toString(36)],t=f,c.length<a.maxstates&&c.push(t),m=!0,E=0}function C(){null!=p&&h<p.length&&(d=p[h++],a.debug("switch syncrate to "+d))}function S(){void 0!==y.pageContext.getSerialNumber?y.pageContext.getSerialNumber(A):A()}function A(){if(m){try{s.width&&(u.sx=s.width),s.videoWidth&&(u.sx=s.videoWidth),s.height&&(u.sy=s.height),s.videoHeight&&(u.sy=s.videoHeight)}catch(e){}var e;u.uid=o,u.pst=c;try{u.dur&&0!==u.dur||(u.dur=l.getDuration(s))}catch(e){}try{e=l.getMeta(s),void 0!==y.pageContext.getDeviceID&&void 0!==y.pageContext.getDeviceID()&&(e[y.pageContext.getDeviceID().id_name]=y.pageContext.getDeviceID().id_value)}catch(e){}void 0===e.v&&(e.v="js "+y.version),u.vt=Math.round((new Date).getTime()/1e3)-_,void 0!==y.pageContext.getUniqueId&&(e.psid=y.pageContext.getUniqueId()),void 0!==y.pageContext&&void 0!==y.pageContext.addElectronParameters&&(y.pageContext.addElectronParameters(e),e.v="E "+y.version),void 0!==y.pageContext&&void 0!==y.pageContext.isCasting&&y.pageContext.isCasting(),void 0!==y.pageContext&&void 0!==y.pageContext.getChromecastID&&(e.v="C "+y.version,e.cid=y.pageContext.getChromecastID()),a.send(e,u),g=f[1]}m=!1}a=e,s=t,l=n||a.HTML5Adapter,u=function(e){var t=new Object;for(var i in e)t[i]=e[i];return t}(i),(c=new Array).push(f),h=0,d=e.syncrate,p=e.getSyncRates(),C(),this.update=function(e){if(!v){var t,i=f[1],n=i;try{n=Math.round(l.getPosition(s))}catch(e){}try{if(i===n)return void(0<=E&&++E===a.pausesync&&(m=!0));E>=a.pausesync?I(n):i<n-1||n<i?(t=n,setTimeout(function(){t==Math.round(l.getPosition(s))||t+1==Math.round(l.getPosition(s))?5<=++T&&(T=0,(1<t-f[1]||1<f[1]-t)&&I(t)):T=0},200)):(f[1]=n,f[1]-f[0]>=d&&d<=n-g&&(m=!0,C()),E=0)}catch(e){O=!0,a.error(e)}}},this.stop=function(){v||(v=m=!0,S())},this.sync=S}function P(e,t){localStorage.setItem(e,t)}function R(e){return localStorage.getItem(e)}this.getSyncRates=function(){return u},this.track=function(e,t,i){d?(y.workerRunning||f(),s.postMessage("start")):E();var n=i;if(void 0===y.pageContext&&(window.cordova?"browser"===device.platform?(y.debug("Detected cordova browser-mode falling back to HTML5 context / adapter"),y.pageContext=y.defaultPageContext,n=this.HTML5Adapter):(y.nlso=!0,y.debug("Detected cordova context"),y.pageContext=y.cordovaPageContext):y.pageContext=y.defaultPageContext),void 0!==y.pageContext.generateId&&y.pageContext.generateId(),e){void 0!==y.pageContext&&void 0!==y.pageContext.initHooks&&y.pageContext.initHooks();var r=new b(this,e,t,n);return a.push(r),r}},this.trackWithUID=function(e,t,i,n){return n!=this.nextuid?void 0:this.track(e,t,i)},this.getNextUID=function(){var e;return""!=this.nextuid&&null!=this.nextuid||(this.nextuid=(e=Math.round(1e10*Math.random()).toString(36),(new Date).getTime().toString(36)+e)),this.nextuid},this.unload=g,this.doUpdate=m,this.doSync=v,this.error=O,this.debug=function(e){console.debug(e)},this.warn=function(e){console.warn(e)},this.send=A,this.defaultPageContext={getLocalStorageItem:R,setLocalStorageItem:P,preloadImage:function(e){(new Image).src=e},getWindowLocationURL:function(){return document.location.href},initHooks:function(){}},this.cordovaPageContext={getLocalStorageItem:R,setLocalStorageItem:P,preloadImage:function(e){var t="Cordova <"+device.platform+" "+device.version+">";cordova.plugin.http.setHeader("User-Agent",t),cordova.plugin.http.sendRequest(e,{method:"get"},function(e){y.debug("Request respopnse: "+e.status)},function(e){y.warn("Request respopnse: "+e.status+":"+e.error)})},getWindowLocationURL:function(){return"https://"},initHooks:function(){if(null==y.cordovaSetCloseHook){y.cordovaSetCloseHook,document.addEventListener("pause",function(){g()},!1)}}},this.HTML5Adapter={getMeta:function(e){return{pl:"HTML 5 Video",plv:"HTML 5",sx:screen.width,sy:screen.height}},getPosition:function(e){return e.currentTime},getDuration:function(e){return Math.round(e.duration)}},this.DefaultAdapter={getMeta:function(e){return{pl:"DEF",plv:version,sx:screen.width,sy:screen.height}},getPosition:function(e){return(new Date).getTime()/1e3},getDuration:function(e){return 0}},this.WMStreamAdapter={getMeta:function(e){return{pl:"MSWM",plv:e.versionInfo,sx:screen.width,sy:screen.height}},getPosition:function(e){if(e.CurrentPosition)return e.CurrentPosition;if(e.currentPosition)return e.currentPosition;if(e.controls&&e.controls.currentPosition)return e.controls.currentPosition;if(e.Controls&&e.Controls.currentPosition)return e.Controls.currentPosition;return 0},getDuration:function(e){if(e.currentMedia){if(e.currentMedia.Duration)return e.currentMedia.Duration;if(e.currentMedia.duration)return e.currentMedia.duration}else if(e.CurrentMedia){if(e.CurrentMedia.duration)return e.CurrentMedia.duration;if(e.CurrentMedia.Duration)return e.CurrentMedia.Duration}}},this.RVStreamAdapter={getMeta:function(e){return{pl:"RV",plv:e.GetVersionInfo(),sx:screen.width,sy:screen.height}},getPosition:function(e){return e.GetPosition()/1e3},getDuration:function(e){return e.GetLength()/1e3}},this.HTML5CordovaAdapter={getMeta:function(e){var t="CDV "+y.version;void 0===y.cordovaAppName&&(y.cordovaAppName="",cordova.getAppVersion.getAppName().then(function(e){y.cordovaAppName=e}));void 0===y.cordovaAppVersion&&(y.cordovaAppVersion="",cordova.getAppVersion.getVersionNumber().then(function(e){y.cordovaAppVersion=e}));return"Android"==device.platform?(y.cordovaGID=N(device.uuid).substring(0,16),void 0===y.cordovaAID&&(y.cordovaAID="",void 0!==cordova.plugins.idfa&&cordova.plugins.idfa.getInfo().then(function(e){y.cordovaAID=N(e.aaid).substring(0,16),y.cordovaLimitAdTracking=e.limitAdTracking})),{pl:"HTML 5 Video",plv:"HTML 5",v:t,sx:screen.width,sy:screen.height,aid:y.cordovaAID,gid:y.cordovaGID,os:device.platform,osv:device.version,av:y.cordovaAppVersion,an:y.cordovaAppName,app:y.cordovaAppName}):"iOS"==device.platform?(y.cordovaIFV=N(device.uuid).substring(0,16),{pl:"HTML 5 Video",plv:"HTML 5",v:t,sx:screen.width,sy:screen.height,ifv:y.cordovaIFV,os:device.platform,osv:device.version,av:y.cordovaAppVersion,an:y.cordovaAppName,app:y.cordovaAppName}):{pl:"HTML 5 Video",plv:"HTML 5",v:t,sx:screen.width,sy:screen.height,os:device.platform,osv:device.version,an:y.cordovaAppName,av:y.cordovaAppVersion}},getPosition:function(e){return e.currentTime},getDuration:function(e){return Math.round(e.duration)}}}function N(e){var t,i,n,r,o,a,s,c,u,l,d,p=function(e,t){return e<<t|e>>>32-t},h=function(e,t){var i,n,r,o,a;return r=2147483648&e,o=2147483648&t,a=(1073741823&e)+(1073741823&t),(i=1073741824&e)&(n=1073741824&t)?2147483648^a^r^o:i|n?1073741824&a?3221225472^a^r^o:1073741824^a^r^o:a^r^o},_=function(e,t,i,n,r,o,a){var s;return e=h(e,h(h((s=t)&i|~s&n,r),a)),h(p(e,o),t)},f=function(e,t,i,n,r,o,a){var s;return e=h(e,h(h(t&(s=n)|i&~s,r),a)),h(p(e,o),t)},E=function(e,t,i,n,r,o,a){return e=h(e,h(h(t^i^n,r),a)),h(p(e,o),t)},g=function(e,t,i,n,r,o,a){return e=h(e,h(h(i^(t|~n),r),a)),h(p(e,o),t)},m=function(e){var t,i="",n="";for(t=0;t<=3;t++)i+=(n="0"+(e>>>8*t&255).toString(16)).substr(n.length-2,2);return i};for(c=1732584193,u=4023233417,l=2562383102,d=271733878,t=(i=function(e){for(var t,i=e.length,n=i+8,r=16*((n-n%64)/64+1),o=new Array(r-1),a=0,s=0;s<i;)a=s%4*8,o[t=(s-s%4)/4]=o[t]|e.charCodeAt(s)<<a,s++;return a=s%4*8,o[t=(s-s%4)/4]=o[t]|128<<a,o[r-2]=i<<3,o[r-1]=i>>>29,o}(e=function(e){var t,i,n,r="";t=i=0,n=(e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length;for(var o=0;o<n;o++){var a=e.charCodeAt(o),s=null;a<128?i++:s=127<a&&a<2048?String.fromCharCode(a>>6|192)+String.fromCharCode(63&a|128):String.fromCharCode(a>>12|224)+String.fromCharCode(a>>6&63|128)+String.fromCharCode(63&a|128),null!=s&&(t<i&&(r+=e.substring(t,i)),r+=s,t=i=o+1)}return t<i&&(r+=e.substring(t,e.length)),r}(e))).length,n=0;n<t;n+=16)u=g(u=g(u=g(u=g(u=E(u=E(u=E(u=E(u=f(u=f(u=f(u=f(u=_(u=_(u=_(u=_(o=u,l=_(a=l,d=_(s=d,c=_(r=c,u,l,d,i[n+0],7,3614090360),u,l,i[n+1],12,3905402710),c,u,i[n+2],17,606105819),d,c,i[n+3],22,3250441966),l=_(l,d=_(d,c=_(c,u,l,d,i[n+4],7,4118548399),u,l,i[n+5],12,1200080426),c,u,i[n+6],17,2821735955),d,c,i[n+7],22,4249261313),l=_(l,d=_(d,c=_(c,u,l,d,i[n+8],7,1770035416),u,l,i[n+9],12,2336552879),c,u,i[n+10],17,4294925233),d,c,i[n+11],22,2304563134),l=_(l,d=_(d,c=_(c,u,l,d,i[n+12],7,1804603682),u,l,i[n+13],12,4254626195),c,u,i[n+14],17,2792965006),d,c,i[n+15],22,1236535329),l=f(l,d=f(d,c=f(c,u,l,d,i[n+1],5,4129170786),u,l,i[n+6],9,3225465664),c,u,i[n+11],14,643717713),d,c,i[n+0],20,3921069994),l=f(l,d=f(d,c=f(c,u,l,d,i[n+5],5,3593408605),u,l,i[n+10],9,38016083),c,u,i[n+15],14,3634488961),d,c,i[n+4],20,3889429448),l=f(l,d=f(d,c=f(c,u,l,d,i[n+9],5,568446438),u,l,i[n+14],9,3275163606),c,u,i[n+3],14,4107603335),d,c,i[n+8],20,1163531501),l=f(l,d=f(d,c=f(c,u,l,d,i[n+13],5,2850285829),u,l,i[n+2],9,4243563512),c,u,i[n+7],14,1735328473),d,c,i[n+12],20,2368359562),l=E(l,d=E(d,c=E(c,u,l,d,i[n+5],4,4294588738),u,l,i[n+8],11,2272392833),c,u,i[n+11],16,1839030562),d,c,i[n+14],23,4259657740),l=E(l,d=E(d,c=E(c,u,l,d,i[n+1],4,2763975236),u,l,i[n+4],11,1272893353),c,u,i[n+7],16,4139469664),d,c,i[n+10],23,3200236656),l=E(l,d=E(d,c=E(c,u,l,d,i[n+13],4,681279174),u,l,i[n+0],11,3936430074),c,u,i[n+3],16,3572445317),d,c,i[n+6],23,76029189),l=E(l,d=E(d,c=E(c,u,l,d,i[n+9],4,3654602809),u,l,i[n+12],11,3873151461),c,u,i[n+15],16,530742520),d,c,i[n+2],23,3299628645),l=g(l,d=g(d,c=g(c,u,l,d,i[n+0],6,4096336452),u,l,i[n+7],10,1126891415),c,u,i[n+14],15,2878612391),d,c,i[n+5],21,4237533241),l=g(l,d=g(d,c=g(c,u,l,d,i[n+12],6,1700485571),u,l,i[n+3],10,2399980690),c,u,i[n+10],15,4293915773),d,c,i[n+1],21,2240044497),l=g(l,d=g(d,c=g(c,u,l,d,i[n+8],6,1873313359),u,l,i[n+15],10,4264355552),c,u,i[n+6],15,2734768916),d,c,i[n+13],21,1309151649),l=g(l,d=g(d,c=g(c,u,l,d,i[n+4],6,4149444226),u,l,i[n+11],10,3174756917),c,u,i[n+2],15,718787259),d,c,i[n+9],21,3951481745),c=h(c,r),u=h(u,o),l=h(l,a),d=h(d,s);return(m(c)+m(u)+m(l)+m(d)).toLowerCase()}return e.prototype.setPageContext=function(e){this.pageContext=e},e}.call(t,i,t,e))||(e.exports=n)},function(e,t,k){var i;void 0===(i=function(e){"use strict";var t=k(43),a=k(44),i=k(20),h=k(6),s=k(3),o=k(47),_=k(48),n=k(50),r=k(51),u=k(52),c=k(10),l=k(5),d=k(15),f=k(1),p=k(12),E=k(0),g=k(4),m=k(2),v=k(8),T=k(9),I="info",C="move",S="pause",A="play",y="stop",O="clip",b="live",P="ati-host.net",R="logw363.ati-host.net",N="logws1363.ati-host.net",L="api.bbc.co.uk",B="a1.api.bbc.co.uk",D="a1.api.bbc.co.uk",M="content_type",w="user_id";function U(){return-1}function V(e,t,i,n){this._tag=null,this._broker=null,this._media=null,this._mediaLength=null,this._commonMediaParams=null,this._env=n,this._pageValues={},this._customParams={},this._appName=e,this._appType=t,this._config=i,this._bbc_hid=null,this._lastHitUrl=null,this._lastPlayHitUrl=null,this._lastPage=null,this._counterName=null,this._orbitVars=null,this._trace=null;var r=this;if(setInterval(function(){r._remoteConfigManager=new d(i,r._env)},36e5),this._remoteConfigManager=this._config[s.REMOTE_CONFIG_MANAGER]||new d(i,this._env),this._deviceId=i[s.ECHO_DEVICE_ID]||void 0,!0!==i[s.ATI_DISABLE_COOKIE]||this._deviceId||(this._deviceId=a.v4()),this._deviceId||(this._deviceId=T.getCookieValueByName("idrxvr")),!this._deviceId){var o=T.getCookieValueByName("atuserid");o&&(this._deviceId=JSON.parse(decodeURIComponent(o)).val)}i[s.ECHO_TRACE]&&(this._trace=i[s.ECHO_TRACE]),this._isEnabled=i&&i[s.ECHO_ENABLED],i&&i[s.KEEPALIVE_DURATION]?this._keepAliveDuration=Number(i[s.KEEPALIVE_DURATION]):this._keepAliveDuration=3e5}return V.SmartTag=t,V.prototype._getHttpGetMethod=function(){return this._env.getHttpGet()||v._defaultHttpGet},V.prototype._setHTTPGetMethod=function(o){var a=this._getHttpGetMethod(),s=this,e=function(e,r){var t=function(t,i,n){return function(e){s._tag.emit(t,{lvl:n,details:{hit:i,event:e}}),r&&"function"==typeof r&&r(),o&&"function"==typeof o&&o()}},i=t("Tracker:Hit:Sent:Ok",e=s._addLengthToMediaHit(e),"INFO"),n=t("Tracker:Hit:Sent:Error",e,"ERROR");a(e,i,n)};"never"===this._tag.getConfig("Offline").storageMode?this._tag.builder.sendUrl=e:this._tag.sendUrl=e},V.prototype._getDestination=function(e,t){var i;return e&&(i=c.get(e[s.DESTINATION])),!i&&t&&(i=c.get(t.destination)),i||(E.warn("Destination not found, using default site"),i=c.DEFAULT),i},V.prototype._getProducer=function(e,t,i){var n,r;(r=this._remoteConfigManager.getProducers(),this._pageValues[h.LEVEL_2_SITE]&&(n=this._pageValues[h.LEVEL_2_SITE]),!n&&e)&&(n=!(!r||!r[e[s.PRODUCER]])?r[e[s.PRODUCER]]:l.getId(e[s.PRODUCER]));return!n&&t&&(n=r&&r[t.producer]?r[t.producer]:l.getId(t.producer)),!n&&i&&(E.warn("Producer not found, using default producer"),n=i.defaultProducer),n},V.prototype.setDestination=function(e){e||(e=c.DEFAULT,E.warn("Destination not found, using default site instead")),e&&(this.setProducer(e.defaultProducer),this._setDomain(e.isTest),this._tag.setConfig(h.LEVEL_1_SITE,e.id))},V.prototype.setProducer=function(e){this.addLabel(h.LEVEL_2_SITE,e)},V.prototype._getCookieDomain=function(e){var t;return t=e&&e.location&&e.location.hostname&&e.location.hostname.match(/.bbc.com$/)?"bbc.com":e&&e.location&&e.location.hostname.match(/.britbox.com$/)?"britbox.com":(e&&e.location&&!e.location.hostname.match(/.bbc.co.uk$/)&&E.info("Cookie hostname is: "+e.location.hostname+" failing back to bbc.co.uk"),"bbc.co.uk"),!0===this._config[s.TEST_SERVICE_ENABLED]&&this.addProperty(h.TEST_COOKIE_DOMAIN,t),t},V.prototype._setDomain=function(e){e?(this._tag.setConfig("domain",P),this._tag.setConfig("collectDomain",R),this._tag.setConfig("collectDomainSSL",N)):(this._tag.setConfig("domain",L),this._tag.setConfig("collectDomain",B),this._tag.setConfig("collectDomainSSL",D)),this._config&&(this._config[s.ATI_COLLECT_DOMAIN]&&this._tag.setConfig("collectDomain",this._config[s.ATI_COLLECT_DOMAIN]),this._config[s.ATI_COLLECT_DOMAIN_SSL]&&this._tag.setConfig("collectDomainSSL",this._config[s.ATI_COLLECT_DOMAIN_SSL]))},V.prototype._setSection=function(e,t,i){t&&(e&&e[h.SECTION]?(t[h.CHAPTER_1]=g.cleanCustomVariable(e[h.SECTION]),t.customObject&&delete t.customObject[h.SECTION]):i&&i.section&&(t[h.CHAPTER_1]=g.cleanCustomVariable(i.section)),E.info("Setting page view chapters: "+t[h.CHAPTER_1]))},V.prototype._createAtiOptions=function(e,t){var i;if(e)switch(i={collectDomain:t.isTest?R:B,collectDomainSSL:t.isTest?N:D,disableCookie:!0===e[s.ATI_DISABLE_COOKIE],cookieDomain:!0===e[s.ATI_USE_DEFAULT_COOKIE_DOMAIN]?null:this._getCookieDomain(window),domain:t.isTest?P:L,pixelPath:e[s.ATI_PIXEL_PATH]||"/hit.xiti",secure:!1!==e[s.ATI_FORCE_HTTPS],forceHttp:!0===e[s.ATI_FORCE_HTTP],site:t.id},!0===e[s.ATI_FORCE_HTTPS]&&E.warn("Forcing https for ATI is now deprecated and has no effect, https is the default protocol now"),e[s.ATI_LOG]&&(E.warn("Setting ATI_LOG for ATI is now deprecated, please use ATI_COLLECT_DOMAIN"),i.collectDomain=e[s.ATI_LOG]+"."+i.collectDomain),e[s.ATI_SSL_LOG]&&(E.info("Setting ATI_SSL_LOG for ATI is now deprecated, please use ATI_COLLECT_DOMAIN_SSL"),i.collectDomainSSL=e[s.ATI_SSL_LOG]+"."+i.collectDomainSSL),e[s.ATI_COLLECT_DOMAIN]&&(i.collectDomain=e[s.ATI_COLLECT_DOMAIN]),!0===e[s.ATI_FORCE_HTTP]?i.collectDomainSSL=i.collectDomain:e[s.ATI_COLLECT_DOMAIN_SSL]&&(i.collectDomainSSL=e[s.ATI_COLLECT_DOMAIN_SSL]),e[s.ECHO_DEVICE_ID]&&(i.ClientSideUserId={clientSideMode:"required",userIdCookieDuration:397,userIdExpirationMode:"fixed"}),e[s.ECHO_CACHE_MODE]){case m.EchoCacheMode.ALL:i.Offline={storageMode:s.ATI_CACHE_MODE_ALWAYS};break;case m.EchoCacheMode.OFFLINE:i.Offline={storageMode:s.ATI_CACHE_MODE_REQUIRED};break;default:i.Offline={storageMode:s.ATI_CACHE_MODE_NEVER}}return i},V.prototype._createTag=function(e){return new V.SmartTag.Tracker.Tag(e)},V.prototype._initTag=function(e){if(!this._tag){var t=this._config,i=this._getDestination(t,e),n=this._createAtiOptions(t,i);for(var r in this._tag=this._createTag(n),this._tag.onTrigger("Tracker:Hit:Sent:Ok",this._onHitSent.bind(this)),this._debug&&(this._tag.debug=function(e){E.info("ATI DEBUG: "+e)}),this._deviceId&&this._setSmartTagDeviceId(this._tag,this._deviceId),this._bbc_hid&&(this._tag.setParam(h.HASHED_ID,this._bbc_hid,{hitType:["all"],permanent:!0}),this._tag.setProp(w,this._bbc_hid,!0)),t&&t[s.APP_CATEGORY]&&this.addLabel(h.APP_CATEGORY,t[s.APP_CATEGORY]),this._setHTTPGetMethod(),this._counterName&&this.setCounterName(this._counterName),this._trace&&this.setTraceId(this._trace),this._customParams)this._tag.setParam(r,g.cleanCustomVariable(this._customParams[r]),{hitType:["all"],permanent:!0});var o={};o[h.APP_NAME]=this._appName,o[h.APP_TYPE]=this._appType,o[h.LIBRARY_VERSION]=p.getLibraryName()+"-"+p.getLibraryVersion(),o=f.combineObjects(o,this._customParams,!1),o=f.combineObjects(o,e,!1),this.setGlobalProps(o),E.info("Initialised ATI SmartTag with options:"+JSON.stringify(n))}},V.prototype._setSmartTagDeviceId=function(e,t){e.clientSideUserId.set(t)},V.prototype.start=function(e){this._orbitVars=e,this._isEnabled&&!this._hasStarted&&(this._hasStarted=!0,this._initTag(e))},V.prototype.enable=function(){this._isEnabled||(this._isEnabled=!0)},V.prototype.disable=function(){this._isEnabled&&(this._isEnabled=!1,this.clearMedia())},V.prototype._onHitSent=function(e,t){t&&t.details&&t.details.hit&&(E.info("Did send hit: ",t.details.hit),this._setLastHitUrl(t.details.hit))},V.prototype._addLengthToMediaHit=function(e){if(e&&"string"==typeof e&&e.match(/a\=(play|pause|stop|info|refresh|move)/)&&this._mediaLength){var t="m1="+Math.ceil(this._mediaLength/1e3);e=e.replace(/m1\=\d+/g,t)}return e},V.prototype._setLastHitUrl=function(e){e&&"string"==typeof e&&e.match(/a\=play/)?this._lastPlayHitUrl=e:this._lastHitUrl=e},V.prototype.setTraceId=function(e){e&&this._tag&&this._tag.setParam(s.ECHO_TRACE,e,{hitType:["all"],permanent:!0})},V.prototype.addLabels=function(e){this.addProperties(e)},V.prototype.addLabel=function(e,t){this.addProperty(e,t)},V.prototype.addProperties=function(e){if("object"==typeof e)for(var t in e.bbc_identity&&(this.setBBCUser({bbc_hid:e.bbc_hid,signed_in:"1"===e.bbc_identity}),delete e.bbc_hid,delete e.bbc_identity),e)e.hasOwnProperty(t)&&this.addProperty(t,e[t])},V.prototype.addProperty=function(e,t){if(e===h.BBC_COUNTER_NAME||e===h.LEVEL_2_SITE?this._pageValues[e]=t:this._customParams[e]=t,this._tag){var i={};i[e]=t,this.setGlobalProps(i)}},V.prototype.addCampaignProperties=function(e){this._tag?e&&"object"==typeof e&&this._tag.setProps(e,!0):E.error("Cannot set campaign properties: please enable ATI and start Echo before setting campaign properties.")},V.prototype.setLoggedInToBBCId=function(e){this.setBBCUser({bbc_hid:e,signed_in:!0}),E.info("Setting BBC user with hashed ID: "+e)},V.prototype.setLoggedOutOfBBCId=function(){this._tag&&(this._tag.delParam(h.HASHED_ID),this._tag.delProp(w)),this._bbc_hid=null,E.info("Removing User ID")},V.prototype.setAppVersion=function(e){e&&this._tag&&this._tag.setParam(h.APP_VERSION,"["+e+"]",{hitType:["all"],permanent:!0})},V.prototype.setBBCUser=function(e){e.bbc_hid?this._bbc_hid=e.bbc_hid:e.signed_in&&(this._bbc_hid="unidentified-user"),this._tag&&!this._customParams.bbc_id_wait&&(this._tag.setParam(h.HASHED_ID,this._bbc_hid,{hitType:["all"],permanent:!0}),this._tag.setProp(w,this._bbc_hid,!0)),E.info("Setting BBC user with hashed ID: "+this._bbc_hid)},V.prototype.addManagedLabel=U,V.prototype.removeLabels=function(e){this.removeProperties(e)},V.prototype.removeLabel=function(e){this.removeProperty(e)},V.prototype.removeProperties=function(e){for(var t=0,i=e.length;t<i;t++)this.removeProperty(e[t])},V.prototype.removeProperty=function(e){e===h.BBC_COUNTER_NAME||e===h.LEVEL_2_SITE?delete this._pageValues[e]:(this._tag&&this._tag.delParam(e),delete this._customParams[e])},V.prototype.setCounterName=function(e){var t=this._getDestination(this._config,this._orbitVars),i=this._getProducer(this._config,this._orbitVars,t);this.setProducer(i);var n={name:this._counterName=e,level2:this._pageValues[h.LEVEL_2_SITE]};this._tag&&(this._tag.page.set(n),this._lastPage=n)},V.prototype.setContentLanguage=U,V.prototype.setCacheMode=U,V.prototype.clearCache=function(){this._tag.offline.remove(),E.info("Clearing cache: this will not send cached events")},V.prototype.flushCache=function(){this._tag.offline.send(),E.info("Flushing cache: this will send cached events")},V.prototype.setESSEnabled=U,V.prototype.viewEvent=function(d,p){if(this._eventsEnabled())return this._tag.page.reset(),this.addLabel(h.BBC_COUNTER_NAME,d),this._counterName=d,i.get().then(function(e){var t=this._getDestination(this._config,e),i=this._getProducer(this._config,e,t);this.setProducer(i);var n=f.clone(this._customParams),r=_.create(this._appName,this._appType,n,p,e,document),o=f.extend(p,!0,h.ECHO_EVENT_NAME,"view"),a=f.combineObjects(n,o,!1),s={};for(var c in a)if("trace"!==c)f.startsWith(c,"ess_")?s[c]=a[c]:this._tag&&this._tag.setParam(c,g.cleanCustomVariable(a[c]),{hitType:["all"],permanent:!1});else{var u=a[c];this.setTraceId(u)}s.echo_event="view";var l=f.clone(this._pageValues);l.customObject=s,r&&this._tag.customVars.set(r),this._setSection(o,l,e),this._tag.page.set(l),this._tag.dispatch(),this._lastPage=l,E.info("Sending page view event with countername: "+d)}.bind(this))},V.prototype.errorEvent=U,V.prototype.setGlobalProps=function(e){var t={};for(var i in t[h.APP_NAME]="app_name",t[h.APP_TYPE]="app_type",t[h.CONTENT_TYPE]=M,t.contentType=M,t[h.LIBRARY_VERSION]="library_version",e){var n=t[i];n&&this._tag.setProp(n,e[i],!0)}},V.prototype.userActionEvent=function(e,t,i){if(this._eventsEnabled()){var n=f.extend(i,!0,h.ECHO_EVENT_NAME,"userAct"),r=f.combineObjects(this._customParams,n,!1),o=f.clone(this._pageValues);if(o){o.actionName=t,o.actionType=e,o.user=this._bbc_hid,o[h.BBC_COUNTER_NAME]=this._counterName,o.customObject=r;var a,s=o.customObject[h.IS_BACKGROUND];for(var c in!1===s||"false"===s?a=!1:Boolean(o.customObject[h.IS_BACKGROUND])?a=!0:E.info("Unknown value for is_background: "+o.customObject[h.IS_BACKGROUND]),r)this._tag&&this._tag.setParam(c,g.cleanCustomVariable(r[c]),{hitType:["all"],permanent:!0});a?(u.sendImpressionEvent(this._tag,o),E.info("Sent Background action event: "+t)):(u.sendClickEvent(this._tag,o),E.info("Sent user action event: "+t))}}},V.prototype.setPlayerName=function(e){this._mediaPlayerName=e},V.prototype.setPlayerVersion=function(e){this._mediaPlayerVersion=e},V.prototype.setPlayerIsPopped=U,V.prototype.setPlayerWindowState=U,V.prototype.setPlayerVolume=U,V.prototype.setPlayerIsSubtitled=U,V.prototype.setBroker=function(e){return this._broker=e,this},V.prototype.setMedia=function(e){this._eventsEnabled()&&(this._mediaPlayerName&&!e.getMediaPlayerName()&&e.setMediaPlayerName(this._mediaPlayerName),this._mediaPlayerVersion&&!e.getMediaPlayerVersion()&&e.setMediaPlayerVersion(this._mediaPlayerVersion),this._appName?e.appName=this._appName:e.appName="",this._appType?e.appType=this._appType:e.appType="",this.clearMedia(),this._media=e,this.addMedia(this._media))},V.prototype.setMediaLength=function(e){this._mediaLength=e,this._media.setLength(e)},V.prototype.setMediaBitrate=U,V.prototype.setMediaCodec=U,V.prototype.setMediaCDN=U,V.prototype.liveMediaUpdate=function(e,t,i){f.assert("number"==typeof t,"newPosition must be a number"),f.assert("number"==typeof i,"oldPosition must be a number"),e.setProducerById(this._media.getProducer()),this._sendMediaEvent(y),this._media=e,this.addMedia(this._media),this._sendMediaEvent(A)},V.prototype.liveEnrichmentFailed=U,V.prototype._getIdObjectValue=function(e){return null!==e&&e.isValueValid()?e.getValue():""},V.prototype._getMostPrecedentIdObject=function(){var e=this._media.getVersionIdObject(),t=this._media.getEpisodeIdObject(),i=this._media.getClipIdObject(),n=this._media.getVpIdObject(),r=this._media.getServiceIdObject();return e.isValueValid()?e:t.isValueValid()?t:i.isValueValid()?i:n.isValueValid()?n:r.isValueValid()?r:null},V.prototype._eventsEnabled=function(){return this._isEnabled&&this._hasStarted},V.prototype.addMedia=function(e){if(this._tag&&this._tag.richMedia){this._commonMediaParams={playerId:e.getPlayerId(),mediaLabel:this._getIdObjectValue(this._getMostPrecedentIdObject()),mediaTheme1:n.constructThemeOne(e,this._config[s.USE_ESS]),mediaTheme2:n.constructThemeTwo(e),mediaTheme3:n.constructThemeThree(e)};var t={mediaType:e.getAvType(),playerId:this._commonMediaParams.playerId,duration:e&&e.getLength()?Math.ceil(e.getLength()/1e3):0,mediaLabel:this._commonMediaParams.mediaLabel,mediaTheme1:this._commonMediaParams.mediaTheme1,mediaTheme2:this._commonMediaParams.mediaTheme2,mediaTheme3:this._commonMediaParams.mediaTheme3,isEmbedded:e.isEmbedded(),broadcastMode:e.getMediaConsumptionMode()===b?b:O,refreshDuration:{0:10,1:60}};for(var i in e.getProducerId()?t.mediaLevel2=e.getProducerId():t.mediaLevel2=0,this._customParams)this._tag&&this._tag.setParam(i,g.cleanCustomVariable(this._customParams[i]),{hitType:["all"],permanent:!0});this._tag.richMedia.add(t)}},V.prototype._sendMediaEvent=function(e,t){this._commonMediaParams&&r.sendEvent(this._tag,this._commonMediaParams,e,t)},V.prototype.avPlayEvent=function(e,t){this._eventsEnabled()&&!this._media.getPlaying()&&(this._media.getBuffering()?this._sendMediaEvent(I,{isBuffering:!1}):(this._sendMediaEvent(A),this._addKeepAliveEventSchedule()))},V.prototype._addKeepAliveEventSchedule=function(){this._eventsEnabled()&&(this._keepAliveIntervalId||(this._keepAliveIntervalId=setInterval(this._sendKeepAliveEvent.bind(this),this._keepAliveDuration)))},V.prototype._removeKeepAliveEventSchedule=function(){this._keepAliveIntervalId&&(clearInterval(this._keepAliveIntervalId),this._keepAliveIntervalId=void 0)},V.prototype._sendKeepAliveEvent=function(){if(this._eventsEnabled()){var e={name:"keepalive",level2:this._media&&this._media.getProducerId()?this._media.getProducerId():0};this._tag.page.send(e),E.info("Sending keepalive"),this._lastPage&&this._tag.page.set(this._lastPage)}},V.prototype.avPauseEvent=function(){if(this._eventsEnabled()){for(var e in this._customParams)this._tag&&this._tag.setParam(e,g.cleanCustomVariable(this._customParams[e]),{hitType:["all"],permanent:!0});this._sendMediaEvent(S)}},V.prototype.avBufferEvent=function(){this._eventsEnabled()&&this._sendMediaEvent(I,{isBuffering:!0})},V.prototype.avEndEvent=function(){this._eventsEnabled()&&(this._isMediaLoaded=!1,this._removeKeepAliveEventSchedule(),this._sendMediaEvent(y),this.isValidMedia()&&this.clearMedia())},V.prototype.avRewindEvent=function(){this._eventsEnabled()&&this._sendMediaEvent(C)},V.prototype.avFastForwardEvent=function(){this._eventsEnabled()&&this._sendMediaEvent(C)},V.prototype.avSeekEvent=function(){this._eventsEnabled()&&this._sendMediaEvent(C)},V.prototype.avUserActionEvent=function(e,t,i,n){if(this._eventsEnabled()&&"echo_hb"===e&&"echo_hb_5"===t){var r=this._addLengthToMediaHit(this._lastPlayHitUrl);o.sendRefreshEvent(this._tag,this._getHttpGetMethod(),r),E.info("Performed 5 second heartbeat")}},V.prototype.clearMedia=function(){this.isValidMedia()&&(this._isMediaLoaded&&this.avEndEvent(),this._stream=null,this._media=null,this._commonMediaParams=null,this._tag.richMedia.removeAll())},V.prototype.isValidMedia=function(){return null!==this._media&&this._media.avType===m.AvType.VIDEO},V.prototype.isValidLiveMedia=function(){return this.isValidMedia()&&this._media.isLive()},V.prototype.getDeviceId=function(){return this._deviceId},V.prototype.setDeviceId=function(e){this._deviceId=e,this._tag&&(E.info("Updating ATI SmartTag device id:"+e),this._setSmartTagDeviceId(this._tag,e))},V.prototype.requiresLabelCleansing=function(){return!0},V}.call(t,k,t,e))||(e.exports=i)},function(e,t,i){var n;void 0===(n=function(){return function(){var e,a={site:596068,log:"",logSSL:"",domain:"ati-host.net",collectDomain:"logw363.ati-host.net",collectDomainSSL:"logws1363.ati-host.net",userIdOrigin:"server",pixelPath:"/hit.xiti",disableCookie:!1,disableStorage:!1,cookieSecure:!1,cookieDomain:"",preview:!1,plgs:["Campaigns","Clicks","ClientSideUserId","ContextVariables","Offline","OnSiteAds","Page","RichMedia"],lazyLoadingPath:"",documentLevel:"document",redirect:!1,activateCallbacks:!0,medium:"",ignoreEmptyChapterValue:!0,base64Storage:!1,sendHitWhenOptOut:!0,forceHttp:!1,requestMethod:"GET",maxHitSize:2e3};(e=window).Echo1202ATInternet=e.Echo1202ATInternet||{},e.Echo1202ATInternet.Tracker=e.Echo1202ATInternet.Tracker||{},e.Echo1202ATInternet.Tracker.Plugins=e.Echo1202ATInternet.Tracker.Plugins||{};Echo1202ATInternet.Utils=new function(){function i(e){return null===e?"":(e+"").replace(t,"")}var v=this,n=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g,t=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g");v.isLocalStorageAvailable=function(){try{var e=localStorage;return e.setItem("__storage_test__","__storage_test__"),e.removeItem("__storage_test__"),!0}catch(e){return!1}},v.isBeaconMethodAvailable=function(){return window.navigator&&"function"==typeof window.navigator.sendBeacon},v.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,i,n,r,o,a,s="",c=0;for(e=v.Base64._utf8_encode(e);c<e.length;)r=(t=e.charCodeAt(c++))>>2,t=(3&t)<<4|(i=e.charCodeAt(c++))>>4,o=(15&i)<<2|(n=e.charCodeAt(c++))>>6,a=63&n,isNaN(i)?o=a=64:isNaN(n)&&(a=64),s=s+this._keyStr.charAt(r)+this._keyStr.charAt(t)+this._keyStr.charAt(o)+this._keyStr.charAt(a);return s},decode:function(e){var t,i,n,r,o,a="",s=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");s<e.length;)t=(t=this._keyStr.indexOf(e.charAt(s++)))<<2|(i=this._keyStr.indexOf(e.charAt(s++)))>>4,i=(15&i)<<4|(r=this._keyStr.indexOf(e.charAt(s++)))>>2,n=(3&r)<<6|(o=this._keyStr.indexOf(e.charAt(s++))),a+=String.fromCharCode(t),64!=r&&(a+=String.fromCharCode(i)),64!=o&&(a+=String.fromCharCode(n));return v.Base64._utf8_decode(a)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):(127<n&&n<2048?t+=String.fromCharCode(n>>6|192):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128)),t+=String.fromCharCode(63&n|128))}return t},_utf8_decode:function(e){for(var t,i,n,r="",o=0;o<e.length;)(t=e.charCodeAt(o))<128?(r+=String.fromCharCode(t),o++):191<t&&t<224?(i=e.charCodeAt(o+1),r+=String.fromCharCode((31&t)<<6|63&i),o+=2):(i=e.charCodeAt(o+1),n=e.charCodeAt(o+2),r+=String.fromCharCode((15&t)<<12|(63&i)<<6|63&n),o+=3);return r}},v.loadScript=function(e,t){var i;t=t||function(){},(i=document.createElement("script")).type="text/javascript",i.src=e.url,i.async=!1,i.defer=!1,i.onload=i.onreadystatechange=function(e){("load"===(e=e||window.event).type||/loaded|complete/.test(i.readyState)&&(!document.documentMode||document.documentMode<9))&&(i.onload=i.onreadystatechange=i.onerror=null,t(null,e))},i.onerror=function(e){i.onload=i.onreadystatechange=i.onerror=null,t({msg:"script not loaded",event:e})};var n=document.head||document.getElementsByTagName("head")[0];n.insertBefore(i,n.lastChild)},v.cloneSimpleObject=function(e,t){if("object"!=typeof e||null===e||e instanceof Date)return e;var i,n=new e.constructor;for(i in e)e.hasOwnProperty(i)&&(void 0===i||t&&void 0===e[i]||(n[i]=v.cloneSimpleObject(e[i])));return n},v.isEmptyObject=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},v.isObject=function(e){return null!==e&&"object"==typeof e&&!(e instanceof Array)},v.ATVALUE="_ATVALUE",v.ATPREFIX="_ATPREFIX",v.object2Flatten=function(e,t,i,n,r){var o,a={},s="",c="",u=[],l="",d=0;for(o in e)if(e.hasOwnProperty(o))if(s=(a=v.splitProtocolAndKey(o,r)).prefix||n||"",c=(t?t+"_":"")+a.key,v.isObject(e[o]))v.object2Flatten(e[o],c,i,s,r);else{for(u=c.split("_"),l="",d=0;d<u.length;d++)s=(a=v.splitProtocolAndKey(u[d],r)).prefix||s,l+=a.key+(d<u.length-1?"_":"");i[c=l||c]=i[c]||{},i[c][v.ATVALUE]=e[o],i[c][v.ATPREFIX]=s}},v.flatten2Object=function(e,t,i){var n,r;for(t=t.split("_"),r=0;r<t.length-1;r++)e[n=t[r]]||(e[n]={}),e=e[n];if(e.hasOwnProperty(v.ATVALUE)){n=e[v.ATVALUE];var o=e[v.ATPREFIX];delete e[v.ATVALUE],delete e[v.ATPREFIX],e.$={},e.$[v.ATVALUE]=n,e.$[v.ATPREFIX]=o}i=v.cloneSimpleObject(i),e[t[r]]?e[t[r]].$=i:e[t[r]]=i},v.getFormattedObject=function(e){var t,i={};for(t in e)e.hasOwnProperty(t)&&(e[t].hasOwnProperty(v.ATVALUE)?i[e[t][v.ATPREFIX]?e[t][v.ATPREFIX]+":"+t:t]=e[t][v.ATVALUE]:i[t]=v.getFormattedObject(e[t]));return i},v.completeFstLevelObj=function(e,t,i){if(e){if(t)for(var n in t)!t.hasOwnProperty(n)||e[n]&&!i||(e[n]=t[n])}else e=t;return e},v.getObjectKeys=function(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(t);return i},v.objectToLowercase=function(e){var t,i={};for(t in e)e.hasOwnProperty(t)&&(v.isObject(e[t])?i[t.toLowerCase()]=v.objectToLowercase(e[t]):i[t.toLowerCase()]=e[t]);return i},v.splitProtocolAndKey=function(e,t){var i,n;return n=e.length<2||":"!==e[1]?(i="",e):e.length<4||":"!==e[3]?(i=e.substring(0,1),e.substring(2,e.length)):(i=e.substring(0,3),e.substring(4,e.length)),t&&(i=i.toLowerCase(),n=n.toLowerCase()),{prefix:i,key:n}},v.jsonSerialize=function(e){try{return"undefined"!=typeof JSON&&JSON.stringify?JSON.stringify(e):function e(t){var i=typeof t;if("object"!==i||null===t)return"string"===i&&(t='"'+t+'"'),String(t);var n,r,o=[],a=t.constructor===Array;for(n in t)t.hasOwnProperty(n)&&"function"!=(i=typeof(r=t[n]))&&"undefined"!==i&&("string"===i?r='"'+r.replace(/[^\\]"/g,'\\"')+'"':"object"===i&&null!==r&&(r=e(r)),o.push((a?"":'"'+n+'":')+String(r)));return(a?"[":"{")+String(o)+(a?"]":"}")}(e)}catch(e){return null}},v.jsonParse=function(e){try{return"undefined"!=typeof JSON&&JSON.parse?JSON.parse(e+""):(o=null,(t=i((t=e)+""))&&!i(t.replace(n,function(e,t,i,n){return r&&t&&(o=0),0===o?e:(r=i||t,o+=!n-!i,"")}))?Function("return "+t)():null)}catch(e){return null}var t,r,o},v.trim=function(t){try{return String.prototype.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}catch(e){return t}},v.arrayIndexOf=function(e,t){if(Array.prototype.indexOf){var i=-1;return void 0!==e.indexOf(t)&&(i=e.indexOf(t)),i}return function(e){if(null==this)throw new TypeError;var t=Object(this),i=t.length>>>0;if(0===i)return-1;var n=0;if(1<arguments.length&&((n=Number(arguments[1]))!=n?n=0:0!=n&&1/0!=n&&-1/0!=n&&(n=(0<n||-1)*Math.floor(Math.abs(n)))),i<=n)return-1;for(n=0<=n?n:Math.max(i-Math.abs(n),0);n<i;n++)if(n in t&&t[n]===e)return n;return-1}.apply(e,[t])},v.uuid=function(){var n=window.crypto||window.msCrypto,r=null!==n&&"object"==typeof n;return{v4:function(){try{if(r)return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^n.getRandomValues(new Uint32Array(1))[0]&15>>e/4).toString(16)})}catch(e){}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},num:function(e){var t=new Date,i=function(e){return(e-=100*Math.floor(e/100))<10?"0"+e:String(e)};return i(t.getHours())+""+i(t.getMinutes())+i(t.getSeconds())+function(e){var t=Math.random();try{r&&(t=n.getRandomValues(new Uint32Array(1))[0]/Math.pow(2,32))}catch(e){}return Math.floor((9*t+1)*Math.pow(10,e-1))}(e-6)}}},v.isPreview=function(){return window.navigator&&"preview"===window.navigator.loadPurpose},v.isPrerender=function(t){var i,e=!1,n=["webkit","ms"];if("prerender"===document.visibilityState)i="visibilitychange";else for(var r=0;r<n.length;r++)"prerender"===document[n[r]+"VisibilityState"]&&(i=n[r]+"visibilitychange");if(void 0!==i){var o=function(e){t(e),v.removeEvtListener(document,i,o)};v.addEvtListener(document,i,o),e=!0}return e},v.addEvtListener=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)},v.removeEvtListener=function(e,t,i){e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent&&e.detachEvent("on"+t,i)},v.hashcode=function(e){var t=0;if(0===e.length)return t;for(var i=0;i<e.length;i++)t=0|(t=(t<<5)-t+e.charCodeAt(i));return t},v.setLocation=function(e){var t=e.location;e=window[e.target]||window,t&&(e.location.href=t)},v.dispatchCallbackEvent=function(e){var t;if("function"==typeof window.Event)t=new Event("ATCallbackEvent");else try{(t=document.createEvent("Event")).initEvent&&t.initEvent("ATCallbackEvent",!0,!0)}catch(e){}t&&"function"==typeof document.dispatchEvent&&(t.name=e,document.dispatchEvent(t))},v.addCallbackEvent=function(e){v.addEvtListener(document,"ATCallbackEvent",e)},v.removeCallbackEvent=function(e){v.removeEvent("ATCallbackEvent",e)},function(){function e(e,t){var i;t=t||{bubbles:!1,cancelable:!1,detail:void 0};try{(i=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail)}catch(e){}return i}"function"==typeof window.CustomEvent?window.ATCustomEvent=window.CustomEvent:("function"==typeof window.Event&&(e.prototype=window.Event.prototype),window.ATCustomEvent=e)}(),v.addEvent=function(e,t,i,n){v[e]=new ATCustomEvent(e,{detail:{name:t,id:i}}),v.addEvtListener(document,e,n)},v.removeEvent=function(e,t){v.removeEvtListener(document,e,t)},v.dispatchEvent=function(e,t){v[e]=v[e]||new ATCustomEvent(e,{detail:{name:t,id:-1}});try{document.dispatchEvent(v[e])}catch(e){}},v.privacy=new function(){function f(e,t){var i,n,r=[];i={};for(var o=0;o<e.length;o++){for(var a in i={},v.object2Flatten(e[o],null,i,null,!0),i)i.hasOwnProperty(a)&&-1===v.arrayIndexOf(t,a)&&delete i[a];if(!v.isEmptyObject(i)){for(var s in n={},i)i.hasOwnProperty(s)&&v.flatten2Object(n,s,i[s]);i=v.getFormattedObject(n),r.push(i)}}return r}function E(e){for(var t=[],i={},n=0;n<e.length;n++)if("string"==typeof e[n])t.push(e[n]);else for(var r in e[n])e[n].hasOwnProperty(r)&&(t.push(r),i[r]=(i[r]||[]).concat(e[n][r]));return{keys:t,values:i}}var g=this,m={storageParams:null,bufferParams:null};g.CONSENTNO="Consent-NO",g.ALL="*",g.testStorageParam=function(e,t){var i;if(m.storageParams instanceof Array){for(var n,r=m.storageParams.length-1;0<=r;r--)if("string"==typeof(n=m.storageParams[r])){if(n===e||n===g.ALL)return{toSetInStorage:!0}}else{e:{i=e;var o=t,a=void 0,s=void 0;for(s in n)if(n.hasOwnProperty(s)&&i===s){if(!o){i=!0;break e}a=[],n[s]instanceof Array?a=n[s]:a.push(n[s]);for(var c=0;c<a.length;c++)if(a[c]===o){i=!0;break e}}i=!1}if(i)return{toSetInStorage:!0}}return{toSetInStorage:!1}}return{toSetInStorage:!0}},g.processStorageParams=function(e,t,i){if(i){i=i();var n=E(m.storageParams);if(n.keys[0]!==g.ALL)for(var r in i)if(i.hasOwnProperty(r))if(-1===v.arrayIndexOf(n.keys,r))e&&e(r);else if(v.isObject(i[r])){var o=r,a=i[r].val,s=n.values[r],c=e,u=t;if(void 0!==s){var l=[];for(s in s instanceof Array?l=s:l.push(s),s=void 0,a)a.hasOwnProperty(s)&&-1===v.arrayIndexOf(l,s)&&c&&c([o,s]);c&&u&&v.isEmptyObject(u(o))&&c(o)}}}},g.testBufferParam=function(e,t){var i,n;if(m.bufferParams instanceof Array){for(var r,o=m.bufferParams.length-1;0<=o;o--)if("string"==typeof(r=m.bufferParams[o])){if(r===e||r===g.ALL)return{toSetInBuffer:!0,value:t}}else{e:{if(i=e,n=t,v.isObject(r)){var a=void 0,s=[],c=!1,u=a=a=void 0;for(u in r)if(r.hasOwnProperty(u)&&i===u&&("string"==typeof(a=n)&&(a=v.jsonParse(a)||a),"object"==typeof a)){a instanceof Array?(s=a,c=!0):s.push(a),n=0===(a=f(s,r[u])).length?void(i=!1):(a=c?a:a[0],i=!0,v.jsonSerialize(a));break e}}i=!1,n=void 0}if(i)return{toSetInBuffer:!0,value:n}}return{toSetInBuffer:!1}}return{toSetInBuffer:!0,value:t}},g.processBufferParams=function(e,t,i){if(t){t=t();var n=E(m.bufferParams);if(n.keys[0]!==g.ALL)for(var r in t)if(t.hasOwnProperty(r))if(-1===v.arrayIndexOf(n.keys,r))e&&e(r);else{var o=r,a=t[r],s=n.values[r],c=e,u=i;if(void 0!==s){var l=[],d=a._value,p=[],h=!1,_=void 0;_=void 0,s instanceof Array?l=s:l.push(s),"string"==typeof d&&(d=v.jsonParse(d)||d),"object"==typeof d&&(d instanceof Array?(p=d,h=!0):p.push(d),0===(_=f(p,l)).length?c&&c(o):(_=h?_:_[0],u&&u(o,v.jsonSerialize(_),a._options)))}}}},g.setParameters=function(e){m=e},g.getParameters=function(){return m},g.resetParameters=function(){m={storageParams:null,bufferParams:null}}},v.optedOut=null,v.addOptOutEvent=function(e,t){v.addEvent("ATOptOutEvent","clientsideuserid",e,t)},v.removeOptOutEvent=function(e){v.removeEvent("ATOptOutEvent",e)},v.dispatchOptOutEvent=function(e){v.optedOut=e,v.dispatchEvent("ATOptOutEvent","clientsideuserid")},v.userOptedOut=function(){v.dispatchOptOutEvent(!0)},v.userOptedIn=function(){v.dispatchOptOutEvent(!1)},v.isOptedOut=function(){if(null===v.optedOut){var e;if(e=null,v.isLocalStorageAvailable()&&(e=localStorage.getItem("atuserid")),null===e){var t=/(?:^| )atuserid=([^;]+)/.exec(document.cookie);null!==t&&(e=t[1])}if(null!==e)try{e=decodeURIComponent(e)}catch(e){}e=!(!e||null===(e=v.jsonParse(e)||v.jsonParse(v.Base64.decode(e))))&&"OPT-OUT"===e.val,v.optedOut=e}return!!v.optedOut},v.consentReceived=function(e){v.consent=!!e},v.consent=!0,v.isTabOpeningAction=function(e){var t=!1;return e&&(e.ctrlKey||e.shiftKey||e.metaKey||e.button&&1===e.button)&&(t=!0),t},v.CLICKS_REDIRECTION="redirection",v.CLICKS_FORM="form",v.CLICKS_MAILTO="mailto"};var s=function(E){var o,s=this,n=0,g=0,m=["dz"],v=function(e,t,i,n,r,o,a){return{param:e="&"+e+"=",paramSize:e.length,str:t,strSize:t.length,truncate:i,multihit:n,separator:r||"",encode:o,last:a}},T=function(e,t){var i,n="",r=0,o=0,a=0,s=(r=-1,null),c=null;for(i in e)e.hasOwnProperty(i)&&(s=e[i])&&(r=t-o,s.last&&null!==c?c[i]=s:s.strSize+s.paramSize<=r?(n+=s.param+s.str,o+=s.paramSize+s.strSize):((c=c||{})[i]=s).truncate&&(a=r-s.paramSize,s.separator&&(r=s.str.substring(0,r),0<(r=s.encode?r.lastIndexOf(encodeURIComponent(s.separator)):r.lastIndexOf(s.separator))&&(a=r)),n+=s.param+s.str.substring(0,a),o+=s.paramSize+s.str.substring(0,a).length,c[i].str=s.str.substring(a,s.strSize),c[i].strSize=c[i].str.length));return[n,c]};s.getCollectDomain=function(){var e="",t=(e=E.getConfig("logSSL")||E.getConfig("log"),E.getConfig("domain"));return e&&t?e+"."+t:E.getConfig("collectDomainSSL")||E.getConfig("collectDomain")};var i=function(t,i,a){!function(e){var t="";if(n=E.getConfig("baseURL"))t=n;else{var i,n=s.getCollectDomain();"/"!==(i=(i=E.getConfig("pixelPath"))||"/").charAt(0)&&(i="/"+i),n&&(t=(E.getConfig("forceHttp")?"http://":"https://")+n+i)}n=E.getConfig("site"),t&&n?e&&e(null,t+"?s="+n):e&&e({message:"Config error"})}(function(e,o){e?a&&a(e):(g=n-(o.length+27),function(e,t,i){var n,r,f="",o=function(e){if(e==={})return[];var t,i,n,r,o,a,s,c,u,l,d=[],p=!(t={}),h=void 0,_="";for(l in e)if(e.hasOwnProperty(l))if(s=a=o=r=!1,i=e[l]._value,"boolean"==typeof(n=e[l]._options||{}).encode&&(r=n.encode),"function"==typeof i&&(i=i()),i=i instanceof Array?i.join(n.separator||","):"object"==typeof i?Echo1202ATInternet.Utils.jsonSerialize(i):void 0===i?"undefined":i.toString(),r&&(i=encodeURIComponent(i)),-1<Echo1202ATInternet.Utils.arrayIndexOf(m,l)?o=!0:"boolean"==typeof n.truncate&&(o=n.truncate),"boolean"==typeof n.multihit&&(a=n.multihit),"boolean"==typeof n.last&&(s=n.last),i=v(l,i,o,a,n.separator,r,s),a)g-=i.paramSize+i.strSize,_+=i.param+i.str;else if(s)i.paramSize+i.strSize>g&&(i.str=i.str.substring(0,g-i.paramSize),i.strSize=i.str.length),c=l,u=i;else if(t[l]=i,t[l].paramSize+t[l].strSize>g&&!t[l].truncate){E.emit("Tracker:Hit:Build:Error",{lvl:"ERROR",msg:'Too long parameter: "'+t[l].param+'"',details:{value:t[l].str}}),p=!0,h=l;break}if(c&&(t[c]=u),e=(t=[t,p,h,_])[0],p=t[1],f=t[3],p&&((e=e[t=t[2]]).str=e.str.substring(0,g-e.paramSize),e.strSize=e.str.length,(p={}).mherr=v("mherr","1",!1,!1,"",!1,!1),p[t]=e,e=p),null===(e=T(e,g))[1])d=e[0];else for(d.push(e[0]);null!==e[1];)e=T(e[1],g),d.push(e[0]);return d},a="";if(E.buffer.presentInFilters(t,"hitType")||(t=E.buffer.addInFilters(t,"hitType",["page"])),t=E.buffer.addInFilters(t,"hitType",["all"]),Echo1202ATInternet.Utils.isObject(e)){for(n in t=E.buffer.addInFilters(t,"permanent",!0),t=E.buffer.get(t,!0),e)e.hasOwnProperty(n)&&(a={},e[n]&&"object"==typeof e[n]&&e[n].hasOwnProperty("_value")?(r=e[n]._value,e[n].hasOwnProperty("_options")&&(a=e[n]._options)):r=e[n],(r=Echo1202ATInternet.Utils.privacy.testBufferParam(n,r)).toSetInBuffer&&(t[n]={_value:r.value,_options:a}));a=o(t)}else for(n in a=o(t=E.buffer.get(t,!0)),t)t.hasOwnProperty(n)&&(t[n]._options&&t[n]._options.permanent||E.buffer.del(n));i&&i(a,f)}(t,i,function(e,t){var i=[],n=Echo1202ATInternet.Utils.uuid().num(13);if(e instanceof Array)for(var r=1;r<=e.length;r++)i.push(o+t+"&mh="+r+"-"+e.length+"-"+n+e[r-1]);else i.push(o+t+e);a&&a(null,i)}))})},a=function(t,i,n,r,o,a,s){return function(e){E.emit(t,{lvl:o,details:{hit:i,method:n,event:e,isMultiHit:a,elementType:s}}),r&&r()}};s.send=function(e,t,n,r,o){i(e,t,function(e,t){if(e)E.emit("Tracker:Hit:Build:Error",{lvl:"ERROR",msg:e.message,details:{}}),n&&n();else for(var i=0;i<t.length;i++)s.sendUrl(t[i],n,r,o)})},n=Math.max(E.getConfig("maxHitSize")||0,2e3),g=Math.max(E.getConfig("maxHitSize")||0,2e3),o=E.getConfig("requestMethod"),s.sendUrl=function(e,t,i,n){var r=-1<e.indexOf("&mh=");i=i||o,Echo1202ATInternet.Utils.isOptedOut()&&!E.getConfig("sendHitWhenOptOut")?a("Tracker:Hit:Sent:NoTrack",e,i,t,"INFO",r,n)():"POST"===i&&Echo1202ATInternet.Utils.isBeaconMethodAvailable()?(n="Tracker:Hit:Sent:Error",i="ERROR",window.navigator.sendBeacon(e,null)&&(n="Tracker:Hit:Sent:Ok",i="INFO"),a(n,e,"POST",t,i,r,"")()):((i=new Image).onload=a("Tracker:Hit:Sent:Ok",e,"GET",t,"INFO",r,n),i.onerror=a("Tracker:Hit:Sent:Error",e,"GET",t,"ERROR",r,n),i.src=e)}},u=function(){function a(e,t,i){for(var n=[],r=0;r<e.length;r++)e[r].callback(t,i),e[r].singleUse||n.push(e[r]);return n}var n={};this.on=function(e,t,i){return i=i||!1,function e(t,i,n,r){var o=t.shift();return"*"===o?(i["*"]=i["*"]||[],i["*"].push({callback:n,singleUse:r}),i["*"].length-1):0===t.length?e([o,"*"],i,n,r):(i["*"]=i["*"]||[],i[o]=i[o]||{},e(t,i[o],n,r))}(e.split(":"),n,t,i)},this.emit=function(e,t){n["*"]&&(n["*"]=a(n["*"],e,t)),function e(t,i,n,r){var o=i.shift();"*"!==o&&(0===i.length?e(t,[o,"*"],n,r):n[o]&&(n[o]["*"]=a(n[o]["*"],t,r),e(t,i,n[o],r)))}(e,e.split(":"),n,t)}},l=function(a){var s={},i={},n=0,o={},c=0,u=function(e){var t=!1;return s[e]&&(t=!0),t},r=this.unload=function(e){return u(e)?(s[e]=void 0,a.emit("Tracker:Plugin:Unload:"+e+":Ok",{lvl:"INFO"})):a.emit("Tracker:Plugin:Unload:"+e+":Error",{lvl:"ERROR",msg:"not a known plugin"}),a},t=this.load=function(e,t){return"function"==typeof t?void 0===a.getConfig.plgAllowed||0===a.getConfig.plgAllowed.length||-1<a.getConfig.plgAllowed.indexOf(e)?(s[e]=new t(a),i[e]&&u(e)&&(i[e]=!1,n--,u(e+"_ll")&&r(e+"_ll"),0===n&&a.emit("Tracker:Plugin:Lazyload:File:Complete",{lvl:"INFO",msg:"LazyLoading triggers are finished"})),a.emit("Tracker:Plugin:Load:"+e+":Ok",{lvl:"INFO"})):a.emit("Tracker:Plugin:Load:"+e+":Error",{lvl:"ERROR",msg:"Plugin not allowed",details:{}}):a.emit("Tracker:Plugin:Load:"+e+":Error",{lvl:"ERROR",msg:"not a function",details:{obj:t}}),a},l=this.isLazyloading=function(e){return e?!0===i[e]:0!==n},d=function(e){return!u(e)&&!l(e)&&u(e+"_ll")},p=function(e){i[e]=!0,n++,Echo1202ATInternet.Utils.loadScript({url:a.getConfig("lazyLoadingPath")+e+".js"})},h=function(e,t,i,n){var r=null;t=t.split("."),u(e)&&s[e][t[0]]&&(r=1<t.length&&s[e][t[0]][t[1]]?s[e][t[0]][t[1]].apply(s[e],i):s[e][t[0]].apply(s[e],i)),n&&n(r)},_=function(t,e,i,n){var r;o[r=t]?o[r]++:o[r]=1,c++,a.onTrigger("Tracker:Plugin:Load:"+t+":Ok",function(){h(t,e,i,function(e){o[t]--,0===--c&&a.emit("Tracker:Plugin:Lazyload:Exec:Complete",{lvl:"INFO",msg:"All exec waiting for lazyloading are done"}),n&&n(e)})},!0)};this.isExecWaitingLazyloading=function(){return 0!==c},a.exec=this.exec=function(e,t,i,n){d(e)?(_(e,t,i,n),p(e)):l(e)?_(e,t,i,n):h(e,t,i,n)},this.waitForDependencies=function(e,r){var t,o=function(e){for(var t={mcount:0,plugins:{}},i=0;i<e.length;i++)s.hasOwnProperty(e[i])||(t.mcount++,t.plugins[e[i]]=!0);return t}(e);if(0===o.mcount)a.emit("Tracker:Plugin:Dependencies:Loaded",{lvl:"INFO",details:{dependencies:e}}),r();else for(var i in o.plugins)o.plugins.hasOwnProperty(i)&&(a.emit("Tracker:Plugin:Dependencies:Error",{lvl:"WARNING",msg:"Missing plugin "+i}),a.onTrigger("Tracker:Plugin:Load:"+i,function(e,t){var i=e.split(":"),n=i[3];"Ok"===i[4]&&(o.plugins[n]=!1,o.mcount--,0===o.mcount&&r())},!0),d(t=i)&&p(t))},this.init=function(){for(var e in Echo1202ATInternet.Tracker.pluginProtos)Echo1202ATInternet.Tracker.pluginProtos.hasOwnProperty(e)&&t(e,Echo1202ATInternet.Tracker.pluginProtos[e])}},d=function(n){var r=this,o={},a=function(e){if(e.name){var t=!0,i=n.getConfig("callbacks");void 0!==i&&(i.include instanceof Array&&-1===Echo1202ATInternet.Utils.arrayIndexOf(i.include,e.name)&&(t=!1),i.exclude instanceof Array&&-1!==Echo1202ATInternet.Utils.arrayIndexOf(i.exclude,e.name)&&(t=!1)),Echo1202ATInternet.Callbacks&&Echo1202ATInternet.Callbacks.hasOwnProperty(e.name)&&((i={})[e.name]={function:Echo1202ATInternet.Callbacks[e.name]},t&&r.load(e.name,i[e.name].function),Echo1202ATInternet.Tracker.callbackProtos[e.name]||(Echo1202ATInternet.Tracker.callbackProtos[e.name]=i[e.name]))}};r.load=function(e,t){return"function"==typeof t?(new t(n),n.emit("Tracker:Callback:Load:"+e+":Ok",{lvl:"INFO",details:{obj:t}})):n.emit("Tracker:Callback:Load:"+e+":Error",{lvl:"ERROR",msg:"not a function",details:{obj:t}}),n},r.init=function(){if(n.getConfig("activateCallbacks")){var e=n.getConfig("callbacks");if(void 0!==e&&e.include instanceof Array)for(var t=0;t<e.include.length;t++)Echo1202ATInternet.Callbacks&&Echo1202ATInternet.Callbacks.hasOwnProperty(e.include[t])&&(o[e.include[t]]={function:Echo1202ATInternet.Callbacks[e.include[t]]},Echo1202ATInternet.Tracker.callbackProtos[e.include[t]]||(Echo1202ATInternet.Tracker.callbackProtos[e.include[t]]=o[e.include[t]]));else for(t in Echo1202ATInternet.Callbacks)Echo1202ATInternet.Callbacks.hasOwnProperty(t)&&(o[t]={function:Echo1202ATInternet.Callbacks[t]},Echo1202ATInternet.Tracker.callbackProtos[t]||(Echo1202ATInternet.Tracker.callbackProtos[t]=o[t]));if(void 0!==e&&e.exclude instanceof Array)for(t=0;t<e.exclude.length;t++)delete o[e.exclude[t]];for(var i in o)o.hasOwnProperty(i)&&o[i]&&r.load(i,o[i].function);Echo1202ATInternet.Utils.addCallbackEvent(a)}},r.removeCallbackEvent=function(){Echo1202ATInternet.Utils.removeCallbackEvent(a)}},p=function(e){var a=this,u={};a.set=function(e,t,i){(t=Echo1202ATInternet.Utils.privacy.testBufferParam(e,t)).toSetInBuffer&&((i=i||{}).hitType=i.hitType||["page"],u[e]={_value:t.value,_options:i})};var o=function(e,t,i){return(e=Echo1202ATInternet.Utils.cloneSimpleObject(e[t]))&&!i?e._value:e};a.get=function(e,t){var i={};if("string"==typeof e)i=o(u,e,t);else for(var n=function e(t,i){if(!(t&&i instanceof Array&&t instanceof Array))return[];if(0===t.length)return i;var n,r=t[0],o=[],a=Echo1202ATInternet.Utils.cloneSimpleObject(t);a.shift();for(var s=0;s<i.length;s++)if("object"!=typeof r[1])u[i[s]]&&u[i[s]]._options[r[0]]===r[1]&&o.push(i[s]);else{n=r[1].length;for(var c=0;c<n;c++)if(u[i[s]]&&u[i[s]]._options[r[0]]instanceof Array&&0<=Echo1202ATInternet.Utils.arrayIndexOf(u[i[s]]._options[r[0]],r[1][c])){o.push(i[s]);break}}return e(a,o)}(e,Echo1202ATInternet.Utils.getObjectKeys(u)),r=0;r<n.length;r++)i[n[r]]=o(u,n[r],t);return i},a.presentInFilters=function(e,t){return!(!e||0===e.length)&&(e[0][0]===t||a.presentInFilters(e.slice(1),t))},a.addInFilters=function(e,t,i,n){if(!e||0===e.length)return n?[]:[[t,i]];var r=e[0][0],o=e[0][1];return r===t&&(o instanceof Array&&-1===Echo1202ATInternet.Utils.arrayIndexOf(o,i[0])&&o.push(i[0]),n=!0),[[r,o]].concat(a.addInFilters(e.slice(1),t,i,n))},a.del=function(e){u[e]=void 0},a.clear=function(){u={}}},h=function(i){var n=this,r={};n.setProp=function(e,t,i){void 0!==e&&(r[e]={value:t,persistent:!!i})},n.setProps=function(e,t){if(Echo1202ATInternet.Utils.isObject(e))for(var i in e)e.hasOwnProperty(i)&&n.setProp(i,e[i],t)},n.delProp=function(e,t){void 0!==r[e]&&delete r[e],!t&&i.delParam(e.toLowerCase())},n.delProps=function(e){for(var t in r)r.hasOwnProperty(t)&&n.delProp(t,e)},n.getProp=function(e){return(r=r||{})[e]},n.getProps=function(){return r}};Echo1202ATInternet.Tracker.Tag=function(e,t,i){t=t||{};var c=this;c.version="5.26.0";var n=Echo1202ATInternet.Utils.cloneSimpleObject(t);c.triggers=new u(c),c.emit=c.triggers.emit,c.onTrigger=c.triggers.on;var r,o=Echo1202ATInternet.Utils.cloneSimpleObject(a)||{};for(r in e)e.hasOwnProperty(r)&&(o[r]=e[r]);c.getConfig=function(e){return o[e]},c.setConfig=function(e,t,i){void 0!==o[e]&&i||(c.emit("Tracker:Config:Set:"+e,{lvl:"INFO",details:{bef:o[e],aft:t}}),o[e]=t)},c.configPlugin=function(e,t,i){for(var n in o[e]=o[e]||{},t)t.hasOwnProperty(n)&&void 0===o[e][n]&&(o[e][n]=t[n]);return i&&(i(o[e]),c.onTrigger("Tracker:Config:Set:"+e,function(e,t){i(t.details.aft)})),o[e]},c.getAllContext=function(){return n},c.getContext=function(e){return n[e]},c.setContext=function(e,t){c.emit("Tracker:Context:Set:"+e,{lvl:"INFO",details:{bef:n[e],aft:t}}),n[e]=t},c.delContext=function(e,t){if(c.emit("Tracker:Context:Deleted:"+e+":"+t,{lvl:"INFO",details:{key1:e,key2:t}}),e)n.hasOwnProperty(e)&&(t?n[e]&&n[e].hasOwnProperty(t)&&(n[e][t]=void 0):n[e]=void 0);else if(t)for(var i in n)n.hasOwnProperty(i)&&n[i]&&n[i].hasOwnProperty(t)&&(n[i][t]=void 0)},c.plugins=new l(c),c.buffer=new p(c),c.setParam=c.buffer.set,c.getParams=function(e){return c.buffer.get(e,!1)},c.getParam=c.buffer.get,c.delParam=c.buffer.del,c.builder=new s(c),c.sendUrl=c.builder.sendUrl,c.callbacks=new d(c),c.properties=new h(c),c.setProp=c.properties.setProp,c.setProps=c.properties.setProps,c.delProp=c.properties.delProp,c.delProps=c.properties.delProps,c.getProp=c.properties.getProp,c.getProps=c.properties.getProps,c.sendHit=function(e,t,i,n,r){var o,a,s=c.getProps();for(a in s)s.hasOwnProperty(a)&&(o=s[a].value,s[a].persistent?c.setParam(a.toLowerCase(),o,{permanent:!0,hitType:["all"],encode:!0}):(Echo1202ATInternet.Utils.isObject(e)?e[a.toLowerCase()]={_value:o,_options:{hitType:["all"],encode:!0}}:c.setParam(a.toLowerCase(),o,{hitType:["all"],encode:!0}),c.delProp(a,!0)));c.builder.send(e,t,i,n,r)},Echo1202ATInternet.Utils.privacy.resetParameters(),c.setParam("ts",function(){return(new Date).getTime()},{permanent:!0,hitType:["all"]}),(c.getConfig("disableCookie")||c.getConfig("disableStorage"))&&c.setParam("idclient",Echo1202ATInternet.Utils.privacy.CONSENTNO,{permanent:!0,hitType:["all"]}),c.getConfig("medium")&&c.setParam("medium",c.getConfig("medium"),{permanent:!0,hitType:["all"]}),c.plugins.init(),c.callbacks.init(),c.emit("Tracker:Ready",{lvl:"INFO",msg:"Tracker initialized",details:{tracker:c,args:{config:e,context:t,callback:i}}}),i&&i(c),Echo1202ATInternet.Tracker.instances.push(c)},Echo1202ATInternet.Tracker.instances=[],Echo1202ATInternet.Tracker.pluginProtos={},Echo1202ATInternet.Tracker.addPlugin=function(e,t){if(t=t||Echo1202ATInternet.Tracker.Plugins[e],!Echo1202ATInternet.Tracker.pluginProtos[e]){Echo1202ATInternet.Tracker.pluginProtos[e]=t;for(var i=0;i<Echo1202ATInternet.Tracker.instances.length;i++)Echo1202ATInternet.Tracker.instances[i].plugins.load(e,t)}},Echo1202ATInternet.Tracker.delPlugin=function(e){if(Echo1202ATInternet.Tracker.pluginProtos[e]){Echo1202ATInternet.Tracker.pluginProtos[e]=void 0;for(var t=0;t<Echo1202ATInternet.Tracker.instances.length;t++)Echo1202ATInternet.Tracker.instances[t].plugins.unload(e)}},Echo1202ATInternet.Tracker.callbackProtos={}}.call(window),function(){var e={lifetime:30,lastPersistence:!0,domainAttribution:!0,enableUTMTracking:!0,UTMParameters:["utm_source","utm_medium","utm_campaign","utm_term","utm_content"],querystringPrefix:"at_"},t=30,i=30;Echo1202ATInternet.Tracker.Plugins.Campaigns=function(r){r.setConfig("visitLifetime",t,!0),r.setConfig("redirectionLifetime",i,!0);var o,a,d={};r.configPlugin("Campaigns",e,function(e){d=e});var s,c,u,l,p,h,_,f,E,g,m,v,T,I=function(){var c=function(e){var t="";return e&&(t=isNaN(e)&&-1===e.search(/^\[(.*?)\]$/g)&&-1===e.search(/^\d+\[(.*?)\]$/g)?"["+e+"]":e),t},u=function(e){var t=e;return-1!==e.search(/[-]/g)&&-1===e.search(/^\[(.*?)\]$/g)&&(t="["+e+"]"),t},l=function(e){for(;"-"===e.charAt(e.length-1);)e=e.substring(0,e.length-1);return e};this.SponsoredLinks=function(){var a={google:"goo",yahoo:"ysm",miva:"miv",orange:"wan",msn:"msn",mirago:"mir",sklik:"skl",adfox:"adf",etarget:"etg",yandex:"yan",ebay:"eba",searchalliance:"sal",bing:"bin",naver:"nav",baidu:"bdu",qwant:"qwt",waze:"waz",amazon:"amz"},s={search:"s",content:"c"};this.atMedium="sl",this.atTerm=this.atNetwork=this.atVariant=this.atCreation=this.atPlatform=this.atCampaign="",this.format=function(){var e=c(this.atCampaign),t=a[this.atPlatform]||u(this.atPlatform),i=c(this.atCreation),n=c(this.atVariant),r=s[this.atNetwork]||u(this.atNetwork),o=c(this.atTerm);return l("sec-"+e+"-"+t+"-"+i+"-"+n+"-"+r+"-"+o)},this.setProperties=function(e){this.atCampaign=r.utils.getQueryStringValue(d.querystringPrefix+"campaign",e)||"",this.atPlatform=r.utils.getQueryStringValue(d.querystringPrefix+"platform",e)||"",this.atCreation=r.utils.getQueryStringValue(d.querystringPrefix+"creation",e)||"",this.atVariant=r.utils.getQueryStringValue(d.querystringPrefix+"variant",e)||"",this.atNetwork=r.utils.getQueryStringValue(d.querystringPrefix+"network",e)||"",this.atTerm=r.utils.getQueryStringValue(d.querystringPrefix+"term",e)||"",r.setContext("campaigns_events",{$:this.atMedium,campaign:this.atCampaign,platform:this.atPlatform,creation:this.atCreation,variant:this.atVariant,network:this.atNetwork,term:this.atTerm})}},this.Email=function(){var s={acquisition:"erec",retention:"epr",promotion:"es"};this.atMedium="email",this.atSendTime=this.atRecipientList=this.atRecipientId=this.atLink=this.atSendDate=this.atCreation=this.atCampaign=this.atEmailtype="",this.format=function(){var e=s[this.atEmailtype]||s.promotion,t=c(this.atCampaign),i=c(this.atCreation),n=u(this.atSendDate),r=c(this.atLink),o=u(this.atRecipientId)+(this.atRecipientList?"@"+u(this.atRecipientList):""),a=u(this.atSendTime);return l(e+"-"+t+"-"+i+"-"+n+"-"+r+"-"+o+"-"+a)},this.setProperties=function(e){this.atEmailtype=r.utils.getQueryStringValue(d.querystringPrefix+"emailtype",e)||"",this.atCampaign=r.utils.getQueryStringValue(d.querystringPrefix+"campaign",e)||"",this.atCreation=r.utils.getQueryStringValue(d.querystringPrefix+"creation",e)||"",this.atSendDate=r.utils.getQueryStringValue(d.querystringPrefix+"send_date",e)||"",this.atLink=r.utils.getQueryStringValue(d.querystringPrefix+"link",e)||"",this.atRecipientId=r.utils.getQueryStringValue(d.querystringPrefix+"recipient_id",e)||"",this.atRecipientList=r.utils.getQueryStringValue(d.querystringPrefix+"recipient_list",e)||"",this.atSendTime=r.utils.getQueryStringValue(d.querystringPrefix+"send_time",e)||"",r.setContext("campaigns_events",{$:this.atMedium,emailtype:this.atEmailtype,campaign:this.atCampaign,creation:this.atCreation,send_date:this.atSendDate,link:this.atLink,recipient_id:this.atRecipientId,recipient_list:this.atRecipientList,send_time:this.atSendTime})}},this.Affiliate=function(){this.atMedium="affiliate",this.atVariant=this.atCreation=this.atFormat=this.atIdentifier=this.atType=this.atCampaign="",this.format=function(){var e=c(this.atCampaign),t=c(this.atType),i=c(this.atIdentifier),n=c(this.atFormat),r=c(this.atCreation),o=c(this.atVariant);return l("al-"+e+"-"+t+"-"+i+"-"+n+"-"+r+"-"+o)},this.setProperties=function(e){this.atCampaign=r.utils.getQueryStringValue(d.querystringPrefix+"campaign",e)||"",this.atType=r.utils.getQueryStringValue(d.querystringPrefix+"type",e)||"",this.atIdentifier=r.utils.getQueryStringValue(d.querystringPrefix+"identifier",e)||"",this.atFormat=r.utils.getQueryStringValue(d.querystringPrefix+"format",e)||"",this.atCreation=r.utils.getQueryStringValue(d.querystringPrefix+"creation",e)||"",this.atVariant=r.utils.getQueryStringValue(d.querystringPrefix+"variant",e)||"",r.setContext("campaigns_events",{$:this.atMedium,campaign:this.atCampaign,type:this.atType,identifier:this.atIdentifier,format:this.atFormat,creation:this.atCreation,variant:this.atVariant})}},this.Display=function(){this.atMedium="display",this.atDetailPlacement=this.atGeneralPlacement=this.atChannel=this.atFormat=this.atVariant=this.atCreation=this.atCampaign="",this.format=function(){var e=c(this.atCampaign),t=c(this.atCreation),i=c(this.atVariant),n=c(this.atFormat),r=c(this.atChannel),o=c(this.atGeneralPlacement),a=c(this.atDetailPlacement);return l("ad-"+e+"-"+t+"-"+i+"-"+n+"-"+r+"-"+o+"-"+a)},this.setProperties=function(e){this.atCampaign=r.utils.getQueryStringValue(d.querystringPrefix+"campaign",e)||"",this.atCreation=r.utils.getQueryStringValue(d.querystringPrefix+"creation",e)||"",this.atVariant=r.utils.getQueryStringValue(d.querystringPrefix+"variant",e)||"",this.atFormat=r.utils.getQueryStringValue(d.querystringPrefix+"format",e)||"",this.atChannel=r.utils.getQueryStringValue(d.querystringPrefix+"channel",e)||"",this.atGeneralPlacement=r.utils.getQueryStringValue(d.querystringPrefix+"general_placement",e)||"",this.atDetailPlacement=r.utils.getQueryStringValue(d.querystringPrefix+"detail_placement",e)||"",r.setContext("campaigns_events",{$:this.atMedium,campaign:this.atCampaign,creation:this.atCreation,variant:this.atVariant,format:this.atFormat,channel:this.atChannel,general_placement:this.atGeneralPlacement,detail_placement:this.atDetailPlacement})}},this.Custom=function(){this.atCustom4=this.atCustom3=this.atCustom2=this.atCustom1=this.atCampaign=this.atMedium="",this.format=function(){var e="";/\d+$/.test(this.atMedium)&&(e=/\d+$/.exec(this.atMedium)[0]);e="cs"+e;var t=c(this.atCampaign),i=c(this.atCustom1),n=c(this.atCustom2),r=c(this.atCustom3),o=c(this.atCustom4);return l(e+"-"+t+"-"+i+"-"+n+"-"+r+"-"+o)},this.setProperties=function(e){this.atMedium=r.utils.getQueryStringValue(d.querystringPrefix+"medium",e)||"",this.atCampaign=r.utils.getQueryStringValue(d.querystringPrefix+"campaign",e)||"",this.atCustom1=r.utils.getQueryStringValue(d.querystringPrefix+"custom1",e)||"",this.atCustom2=r.utils.getQueryStringValue(d.querystringPrefix+"custom2",e)||"",this.atCustom3=r.utils.getQueryStringValue(d.querystringPrefix+"custom3",e)||"",this.atCustom4=r.utils.getQueryStringValue(d.querystringPrefix+"custom4",e)||"",r.setContext("campaigns_events",{$:this.atMedium,campaign:this.atCampaign,custom1:this.atCustom1,custom2:this.atCustom2,custom3:this.atCustom3,custom4:this.atCustom4})}},this.medium={sl:this.SponsoredLinks,email:this.Email,affiliate:this.Affiliate,display:this.Display}},C=function(e,t){var i=r.getContext("campaigns")||{};i[e]=t,r.setContext("campaigns",i)},S=function(e,t){var i=r.storage[a](e);return null!==i?"object"==typeof i&&!(i instanceof Array):(r.storage[o](e,{},t),!0)};r.plugins.waitForDependencies(["Storage","Utils"],function(){var n,e;if(o="set"+(d.domainAttribution?"":"Private"),a="get"+(d.domainAttribution?"":"Private"),s=r.storage[a](["atredir","gopc"]),c=r.storage[a](["atredir","gopc_err"]),u=r.storage[a](["atredir","camp"]),r.storage.del(["atredir","gopc"]),r.storage.del(["atredir","gopc_err"]),r.storage.del(["atredir","camp"]),l=r.storage[a](["atsession","histo_camp"]),p=r.storage[a](["atreman","camp"]),h=r.storage[a](["atreman","date"]),n=r.utils.getLocation(),function(){if(e=r.utils.getQueryStringValue(d.querystringPrefix+"medium",n)){var e,t=new I;(e="function"==typeof t.medium[e]?new t.medium[e]:new t.Custom).setProperties(n),_=e.format()}else _=r.utils.getQueryStringValue("xtor",n);f=r.utils.getQueryStringValue("xtdt",n),E=r.utils.getQueryStringValue("xts",n)}(),d.enableUTMTracking&&function(){for(var e,t=d.UTMParameters,i=0;i<t.length;i++)(e=r.utils.getQueryStringValue(t[i],n))&&C(t[i],e)}(),g=r.getContext("forcedCampaign"),m=!!r.getConfig("redirect"),T=!1,v=!!(_&&f&&E)){var t=(new Date).getTime()/6e4;T=!m&&E!==r.getConfig("site")||t-f<0||t-f>=r.getConfig("visitLifetime")}if(t=g||u||_,m&&t&&S("atredir",{path:"/",end:r.getConfig("redirectionLifetime")})){r.storage[o](["atredir","camp"],t);var i=t=!1;g||(i=u?(t=s,c):(t=v,T)),r.storage[o](["atredir","gopc"],t),r.storage[o](["atredir","gopc_err"],i)}!m&&p&&(C("xtor",p),t=(new Date).getTime()/36e5,t=Math.floor(t-h),C("roinbh",0<=t?t:0)),m||(t=null,t=u?s?g||t:g||u:v?g:g||_||t,l&&l instanceof Array&&-1<l.indexOf(t)&&(t=null),t&&C("xto",t)),m||g||(u?c&&(e=u):T&&(e=_),e&&C("pgt",e)),m||!(e=u?g||u:g||_||null)||!g&&!u&&v&&T||!g&&u&&s&&c||((!l||l instanceof Array&&l.indexOf(e)<0)&&S("atsession",{path:"/",session:60*r.getConfig("visitLifetime")})&&r.storage[o](["atsession","histo_camp"],l&&l.push(e)?l:[e]),p&&!d.lastPersistence||!S("atreman",{path:"/",session:86400*d.lifetime})||(r.storage[o](["atreman","camp"],e),r.storage[o](["atreman","date"],(new Date).getTime()/36e5))),r.emit("Campaigns:process:done",{lvl:"INFO"})})},Echo1202ATInternet.Tracker.addPlugin("Campaigns")}.call(window),function(){var e={};Echo1202ATInternet.Tracker.Plugins.Storage=function(s){var n=this,t=!1,r=null;s.configPlugin("Storage",e,function(e){"localStorage"===e.storageMode&&(t=Echo1202ATInternet.Utils.isLocalStorageAvailable())});var o={},c=function(e){return s.getConfig("base64Storage")?Echo1202ATInternet.Utils.Base64.encode(e):encodeURIComponent(e)},a=function(e){return s.getConfig("base64Storage")?Echo1202ATInternet.Utils.Base64.decode(e):decodeURIComponent(e)};r=t?new function(){var r=function(e){var t,i=+new Date,n=!1;return e.options&&(void 0!==e.options.expires?t=e.options.expires:"function"==typeof(e=e.options.end||{}).getTime?t=e.getTime():"number"==typeof e&&(t=i+1e3*e)),"number"==typeof t&&t<=i&&(n=!0),{itemToDelete:n,timestamp:t}},o=function(e){var t=!1;try{localStorage.removeItem(e),t=!0}catch(e){}return t};this.getData=function(e){var t=null;if(i=localStorage.getItem(e)){var i=a(i),n=Echo1202ATInternet.Utils.jsonParse(i);n&&"object"==typeof n?r(n).itemToDelete&&o(e)||(delete n.options.expires,t=Echo1202ATInternet.Utils.jsonSerialize(n)):t=i}return t},this.setData=function(e){var t=!1;if(e.name&&"string"==typeof e.name){var i=r(e);"number"==typeof i.timestamp&&(e.options.expires=i.timestamp);var n=Echo1202ATInternet.Utils.jsonSerialize(e);if(i.itemToDelete)t=o(e.name);else try{localStorage.setItem(e.name,c(n)),t=!0}catch(e){}}return t}}:new function(){this.getData=function(e){var t=null;return(e=RegExp("(?:^| )"+e+"=([^;]+)").exec(document.cookie)||null)&&(t=a(e[1])),t},this.setData=function(e){var t=!1;if(e.name&&"string"==typeof e.name){var i=e.options||{},n=i.end||{},r=i.domain||s.getConfig("cookieDomain"),o=i.secure||s.getConfig("cookieSecure"),a=Echo1202ATInternet.Utils.jsonSerialize(e);a=(a=(a=e.name+"="+c(a))+(i.path&&"string"==typeof i.path?";path="+i.path:""))+(r&&"string"==typeof r?";domain="+r:"")+(o&&"boolean"==typeof o?";secure":""),"function"==typeof n.toUTCString?a+=";expires="+n.toUTCString():"number"==typeof n&&(a+=";max-age="+n.toString()),document.cookie=a,this.getData(e.name)&&(t=!0)}return t}};var u=function(e,t){var i=!1;return e&&"object"==typeof e&&(t||Echo1202ATInternet.Utils.consent&&!s.getConfig("disableCookie")&&!s.getConfig("disableStorage"))&&(i=r.setData(e)),i},l=function(e,t,i){return e={name:e,val:t},i&&i.session&&"number"==typeof i.session&&(i.end=i.session),e.options=i||{},e},d=function(e){var t=null,i=null;return s.getConfig("disableCookie")||s.getConfig("disableStorage")||!e||"string"!=typeof e||(i=r.getData(e)),(e=i)&&(t=Echo1202ATInternet.Utils.jsonParse(e)),t},p=function(e,t){var i=Echo1202ATInternet.Utils.cloneSimpleObject(e);return u(i,t)?Echo1202ATInternet.Utils.jsonParse(Echo1202ATInternet.Utils.jsonSerialize(e)):null},i=function(e,t,i){return!i&&o[e]?i=o[e]:(i=d(e))&&(i.options=i.options||{},i.options.session&&"number"==typeof i.options.session&&(i.options.end=i.options.session,p(i,!1)),o[e]=i),i?t?(e=null,!i||"object"!=typeof i.val||i.val instanceof Array||void 0===i.val[t]||(e=i.val[t]),e):i.val:null},h=function(e,t,i,n,r){return t?(r=d(e))&&(!r||"object"!=typeof r.val||r.val instanceof Array?r=null:void 0===i?delete r.val[t]:r.val[t]=i,r&&(r=p(r,n))):(r=l(e,i,r=r||{}),r=p(r,n)),r?(o[e]=r).val:null},_=function(e,t){if(t)h(e,t,void 0,!0,null);else{o[e]=void 0;var i=l(e,"",{end:new Date("Thu, 01 Jan 1970 00:00:00 UTC"),path:"/"});u(i,!0)}};s.storage={},s.storage.getAll=function(){return o},s.storage.get=n.get=function(e,t){return t=!!t,e instanceof Array?i(e[0],e[1],t):i(e,"",t)},s.storage.getPrivate=n.getPrivate=function(e,t){return e instanceof Array?e[0]+=s.getConfig("site"):e+=s.getConfig("site"),n.get(e,t)},s.storage.set=n.set=function(e,t,i,n){var r;return e instanceof Array?(r=e[0],e=e[1],i=null):(r=e,e=null),Echo1202ATInternet.Utils.privacy.testStorageParam(r,e).toSetInStorage||n?h(r,e,t,n,i):null},s.storage.setPrivate=n.setPrivate=function(e,t,i){return e instanceof Array?e[0]+=s.getConfig("site"):e+=s.getConfig("site"),n.set(e,t,i)},s.storage.del=n.del=function(e){e instanceof Array?_(e[0],e[1]):_(e,"")},s.storage.delPrivate=n.delPrivate=function(e){e instanceof Array?e[0]+=s.getConfig("site"):e+=s.getConfig("site"),n.del(e)},s.storage.cacheInvalidation=n.cacheInvalidation=function(){o={}}},Echo1202ATInternet.Tracker.addPlugin("Storage")}.call(window),function(){Echo1202ATInternet.Tracker.Plugins.Utils=function(u){var e=this,o={};u.utils={},u.utils.getQueryStringValue=e.getQueryStringValue=function(e,t){var i=Echo1202ATInternet.Utils.hashcode(t).toString();if(!o[i]){o[i]={};for(var n=RegExp("[&#?]{1}([^&=#?]*)=([^&#]*)?","g"),r=n.exec(t);null!==r;)o[i][r[1]]=r[2],r=n.exec(t)}return o[i].hasOwnProperty(e)?o[i][e]:null},u.utils.manageChapters=e.manageChapters=function(e,t,i){var n="";if(e)for(var r=u.getConfig("ignoreEmptyChapterValue"),o="",a=1;a<parseInt(i,10)+1;a++)o=e[t+a]||"",n=r?n+(o?o+"::":""):n+(e.hasOwnProperty(t+a)?o+"::":"");return n},u.utils.getDocumentLevel=e.getDocumentLevel=function(){var e=u.getConfig("documentLevel");return e?e.indexOf(".")<0?window[e]||document:(e=e.split("."),window[e[0]][e[1]]||document):document},u.utils.getLocation=e.getLocation=function(){return e.getDocumentLevel().location.href},u.utils.getHostName=e.getHostName=function(){return e.getDocumentLevel().location.hostname},u.dispatchIndex={},u.dispatchStack=[],u.dispatchEventFor={};var r=0;u.dispatchSubscribe=function(e){return!u.dispatchIndex[e]&&(u.dispatchStack.push(e),u.dispatchIndex[e]=!0)},u.dispatchSubscribed=function(e){return!0===u.dispatchIndex[e]},u.addSpecificDispatchEventFor=function(e){return!u.dispatchEventFor[e]&&(u.dispatchEventFor[e]=!0,r++,!0)},u.processSpecificDispatchEventFor=function(e){u.dispatchEventFor[e]&&(u.dispatchEventFor[e]=!1,0===--r&&(u.dispatchEventFor={},u.emit("Tracker:Plugin:SpecificEvent:Exec:Complete",{lvl:"INFO"})))},u.dispatch=function(i,n){var e=function(){for(var e="",t=null;0<u.dispatchStack.length;)e=u.dispatchStack.pop(),0===u.dispatchStack.length&&(t=i),u[e].onDispatch(t,n);u.dispatchIndex={},u.delContext(void 0,"customObject")},t=function(){u.plugins.isExecWaitingLazyloading()?u.onTrigger("Tracker:Plugin:Lazyload:Exec:Complete",function(){e()},!0):e()};0===r?t():u.onTrigger("Tracker:Plugin:SpecificEvent:Exec:Complete",function(){t()},!0)},u.dispatchRedirect=function(e){var t=!0,i="",n=null;return e&&(n=null,e.hasOwnProperty("event")&&(n=e.event||window.event),!Echo1202ATInternet.Utils.isTabOpeningAction(n)&&e.elem&&u.plugins.exec("TechClicks","manageClick",[e.elem,n],function(e){t=e.preservePropagation,i=e.elementType}),n=e.callback),u.dispatch(n,i),t},u.manageSend=function(t){Echo1202ATInternet.Utils.isPreview()&&!u.getConfig("preview")||Echo1202ATInternet.Utils.isPrerender(function(e){t(e)})||t()},u.processTagObject=function(e,t,i){if((e=u.getParam(e,!0))&&e._options.permanent){for(var n=!1,r=e._options.hitType||[],o=0;o<r.length;o++)if(-1!==Echo1202ATInternet.Utils.arrayIndexOf(t.concat("all"),r[o])){n=!0;break}n&&(i=Echo1202ATInternet.Utils.completeFstLevelObj(e._value||{},i,!0))}return i},u.processContextObjectAndSendHit=function(e,t,i,n){var r={hitType:t.hitType,encode:t.encode,separator:t.separator,truncate:t.truncate},o=u.getParam(e,!0);if(o){for(var a=!1,s=o._options.hitType||[],c=0;c<s.length;c++)if(-1!==Echo1202ATInternet.Utils.arrayIndexOf(t.hitType.concat("all"),s[c])){a=!0;break}a?((a=Echo1202ATInternet.Utils.cloneSimpleObject(o))._value=Echo1202ATInternet.Utils.completeFstLevelObj(a._value||{},i,!0),u.setParam(e,a._value,r),u.manageSend(function(){u.sendHit(null,[["hitType",t.hitType]],n,t.requestMethod,t.elementType)}),o._options.permanent&&u.setParam(e,o._value,o._options)):(u.setParam(e,i,r),u.manageSend(function(){u.sendHit(null,[["hitType",t.hitType]],n,t.requestMethod,t.elementType)}),u.setParam(e,o._value,o._options))}else u.setParam(e,i,r),u.manageSend(function(){u.sendHit(null,[["hitType",t.hitType]],n,t.requestMethod,t.elementType)})}},Echo1202ATInternet.Tracker.addPlugin("Utils")}.call(window),function(){var e={clicksAutoManagementEnabled:!0,clicksAutoManagementTimeout:500};Echo1202ATInternet.Tracker.Plugins.TechClicks=function(t){var a,s,c=this,n=["Tracker:Hit:Sent:Ok","Tracker:Hit:Sent:Error","Tracker:Hit:Sent:NoTrack"],i=!1;t.configPlugin("TechClicks",e,function(e){a=e.clicksAutoManagementEnabled,s=e.clicksAutoManagementTimeout});var u=function(e){if(!i)switch(i=!0,e.target){case"_top":window.top.location.href=e.url;break;case"_parent":window.parent.location.href=e.url;break;default:window.location.href=e.url}},l=function(e){e.mailto?c.timeout=setTimeout(function(){window.location.href=e.mailto},e.timeout):e.form?c.timeout=setTimeout(function(){e.form.submit()},e.timeout):e.url&&(c.timeout=setTimeout(function(){u({url:e.url,target:e.target})},e.timeout))},d=function(i){for(var e=0;e<n.length;e++)t.onTrigger(n[e],function(e,t){i&&i(t)})};c.isFormSubmit=function(e){for(;e;){if("FORM"===e.nodeName)return!0;e=e.parentNode}return!1},t.techClicks={},t.techClicks.manageClick=c.manageClick=function(e,t){var i=!0,n="";if(a&&e){var r;e:{for(n=e;n;){if("function"==typeof n.getAttribute&&("_blank"===n.getAttribute("target")||"no"===n.getAttribute("data-atclickmanagement"))){r=!0;break e}n=n.parentNode}n=e,r=window.location.href;for(var o;n;){if((o=n.href)&&0<=o.indexOf("#")&&r.substring(0,0<=r.indexOf("#")?r.indexOf("#"):r.length)===o.substring(0,o.indexOf("#"))){r=!0;break e}n=n.parentNode}r=!1}if(n=function(e){for(var t=e;t;){if(t.href){if(0<=t.href.indexOf("mailto:"))return Echo1202ATInternet.Utils.CLICKS_MAILTO;if(0===t.href.indexOf("http"))return Echo1202ATInternet.Utils.CLICKS_REDIRECTION}else if("FORM"===t.nodeName){var i=e;if(e=!1,i&&("form"===(t=(t=i.tagName||"").toLowerCase())?e=!0:(i=(i=i.getAttribute("type")||"").toLowerCase(),"button"===t?"reset"!==i&&"button"!==i&&(e=!0):"input"===t&&"submit"===i&&(e=!0))),e)return Echo1202ATInternet.Utils.CLICKS_FORM;break}t=t.parentNode}return""}(e),!r&&n){switch(n){case Echo1202ATInternet.Utils.CLICKS_MAILTO:!function(e){for(var t=e;t&&!(t.href&&0<=t.href.indexOf("mailto:"));)t=t.parentNode;t&&(d(function(e){e.details.isMultiHit||e.details.elementType!==Echo1202ATInternet.Utils.CLICKS_MAILTO||(c.timeout&&clearTimeout(c.timeout),window.location.href=t.href)}),l({mailto:t.href,timeout:s}))}(e),i=!1;break;case Echo1202ATInternet.Utils.CLICKS_FORM:!function(e){for(var t=e;t&&"FORM"!==t.nodeName;)t=t.parentNode;t&&(d(function(e){e.details.isMultiHit||e.details.elementType!==Echo1202ATInternet.Utils.CLICKS_FORM||(c.timeout&&clearTimeout(c.timeout),t.submit())}),l({form:t,timeout:s}))}(e),i=!1;break;case Echo1202ATInternet.Utils.CLICKS_REDIRECTION:(function(e){for(var t,i="_self";e;){if(e.href&&0===e.href.indexOf("http")){t=e.href.split('"').join('\\"'),i=e.target?e.target:i;break}e=e.parentNode}t&&(d(function(e){e.details.isMultiHit||e.details.elementType!==Echo1202ATInternet.Utils.CLICKS_REDIRECTION||(c.timeout&&clearTimeout(c.timeout),u({url:t,target:i}))}),l({url:t,target:i,timeout:s}))})(e),i=!1}t&&(r=t.defaultPrevented,"function"==typeof t.isDefaultPrevented&&(r=t.isDefaultPrevented()),r||t.preventDefault&&t.preventDefault())}}return{preservePropagation:i,elementType:n}},t.techClicks.deactivateAutoManagement=function(){a=!1}},Echo1202ATInternet.Tracker.addPlugin("TechClicks")}.call(window),function(){var e={requestMethod:"POST"};Echo1202ATInternet.Tracker.Plugins.Clicks=function(o){var a={};o.configPlugin("Clicks",e,function(e){a=e});var s=function(e){var t="";switch(e){case"exit":t="S";break;case"download":t="T";break;case"action":t="A";break;case"navigation":t="N"}return t},c=function(e){return o.utils.manageChapters(e,"chapter",3)+(e.name?e.name:"")},r=function(e,t){var i={p:c(e),s2:e.level2||"",click:s(e.type)||""},n=["click"],r=o.getContext("page")||{};i.pclick=c(r),i.s2click=r.level2||"",(r=e.customObject)&&(r=o.processTagObject("stc",n,r),i.stc={_value:Echo1202ATInternet.Utils.jsonSerialize(r),_options:{hitType:n,encode:!0,separator:",",truncate:!0}}),o.sendHit(i,[["hitType",n]],e.callback,a.requestMethod,t)};o.click={},o.clickListener={},o.click.send=function(e){var t=!0,i="",n=null;return(e=e||{}).hasOwnProperty("event")&&(n=e.event||window.event),!e.elem||"POST"===a.requestMethod&&Echo1202ATInternet.Utils.isBeaconMethodAvailable()||Echo1202ATInternet.Utils.isTabOpeningAction(n)||(t=(i=o.techClicks.manageClick(e.elem,n)).preservePropagation,i=i.elementType),r(e,i),t},o.clickListener.send=function(t){if((t=t||{}).elem){var i="click",n="";o.plugins.exec("TechClicks","isFormSubmit",[t.elem],function(e){i=e?"submit":"click"}),Echo1202ATInternet.Utils.addEvtListener(t.elem,i,function(e){"POST"===a.requestMethod&&Echo1202ATInternet.Utils.isBeaconMethodAvailable()||Echo1202ATInternet.Utils.isTabOpeningAction(e)||(n=o.techClicks.manageClick(t.elem,e).elementType),r(t,n)})}},o.click.set=function(e){e=e||{},o.dispatchSubscribe("click"),o.setContext("click",{name:c(e),level2:e.level2||"",customObject:e.customObject}),o.setParam("click",s(e.type)||"",{hitType:["click"]})},o.click.onDispatch=function(e,t){var i=["click"],n=o.getContext("click")||{},r=o.getContext("page")||{};o.setParam("pclick",c(r),{hitType:i}),o.setParam("s2click",r.level2||"",{hitType:i}),o.setParam("p",n.name,{hitType:i}),o.setParam("s2",n.level2,{hitType:i}),(n=n.customObject)?o.processContextObjectAndSendHit("stc",{hitType:i,encode:!0,separator:",",truncate:!0,requestMethod:a.requestMethod,elementType:t},n,e):o.manageSend(function(){o.sendHit(null,[["hitType",i]],e,a.requestMethod,t)}),o.delContext("click")}},Echo1202ATInternet.Tracker.addPlugin("Clicks")}.call(window),function(){var d={clientSideMode:"always",userIdCookieDuration:397,userIdExpirationMode:"relative",optOut:"OPT-OUT",userIdStorageName:"atuserid",userIdHitName:"idclient",itpCompliant:!1,baseDomain:""};Echo1202ATInternet.Tracker.Plugins.ClientSideUserId=function(n){var r={},i=!1,o=null,t=-1;n.configPlugin("ClientSideUserId",d,function(e){r=e});var a=function(){var e=r.baseDomain;e||(t=n.getConfig("cookieDomain"))&&("."===(e=t).charAt(0)&&(e=e.substring(1,e.length)));var t=n.builder.getCollectDomain(),i=n.utils.getHostName();return!!(e&&t&&i&&-1!==t.indexOf(e)&&-1!==i.indexOf(e))},s=function(){o={contextUserId:void 0,storageUserId:null,finalUserId:null,isFromTrackerContext:!1,forceStorage:!1,optout:{isOptedout:!1,fromStorage:!1}}},e=function(){if("relative"===r.userIdExpirationMode||"fixed"===r.userIdExpirationMode&&null===o.storageUserId||o.isFromTrackerContext){var e=new Date;e.setTime(e.getTime()+864e5*r.userIdCookieDuration),n.storage.set(r.userIdStorageName,o.finalUserId,{end:e,path:"/"},o.forceStorage),Echo1202ATInternet.Utils.consent&&!o.isFromTrackerContext&&o.finalUserId!==n.storage.get(r.userIdStorageName,!0)&&n.setParam(r.userIdHitName,o.finalUserId+"-NO",{multihit:!0,permanent:!0,hitType:["all"]})}},c=function(){n.setParam(r.userIdHitName,o.finalUserId,{multihit:!0,permanent:!0,hitType:["all"]}),e()},u=function(){s();var e=!1;if(null===Echo1202ATInternet.Utils.optedOut?n.storage.get(r.userIdStorageName,!0)===r.optOut?e=Echo1202ATInternet.Utils.optedOut=!0:Echo1202ATInternet.Utils.optedOut=!1:!1===Echo1202ATInternet.Utils.optedOut&&(n.getParam(r.userIdHitName)===r.optOut&&n.delParam(r.userIdHitName),n.storage.get(r.userIdStorageName,!0)===r.optOut&&n.storage.del(r.userIdStorageName)),o.optout.isOptedout=Echo1202ATInternet.Utils.optedOut,o.optout.fromStorage=e,o.contextUserId=n.getContext("userIdentifier"),o.storageUserId=n.storage.get("atuserid",!0),e=!1,"required"===r.clientSideMode){var t="";window.navigator&&(t=window.navigator.userAgent),(/Safari/.test(t)&&!/Chrome/.test(t)||/iPhone|iPod|iPad/.test(t))&&(e=!0)}else"always"===r.clientSideMode&&(e=!0);if(i=e,e=!1,!n.getConfig("forceHttp")&&r.itpCompliant&&void 0===o.contextUserId&&!o.optout.isOptedout)switch(r.clientSideMode){case"never":e=a();break;case"always":case"required":i&&null!==o.storageUserId||(e=a())}e||!i&&!o.optout.isOptedout&&void 0===o.contextUserId?n.setConfig("userIdOrigin","server"):(n.setConfig("userIdOrigin","client"),o.isFromTrackerContext=!1,o.forceStorage=!1,o.optout.isOptedout?(o.finalUserId=r.optOut,o.isFromTrackerContext=!o.optout.fromStorage,o.forceStorage=!0):n.getConfig("disableCookie")||n.getConfig("disableStorage")?(o.finalUserId=n.getParam(r.userIdHitName),o.isFromTrackerContext=!0):void 0!==o.contextUserId?(o.finalUserId=o.contextUserId,o.isFromTrackerContext=!0):o.finalUserId=null!==o.storageUserId?o.storageUserId:Echo1202ATInternet.Utils.uuid().v4(),c())},l=function(e){e&&(e=e.detail)&&"clientsideuserid"===e.name&&e.id===t&&u()};n.plugins.waitForDependencies(["Storage","Utils"],function(){var e=Echo1202ATInternet.Utils.uuid();t=parseInt(e.num(8)),Echo1202ATInternet.Utils.removeOptOutEvent(l),Echo1202ATInternet.Utils.addOptOutEvent(t,l),u()}),n.clientSideUserId={},n.clientSideUserId.set=function(e){o.optout.isOptedout||(o.finalUserId=e,o.isFromTrackerContext=!0,o.forceStorage=!1,c())},n.clientSideUserId.store=function(){o.finalUserId=n.getParam(r.userIdHitName)||o.finalUserId,null!==o.finalUserId&&o.finalUserId!==Echo1202ATInternet.Utils.privacy.CONSENTNO&&o.finalUserId!==o.storageUserId&&(o.isFromTrackerContext=!0,o.forceStorage=!0,e())},n.clientSideUserId.get=function(){return o.finalUserId=n.getParam(r.userIdHitName)||o.finalUserId,o.finalUserId},n.clientSideUserId.clear=function(){s(),n.delParam(r.userIdHitName),n.storage.del(r.userIdStorageName)}},Echo1202ATInternet.Tracker.addPlugin("ClientSideUserId")}.call(window),function(){var e={domainAttribution:!0},t=30;Echo1202ATInternet.Tracker.Plugins.ContextVariables=function(r){var o,a="",s=null,c="",u="",l={};r.configPlugin("ContextVariables",e,function(e){l=e}),r.setConfig("redirectionLifetime",t,!0);var d=function(e,t){var i=null;return r.plugins.exec("Storage",e,t,function(e){i=e}),i};r.plugins.waitForDependencies(["Storage","Utils"],function(){c="set"+(l.domainAttribution?"":"Private"),u="get"+(l.domainAttribution?"":"Private");var e,t=r.utils.getLocation();if(void 0===(a=r.utils.getQueryStringValue("xtref",t))&&(a=""),o=r.getContext("forcedReferer"),r.getConfig("redirect")){var i;t=r.utils.getDocumentLevel();if(i=t=o||(null!==a?a:t?t.referrer:"acc_dir")){i={path:"/",end:r.getConfig("redirectionLifetime")};var n=d(u,["atredir"]);i=null!==n?"object"==typeof n&&!(n instanceof Array):(d(c,["atredir",{},i]),!0)}i&&d(c,[["atredir","ref"],t])}else{s=d(u,[["atredir","ref"]]),d("del",[["atredir","ref"]]),r.setParam("vtag",r.version,{permanent:!0,hitType:["all"]}),r.setParam("ptag","js",{permanent:!0,hitType:["all"]}),t="";try{t+=window.screen.width+"x"+window.screen.height+"x"+window.screen.pixelDepth+"x"+window.screen.colorDepth}catch(e){}r.setParam("r",t,{permanent:!0,hitType:["all"]}),t="",window.innerWidth?t+=window.innerWidth+"x"+window.innerHeight:document.body&&document.body.offsetWidth&&(t+=document.body.offsetWidth+"x"+document.body.offsetHeight),r.setParam("re",t,{permanent:!0,hitType:["all"]}),r.setParam("hl",function(){var e=new Date;return e.getHours()+"x"+e.getMinutes()+"x"+e.getSeconds()},{permanent:!0,hitType:["all"]}),window.navigator&&r.setParam("lng",window.navigator.language||window.navigator.userLanguage,{permanent:!0,hitType:["all"]}),t=Echo1202ATInternet.Utils.uuid().num(13),r.setParam("idp",t,{permanent:!0,hitType:["page","clickzone"]}),window.navigator&&r.setParam("jv",window.navigator.javaEnabled()?"1":"0",{hitType:["page"]}),t=r.utils.getDocumentLevel(),r.setParam("ref",(e=t,(e=o||("acc_dir"===a?"":null!==a?a:"acc_dir"===s?"":s||(e?e.referrer:"")))&&(e=e.replace(/[<>]/g,"").substring(0,1600).replace(/&/g,"$")),e),{permanent:!0,last:!0,hitType:["page","ecommerce","avinsights","events"]})}r.emit("ContextVariables:Ready",{lvl:"INFO"})})},Echo1202ATInternet.Tracker.addPlugin("ContextVariables")}.call(window),function(){var e={storageCapacity:1,timeout:500};Echo1202ATInternet.Tracker.Plugins.Offline=function(a){function s(i,n,r,o){if(window.navigator&&window.navigator.onLine){var e=p();if(0<e.length){var t=e.shift();d({hits:e}),u||(a.onTrigger("Tracker:Hit:Sent:Ok",function(e,t){i&&t.details.hit===i||s(i,n,r,o)},!1),a.onTrigger("Tracker:Hit:Sent:Error",function(e,t){i&&t.details.hit===i||s(i,n,r,o)},!1),u=!0),a.sendUrl(t,null,"GET",o)}else i&&(a.utils.getQueryStringValue("a",i)?setTimeout(function(){a.sendUrl(i,null,null,null)},c.timeout):a.sendUrl(i,n,r,o))}else i&&(_(h(i)),n&&n())}var c={},u=!1;a.configPlugin("Offline",e,function(e){c=e});var l=function(){var e=localStorage.getItem("ATOffline"),t={hits:[],length:0};if(e){var i=Echo1202ATInternet.Utils.jsonParse(e)||{hits:[]};t.hits=i.hits,t.length=e.length}return t},d=function(e){try{localStorage.setItem("ATOffline",Echo1202ATInternet.Utils.jsonSerialize(e))}catch(e){}},p=function(){return l().hits},h=function(e){if(e){e=e.split(/&ref=\.*/i);var t="&cn=offline&olt="+String(Math.floor((new Date).getTime()/1e3));e=e[0]+t+(e[1]?"&ref="+e[1]:"")}return e},_=function(e){var t=l(),i=e.length,n=!0;if(4*((t.length||11)+i)>1048576*c.storageCapacity){n=!1;var r=t.hits.shift();if(void 0!==r){n=!0;for(var o=r.length;o<i;){if(void 0===(r=t.hits.shift())){n=!1;break}o+=r.length}}}n&&(t.hits.push(e),d({hits:t.hits}))},i=function(r){a.builder.sendUrl=function(e,t,i,n){r||window.navigator&&!window.navigator.onLine?(_(h(e)),t&&t()):s(e,t,i,n)}};a.offline={},a.offline.getLength=function(){return 4*l().length},a.offline.remove=function(){d({hits:[]})},a.offline.get=p,a.offline.send=function(){s(null,null,"GET")},a.plugins.waitForDependencies(["Utils"],function(){var e,t=Echo1202ATInternet.Utils.isLocalStorageAvailable();window.navigator&&(e=window.navigator.onLine),t&&void 0!==e&&("required"===c.storageMode?i(!1):"always"===c.storageMode&&i(!0)),a.emit("Offline:Ready",{lvl:"INFO",details:{isLocalStorageAvailable:t,storageMode:c.storageMode,isOnline:e}})})},window.Echo1202ATInternet.Tracker.addPlugin("Offline")}.call(window),function(){Echo1202ATInternet.Tracker.Plugins.OnSiteAds=function(a){var t=this,i="",s=function(e){return a.utils.manageChapters(e,"chapter",3)+(e.name?e.name:"")},c=function(e,t){return e&&e[t]?e[t]:""},u=function(e,t){if(n=c(e,t)){var i=c(e,"prefix");if(n.campaignId){i=i||"PUB";var n,r=c(n,"campaignId"),o=c(n,"creation");return i+"-"+r+"-"+o+"-"+c(n,"variant")+"-"+c(n,"format")+"-"+c(n,"generalPlacement")+"-"+c(n,"detailedPlacement")+"-"+c(n,"advertiserId")+"-"+(n=c(n,"url"))}if(n.adId)return(i=i||"INT")+"-"+(r=c(n,"adId"))+"-"+(o=c(n,"format"))+"||"+(n=c(n,"productId"))}return""},n=function(e,t){var i=a.buffer.get("ati",!0)||{};i._value="string"==typeof i._value?[i._value]:i._value||[],i._options=i._options||{truncate:!0,hitType:[t,"page"]},i._value.push(e),a.buffer.set("ati",i._value,i._options)},r=function(e,t){if((e=e||{}).click?a.setParam("atc",u(e,"click"),{truncate:!0,hitType:[t,"page"]}):e.impression&&a.setParam("ati",u(e,"impression"),{truncate:!0,hitType:[t,"page"]}),e.customObject){a.setContext("onsiteads",{customObject:e.customObject});var i=a.getContext("page")||{};i.customObject=Echo1202ATInternet.Utils.completeFstLevelObj(i.customObject,e.customObject,!1),a.setContext("page",i)}a.dispatchSubscribe("onSiteAds")};a.selfPromotion={},a.publisher={},a.publisher.set=function(e){r(e,"publisher")},a.selfPromotion.set=function(e){r(e,"selfPromotion")},a.publisher.add=function(e){n(u(e,"impression"),"publisher"),a.dispatchSubscribe("onSiteAds")},a.selfPromotion.add=function(e){n(u(e,"impression"),"selfPromotion"),a.dispatchSubscribe("onSiteAds")},t.advertEvent=function(e){var t=!0,i="",n=null;if((e=e||{}).hasOwnProperty("event")&&(n=e.event||window.event),!Echo1202ATInternet.Utils.isTabOpeningAction(n)&&e.elem&&(t=(i=a.techClicks.manageClick(e.elem,n)).preservePropagation,i=i.elementType),e.click){e=e||{};n=["onSiteAdsClick"];var r=a.getContext("page")||{},o={};o.atc={_value:u(e,"click"),_options:{truncate:!0}},o.type="AT",o.patc=s(r),o.s2atc=r.level2||"",(r=e.customObject)&&(r=a.processTagObject("stc",n,r),o.stc={_value:Echo1202ATInternet.Utils.jsonSerialize(r),_options:{hitType:n,encode:!0,separator:",",truncate:!0}}),a.sendHit(o,[["hitType",n]],e.callback,null,i)}else e.impression&&function(e,t){e=e||{};var i=["onSiteAdsImpression"],n={};n.ati={_value:u(e,"impression"),_options:{hitType:i,truncate:!0}},n.type="AT",Echo1202ATInternet.Utils.isPreview()&&a.getConfig("preview")&&(n.pvw=1);var r=e.customObject;r&&(r=a.processTagObject("stc",i,r),n.stc={_value:Echo1202ATInternet.Utils.jsonSerialize(r),_options:{hitType:i,encode:!0,separator:",",truncate:!0}}),a.manageSend(function(){a.sendHit(n,[["hitType",i]],e.callback,null,t)})}(e,i);return t},a.publisher.send=function(e){return t.advertEvent(e)},a.selfPromotion.send=function(e){return t.advertEvent(e)},a.onSiteAds={},a.onSiteAds.onDispatch=function(e,t){if(!a.dispatchSubscribed("page")){a.setParam("type","AT",{hitType:["publisher","selfPromotion"]});var i=a.getContext("page")||{};a.getParam("atc")&&(a.setParam("patc",s(i),{hitType:["publisher","selfPromotion"]}),a.setParam("s2atc",i.level2||"",{hitType:["publisher","selfPromotion"]})),Echo1202ATInternet.Utils.isPreview()&&a.getConfig("preview")&&a.setParam("pvw",1);var n=["publisher","selfPromotion"];(i=(a.getContext("onsiteads")||{}).customObject)?a.processContextObjectAndSendHit("stc",{hitType:n,encode:!0,separator:",",truncate:!0,elementType:t},i,e):a.manageSend(function(){a.sendHit(null,[["hitType",n]],e,null,t)})}},a.plugins.waitForDependencies(["Utils","TechClicks"],function(){i=document.location.href;var e=a.utils.getQueryStringValue("xtatc",i);e&&a.setParam("atc",e,{hitType:["publisher","selfPromotion","page"]}),a.emit("OnSiteAds:Ready",{lvl:"INFO",details:{href:i}})})},Echo1202ATInternet.Tracker.addPlugin("OnSiteAds")}.call(window),function(){Echo1202ATInternet.Tracker.Plugins.Page=function(a){var r=["pageId","chapterLabel","update"],o=["pid","pchap","pidt"],s=["page","site"],c=["f","x"],u=function(e){return a.utils.manageChapters(e,"chapter",3)+(e.name?e.name:"")},l=function(e,t,i){return t?e=t:e||void 0===i||(e=i),e},d=function(e,t,i){t.hasOwnProperty(i)&&(e[i]=l(e[i],t[i],void 0))},p=function(e,t,i){if(t)for(var n=0;n<s.length;n++)if(t.hasOwnProperty(s[n])&&t[s[n]])for(var r in t[s[n]])t[s[n]].hasOwnProperty(r)&&(i?e[c[n]+r]=t[s[n]][r]:a.setParam(c[n]+r,t[s[n]][r]))},h=function(e,t,i){if(t){var n=a.utils.manageChapters(t,"chapter",3);for(n&&(t.chapterLabel=n.replace(/::$/gi,"")),n=0;n<o.length;n++)t.hasOwnProperty(r[n])&&(i?e[o[n]]=t[r[n]]:a.setParam(o[n],t[r[n]]))}},_=function(e,t,i){if(t&&t.keywords instanceof Array){var n=t.keywords.length;if(0<n){for(var r="",o=0;o<n;o++)r+="["+t.keywords[o]+"]"+(o<n-1?"|":"");i?e.tag=r:a.setParam("tag",r)}}},f=function(e,t,i){if(t){var n,r=function(e){return e||"0"};n=r(t.category1)+"-",n+=r(t.category2)+"-",n+=r(t.category3),i?e.ptype=n:a.setParam("ptype",n)}},E=function(e,t,i){if(t)for(var n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&(i?e[n]=t[n]:a.setParam(n,t[n]))};a.customVars={},a.customVars.set=function(e){var t=a.getContext("page")||{},i=t.customVars;if(i){if(e)for(var n in e)e.hasOwnProperty(n)&&(i[n]=Echo1202ATInternet.Utils.completeFstLevelObj(i[n],e[n],!0))}else i=e;t.customVars=i,a.setContext("page",t)},a.dynamicLabel={},a.dynamicLabel.set=function(e){var t=a.getContext("page")||{};t.dynamicLabel=Echo1202ATInternet.Utils.completeFstLevelObj(t.dynamicLabel,e,!0),a.setContext("page",t)},a.tags={},a.tags.set=function(e){var t=a.getContext("page")||{};t.tags=Echo1202ATInternet.Utils.completeFstLevelObj(t.tags,e,!0),a.setContext("page",t)},a.customTreeStructure={},a.customTreeStructure.set=function(e){var t=a.getContext("page")||{};t.customTreeStructure=Echo1202ATInternet.Utils.completeFstLevelObj(t.customTreeStructure,e,!0),a.setContext("page",t)},a.page={},a.page.reset=function(){a.delContext("page")},a.page.set=function(e){e=e||{},a.dispatchSubscribe("page");var t=a.getContext("page")||{};t.name=l(t.name,e.name,""),t.level2=l(t.level2,e.level2,""),d(t,e,"chapter1"),d(t,e,"chapter2"),d(t,e,"chapter3"),t.customObject=Echo1202ATInternet.Utils.completeFstLevelObj(t.customObject,e.customObject,!0),a.setContext("page",t)},a.page.send=function(e){var t=!0,i="",n={p:u(e=e||{}),s2:e.level2||""};if(o=e.customObject){var r=["page"],o=a.processTagObject("stc",r,o);n.stc={_value:Echo1202ATInternet.Utils.jsonSerialize(o),_options:{hitType:r,encode:!0,separator:",",truncate:!0}}}return(o=a.getContext("page")||{}).vrn&&(n.vrn=o.vrn,a.delContext("page","vrn")),void 0!==(r=a.getContext("InternalSearch")||{}).keyword&&(n.mc=Echo1202ATInternet.Utils.cloneSimpleObject(r.keyword),void 0!==r.resultPageNumber&&(n.np=Echo1202ATInternet.Utils.cloneSimpleObject(r.resultPageNumber)),a.delContext("InternalSearch")),Echo1202ATInternet.Utils.isPreview()&&a.getConfig("preview")&&(n.pvw=1),p(n,e.customVars,!0),h(n,e.dynamicLabel,!0),_(n,e.tags,!0),f(n,e.customTreeStructure,!0),r=a.getContext("campaigns")||{},E(n,r,!0),a.delContext("campaigns"),r=null,e&&e.hasOwnProperty("event")&&(r=e.event||window.event),!Echo1202ATInternet.Utils.isTabOpeningAction(r)&&e.elem&&(t=(r=a.techClicks.manageClick(e.elem,r)).preservePropagation,i=r.elementType),a.manageSend(function(){a.sendHit(n,null,e.callback,null,i)}),o.name=l(o.name,e.name,""),o.level2=l(o.level2,e.level2,""),d(o,e,"chapter1"),d(o,e,"chapter2"),d(o,e,"chapter3"),a.setContext("page",o),t},a.page.onDispatch=function(e,t){var i=a.getContext("page")||{},n=a.getContext("InternalSearch")||{};a.setParam("p",u(i)),a.setParam("s2",i.level2||""),i.vrn&&(a.setParam("vrn",i.vrn),a.delContext("page","vrn")),void 0!==n.keyword&&(a.setParam("mc",Echo1202ATInternet.Utils.cloneSimpleObject(n.keyword)),void 0!==n.resultPageNumber&&a.setParam("np",Echo1202ATInternet.Utils.cloneSimpleObject(n.resultPageNumber)),a.delContext("InternalSearch")),Echo1202ATInternet.Utils.isPreview()&&a.getConfig("preview")&&a.setParam("pvw",1),p(null,i.customVars,!1),h(null,i.dynamicLabel,!1),_(null,i.tags,!1),f(null,i.customTreeStructure,!1),n=a.getContext("campaigns")||{},E(null,n,!1),a.delContext("campaigns");var r=["page"];(i=i.customObject)?a.processContextObjectAndSendHit("stc",{hitType:r,encode:!0,separator:",",truncate:!0,elementType:t},i,e):a.manageSend(function(){a.sendHit(null,[["hitType",r]],e,null,t)})}},Echo1202ATInternet.Tracker.addPlugin("Page")}.call(window),function(){window.Echo1202ATInternet.Tracker.Plugins.RichMedia=function(s){var c=function(e,t){var i=parseInt(e,10);return i?Math.max(i,t):0},u=new function(){this.media=function(){this.type=void 0,this.plyr=0,this.clnk=this.s2=void 0,this.p="",this.m9=this.m6=this.m5=this.m1=this.rfsh=this.buf=this.a=void 0},this.mediaAll={},this.setMediaValue=function(e,t,i,n){void 0!==n&&(this.mediaAll[e]=this.mediaAll[e]||{},this.mediaAll[e][t]=this.mediaAll[e][t]||new this.media,this.mediaAll[e][t][i]=n)},this.getMediaValue=function(e,t,i){if(this.mediaAll[e]&&this.mediaAll[e][t])return this.mediaAll[e][t][i]},this.removePlayer=function(e){this.mediaAll[e]={}},this.removeAll=function(){this.mediaAll={}}},l=new function(){this.timeout={},this.setTimeout=function(e,t,i){this.timeout[e]=this.timeout[e]||{},this.timeout[e][t]&&window.clearTimeout(this.timeout[e][t]),this.timeout[e][t]=window.setTimeout(function(){s.richMedia.send({action:"refresh",playerId:e,mediaLabel:t})},1e3*i)},this.setTimeoutObject=function(e,t,i){if(this.timeout[e]=this.timeout[e]||{},void 0===this.timeout[e][t]){var n,r=[];for(n in i)i.hasOwnProperty(n)&&r.push({delay:c(n,0),refresh:c(i[n],5)});r.sort(function(e,t){return e.delay<t.delay?-1:e.delay>t.delay?1:0}),this.timeout[e][t]={refreshTab:r,backupRefreshTab:Echo1202ATInternet.Utils.cloneSimpleObject(r),delayConfiguration:{}}}if(0<(i=this.timeout[e][t]).refreshTab.length&&(r=i.refreshTab[0].delay,n=i.refreshTab[0].refresh,"number"==typeof r&&"number"==typeof n&&0<n)){i.delayConfiguration[r]=i.delayConfiguration[r]||{};var o=void 0;void 0!==i.refreshTab[1]&&(o=i.refreshTab[1].delay);var a=0;void 0===o?a=1:"number"==typeof i.delayConfiguration[r].number?a="refresh"===u.getMediaValue(e,t,"a")?Math.max(i.delayConfiguration[r].number-1,0):i.delayConfiguration[r].number:"number"==typeof o&&(a=Math.floor(60*(o-r)/n)-1),i.delayConfiguration[r].number=a,i.delayConfiguration[r].timeout&&window.clearTimeout(i.delayConfiguration[r].timeout),0<a?i.delayConfiguration[r].timeout=window.setTimeout(function(){s.richMedia.send({action:"refresh",playerId:e,mediaLabel:t})},1e3*n):(i.delayConfiguration[r].number=void 0,i.delayConfiguration[r].timeout=void 0,i.refreshTab.splice(0,1),window.setTimeout(function(){s.richMedia.send({action:"refresh",playerId:e,mediaLabel:t})},1e3*n)),this.timeout[e][t]=i}},this.clearTimeout=function(e,t,i){this.timeout[e]=this.timeout[e]||{};var n=this.timeout[e][t];if("object"==typeof n){if("object"==typeof n.delayConfiguration){var r,o;for(o in n.delayConfiguration)n.delayConfiguration.hasOwnProperty(o)&&(void 0!==(r=n.delayConfiguration[o].number)&&0<r&&(n.delayConfiguration[o].timeout&&window.clearTimeout(n.delayConfiguration[o].timeout),n.delayConfiguration[o].timeout=void 0));i&&(n.refreshTab=Echo1202ATInternet.Utils.cloneSimpleObject(n.backupRefreshTab)),this.timeout[e][t]=n}}else n&&window.clearTimeout(n)},this.removePlayer=function(e){for(var t in this.timeout[e])if(this.timeout[e].hasOwnProperty(t)){this.clearTimeout(e,t,!1);var i=u.getMediaValue(e,t,"a");void 0!==this.timeout[e][t]&&"stop"!==i&&s.richMedia.send({action:"stop",playerId:e,mediaLabel:t})}this.timeout[e]={}},this.removeAll=function(){for(var e in this.timeout)this.timeout.hasOwnProperty(e)&&this.removePlayer(e);this.timeout={}}},d=function(e,t,i){return s.utils.manageChapters(e,t,3)+(e[i]?e[i]:"")},p=function(e,t,i,n){var r=e[t];return"boolean"==typeof e[t]&&(r=e[t]?n:i),r},h=function(e){var t=0;return/^(\-|\+)?([0-9]+)$/.test(e)&&(t=Number(e)),t},_=function(e,t,i,n,r){void 0!==(t=u.getMediaValue(t,i,n))&&(e[n]=r?encodeURIComponent(t):t)},f=function(e,t,i){void 0!==i&&(e[t]=i)};s.richMedia={},s.richMedia.add=function(e){var t=h((e=e||{}).playerId),i=d(e,"mediaTheme","mediaLabel"),n=p(e,"isEmbedded","int","ext");u.setMediaValue(t,i,"plyr",t),u.setMediaValue(t,i,"type",e.mediaType),u.setMediaValue(t,i,"s2",e.mediaLevel2),u.setMediaValue(t,i,"p",i),u.setMediaValue(t,i,"clnk",e.linkedContent||e.previousMedia),u.setMediaValue(t,i,"a",e.action),u.setMediaValue(t,i,"rfsh",e.refreshDuration),u.setMediaValue(t,i,"m1",e.duration),u.setMediaValue(t,i,"m5",n),u.setMediaValue(t,i,"m6",e.broadcastMode),u.setMediaValue(t,i,"m9",e.webdomain)},s.richMedia.send=function(e){var t=h((e=e||{}).playerId),i=d(e,"mediaTheme","mediaLabel"),n=e.action;u.setMediaValue(t,i,"a",n);var r={plyr:t,p:i};if(_(r,t,i,"a",!1),_(r,t,i,"type",!1),_(r,t,i,"s2",!1),_(r,t,i,"m1",!1),_(r,t,i,"m5",!1),_(r,t,i,"m6",!1),"play"===n||"info"===n){e=p(e,"isBuffering","0","1");var o=s.getContext("page")||{},a=d(o,"chapter","name")||void 0;o=o.level2||void 0;f(r,"buf",e),f(r,"prich",a),f(r,"s2rich",o),_(r,t,i,"clnk",!1),_(r,t,i,"m9",!0)}s.sendHit(r,[["hitType",["richmedia"]]],null,null,null),"pause"===n?l.clearTimeout(t,i,!1):"stop"===n&&l.clearTimeout(t,i,!0),"play"!==n&&"refresh"!==n||("object"==typeof(n=u.getMediaValue(t,i,"rfsh"))&&null!==n?l.setTimeoutObject(t,i,n):0!==(n=c(n,5))&&l.setTimeout(t,i,n))},s.richMedia.remove=function(e){l.removePlayer(e),u.removePlayer(e)},s.richMedia.removeAll=function(){l.removeAll(),u.removeAll()}},window.Echo1202ATInternet.Tracker.addPlugin("RichMedia")}.call(window),"function"==typeof window.Echo1202ATInternet.onTrackerLoad&&window.Echo1202ATInternet.onTrackerLoad(),Echo1202ATInternet}.call(t,i,t,e))||(e.exports=n)},function(e,t,i){var n=i(45),r=i(46),o=r;o.v1=n,o.v4=r,e.exports=o},function(e,t,i){var _,f,E=i(22),g=i(23),m=0,v=0;e.exports=function(e,t,i){var n=t&&i||0,r=t||[],o=(e=e||{}).node||_,a=void 0!==e.clockseq?e.clockseq:f;if(null==o||null==a){var s=E();null==o&&(o=_=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==a&&(a=f=16383&(s[6]<<8|s[7]))}var c=void 0!==e.msecs?e.msecs:(new Date).getTime(),u=void 0!==e.nsecs?e.nsecs:v+1,l=c-m+(u-v)/1e4;if(l<0&&void 0===e.clockseq&&(a=a+1&16383),(l<0||m<c)&&void 0===e.nsecs&&(u=0),1e4<=u)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");m=c,f=a;var d=(1e4*(268435455&(c+=122192928e5))+(v=u))%4294967296;r[n++]=d>>>24&255,r[n++]=d>>>16&255,r[n++]=d>>>8&255,r[n++]=255&d;var p=c/4294967296*1e4&268435455;r[n++]=p>>>8&255,r[n++]=255&p,r[n++]=p>>>24&15|16,r[n++]=p>>>16&255,r[n++]=a>>>8|128,r[n++]=255&a;for(var h=0;h<6;++h)r[n+h]=o[h];return t||g(r)}},function(e,t,i){var a=i(22),s=i(23);e.exports=function(e,t,i){var n=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||a)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(var o=0;o<16;++o)t[n+o]=r[o];return t||s(r)}},function(e,t,i){var n;void 0===(n=function(){"use strict";function e(){}return e.sendRefreshEvent=function(e,t,i){if(i){var n=i;t(n=(n=(n=n.replace(/a\=play/g,"a=refresh")).replace(/ts\=[0-9\.]+/g,"ts="+(new Date).getTime())).replace(/(prich\=|s2rich\=).*?(&|$)/g,""),function(){e.emit("Tracker:Hit:Sent:Ok",n)}.bind(e))}},e}.call(t,i,t,e))||(e.exports=n)},function(e,t,i){var n;void 0===(n=function(e){"use strict";var s=i(6),a=i(4),c=i(12);return{APP_NAME:void 0,APP_CATEGORY:void 0,bbc_content_id:1,bbc_app_type:2,bbc_app_name:3,language:4,bbc_url:5,bbc_referrer_url:6,bbc_content_type:7,bbc_library_version:8,page_title:9,custom_var_1:11,custom_var_2:12,custom_var_3:13,custom_var_4:14,custom_var_5:15,custom_var_6:16,custom_var_7:17,custom_var_8:18,custom_var_9:19,custom_var_10:20,create:function(e,t,i,n,r,o){var a;return this.APP_NAME=e,i&&i[s.APP_CATEGORY]?this.APP_CATEGORY=i[s.APP_CATEGORY]:this.APP_CATEGORY="",a=this._setCustomVariable(a,s.APP_TYPE,t),a=this._setCustomVariable(a,s.APP_NAME,e),a=this._setCustomVariable(a,s.LIBRARY_VERSION,c.getLibraryName()+"-"+c.getLibraryVersion()),o&&(a=this._setDocumentCustomVariables(a,o)),r&&(a=this._setOrbitCustomVariables(a,r)),this._applyLabels(a,i),this._applyLabels(a,n),a},_initialise:function(){return{site:{}}},_applyLabels:function(t,i){if(i){var n=this._getAppName(i);i[s.APP_CATEGORY]&&(t=this._setCustomVariable(t,s.APP_NAME,n),delete i[s.APP_CATEGORY]),Object.keys(i).forEach(function(e){this._isCustomVariable(e)&&(e===s.APP_NAME&&(i[e]=n),t=this._setCustomVariable(t,e,i[e]),delete i[e])},this)}},_getAppName:function(e){var t="";return e[s.APP_CATEGORY]?t=e[s.APP_CATEGORY]+"-":this.APP_CATEGORY&&(t=this.APP_CATEGORY+"-"),e[s.APP_NAME]?t+=e[s.APP_NAME]:t+=this.APP_NAME,t},_isCustomVariable:function(e){return void 0!==this[e]&&this.hasOwnProperty(e)&&"function"!=typeof this[e]},_setCustomVariable:function(e,t,i){if(i){e||(e=this._initialise());var n=a.removeSensitiveInfo(i),r=a.cleanCustomVariable(n),o=this[t];e.site[o]="["+encodeURIComponent(r)+"]"}return e},_setDocumentCustomVariables:function(e,t){return t&&(e=this._setCustomVariable(e,s.URL,t.URL),e=this._setCustomVariable(e,s.REFERRER_URL,t.referrer),e=this._setCustomVariable(e,s.PAGE_TITLE,t.title)),e},_setOrbitCustomVariables:function(e,t){return t&&(e=this._setCustomVariable(e,s.CONTENT_ID,t.contentId),e=this._setCustomVariable(e,s.CONTENT_TYPE,t.contentType),e=this._setCustomVariable(e,s.LANGUAGE,t.language),e=this._setProductCustomVariables(e,t.additionalProperties)),e},_setProductCustomVariables:function(e,t){return t&&(t.app_category&&(e=this._setCustomVariable(e,s.APP_NAME,this._getAppName(t))),t.content_language&&(e=this._setCustomVariable(e,s.LANGUAGE,t.content_language)),e=this._setCustomVariable(e,s.CUSTOM_VAR_1,t.custom_var_1),e=this._setCustomVariable(e,s.CUSTOM_VAR_2,t.custom_var_2),e=this._setCustomVariable(e,s.CUSTOM_VAR_3,t.custom_var_3),e=this._setCustomVariable(e,s.CUSTOM_VAR_4,t.custom_var_4),e=this._setCustomVariable(e,s.CUSTOM_VAR_5,t.custom_var_5),e=this._setCustomVariable(e,s.CUSTOM_VAR_6,t.custom_var_6),e=this._setCustomVariable(e,s.CUSTOM_VAR_7,t.custom_var_7),e=this._setCustomVariable(e,s.CUSTOM_VAR_8,t.custom_var_8),e=this._setCustomVariable(e,s.CUSTOM_VAR_9,t.custom_var_9),e=this._setCustomVariable(e,s.CUSTOM_VAR_10,t.custom_var_10)),e}}}.call(t,i,t,e))||(e.exports=n)},function(e){e.exports=JSON.parse('{"name":"@bbc/echo-client-js","description":"Client library for sending events","version":"12.18.0","main":"dist/echo-12.18.0.js","scripts":{"test":"grunt build","build":"grunt build","build:dev":"webpack --mode=development --config ./config/webpack.dev.config.js","build:dist":"webpack --mode=production --config ./config/webpack.prod.config.js"},"pre-commit":["test"],"files":["dist"],"echo-client-js":{"barb-spring-version":"2.5.9","ati-smarttag-version":"5.26.0"},"devDependencies":{"ajv":"^6.12.3","es6-promise":"^4.2.5","eslint":"^5.12.0","eslint-plugin-tv":"github:bbc/eslint-plugin-tv#semver:^1.0.0","grunt":"^1.5.3","grunt-cli":"^1.4.3","grunt-contrib-jshint":"^2.0.0","grunt-contrib-watch":"^1.1.0","grunt-eslint":"^22.0.0","grunt-jscs":"^3.0.1","grunt-karma":"^3.0.1","grunt-shell":"^2.1.0","gulp":"^4.0.0","hoek":"^6.1.2","istanbul-instrumenter-loader":"^3.0.1","jasmine":"^3.3.1","jasmine-core":"^3.3.0","jquery":"^3.4.1","karma":"^6.3.14","karma-chrome-launcher":"*","karma-coverage-istanbul-reporter":"^2.0.4","karma-firefox-launcher":"^1.1.0","karma-jasmine":"^2.0.1","karma-jasmine-html-reporter":"^1.4.0","karma-requirejs":"^1.1.0","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.7","karma-story-reporter":"^0.3.1","karma-webpack":"^3.0.0","load-grunt-tasks":"^4.0.0","lodash":"^4.17.15","pre-commit":"^1.2.2","puppeteer":"^15.4.0","requirejs":"^2.3.6","sinon":"^7.2.2","time-grunt":"^2.0.0","uglifyjs-webpack-plugin":"^2.1.1","uuid":"3.4.0","webpack":"^4.43.0","webpack-cli":"^3.2.1","webpack-merge":"^4.2.1"}}')},function(e,t,s){var i;void 0===(i=function(){"use strict";var n=s(0),i=s(12),r={NAME:"name",WS_PARTNER_ID:"ptnrID",PLIST:"pList"},o={RETRIEVAL_TYPE:"retType",APP_NAME:"appN",APP_TYPE:"appT"},a={PLAYER_NAME:"mpN",PLAYER_VERSION:"mpV",LIBRARY_NAME:"mlN",LIBRARY_VERSION:"mlV",CASTING_DEVICE_REFERRER:"devR"};return{buildTheme:function(e,t,i){return e+"="+encodeURIComponent(t||"")+(i?"":"~")},constructThemeOne:function(e,t){var i="";return e&&(e.isLive()&&t?i+=this.buildTheme(r.NAME,""):i+=this.buildTheme(r.NAME,e.getName()),i+=this.buildTheme(r.WS_PARTNER_ID,e.getWsPartnerId()),e.isLive()?i+=this.buildTheme(r.PLIST,e.getServiceId(),!0):i+=this.buildTheme(r.PLIST,e.getPlaylist(),!0)),n.info("Setting media theme 1: "+i),i},constructThemeTwo:function(e){var t="";return e&&(t=this.buildTheme(o.RETRIEVAL_TYPE,e.getRetrievalType()),t+=this.buildTheme(o.APP_NAME,e.getAppName()),t+=this.buildTheme(o.APP_TYPE,e.getAppType())),n.info("Setting media theme 2: "+t),t},constructThemeThree:function(e){var t="";return e&&(t=this.buildTheme(a.PLAYER_NAME,e.getMediaPlayerName()),t+=this.buildTheme(a.PLAYER_VERSION,e.getMediaPlayerVersion()),t+=this.buildTheme(a.LIBRARY_NAME,i.getLibraryName()),t+=this.buildTheme(a.LIBRARY_VERSION,i.getLibraryVersion()),t+=this.buildTheme(a.CASTING_DEVICE_REFERRER,e.getCastingDeviceReferrer(),!0)),n.info("Setting media theme 3: "+t),t}}}.call(t,s,t,e))||(e.exports=i)},function(e,t,i){var n;void 0===(n=function(){"use strict";var a=i(0);function e(){}return e.sendEvent=function(e,t,i,n){if(t){var r={action:i,playerId:t.playerId,mediaLabel:t.mediaLabel,mediaTheme1:t.mediaTheme1,mediaTheme2:t.mediaTheme2,mediaTheme3:t.mediaTheme3};for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o]);e.richMedia.send(r),a.info("Sending "+i+" media event")}},e}.call(t,i,t,e))||(e.exports=n)},function(e,t,r){var i;void 0===(i=function(){"use strict";var a=r(6),t=r(4),i="unknown",s="Page",c="",u="",l="unknown",d="",p="",h="unknown",_="click",n="impression";function f(){}return f.sendClickEvent=function(e,t){this._sendEvent(e,t,_)},f.sendImpressionEvent=function(e,t){this._sendEvent(e,t,n)},f._sendEvent=function(e,t,i){t||(t={customObject:{}}),t.customObject||(t.customObject={});var n={creation:this._formatEventValue(f._buildCreation(t)),campaignId:this._formatEventValue(t.customObject[a.CONTAINER]||s),variant:this._formatEventValue(t.customObject[a.PERSONALISATION]||c),format:this._formatEventValue(t.customObject[a.METADATA]||u),generalPlacement:this._formatEventValue(t[a.BBC_COUNTER_NAME]||l),detailedPlacement:this._formatEventValue(t.user||d),advertiserId:this._formatEventValue(t.customObject[a.SOURCE]||p),url:this._formatEventValue(t.customObject[a.RESULT]||h)},r={};if(i===_?r.click=n:r.impression=n,e)for(var o in e.publisher.send(r),t.customObject)e.delParam(o)},f._buildCreation=function(e){var t=e&&e.actionName||i;return e&&e.actionType&&(t+="~"+e.actionType),t},f._formatEventValue=function(e){return"["+t.cleanCustomVariable(e)+"]"},f}.call(t,r,t,e))||(e.exports=i)}])});